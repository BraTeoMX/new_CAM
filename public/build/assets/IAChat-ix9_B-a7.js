/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Vt,Ut;function Ft(){return{geminiUrl:Vt,vertexUrl:Ut}}function kt(o,t,e){var n,s,l;if(!(!((n=o.httpOptions)===null||n===void 0)&&n.baseUrl)){const a=Ft();return o.vertexai?(s=a.vertexUrl)!==null&&s!==void 0?s:t:(l=a.geminiUrl)!==null&&l!==void 0?l:e}return o.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class B{}function C(o,t){const e=/\{([^}]+)\}/g;return o.replace(e,(n,s)=>{if(Object.prototype.hasOwnProperty.call(t,s)){const l=t[s];return l!=null?String(l):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function r(o,t,e){for(let l=0;l<t.length-1;l++){const a=t[l];if(a.endsWith("[]")){const u=a.slice(0,-2);if(!(u in o))if(Array.isArray(e))o[u]=Array.from({length:e.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(o[u])){const c=o[u];if(Array.isArray(e))for(let d=0;d<c.length;d++){const f=c[d];r(f,t.slice(l+1),e[d])}else for(const d of c)r(d,t.slice(l+1),e)}return}else if(a.endsWith("[0]")){const u=a.slice(0,-3);u in o||(o[u]=[{}]);const c=o[u];r(c[0],t.slice(l+1),e);return}(!o[a]||typeof o[a]!="object")&&(o[a]={}),o=o[a]}const n=t[t.length-1],s=o[n];if(s!==void 0){if(!e||typeof e=="object"&&Object.keys(e).length===0||e===s)return;if(typeof s=="object"&&typeof e=="object"&&s!==null&&e!==null)Object.assign(s,e);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else o[n]=e}function i(o,t){try{if(t.length===1&&t[0]==="_self")return o;for(let e=0;e<t.length;e++){if(typeof o!="object"||o===null)return;const n=t[e];if(n.endsWith("[]")){const s=n.slice(0,-2);if(s in o){const l=o[s];return Array.isArray(l)?l.map(a=>i(a,t.slice(e+1))):void 0}else return}else o=o[n]}return o}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function A(o,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(o.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function Ct(o,t){const e=A(o,t);return e?e.startsWith("publishers/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}`:e.startsWith("models/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/publishers/google/${e}`:e:""}function yt(o,t){return Array.isArray(t)?t.map(e=>W(o,e)):[W(o,t)]}function W(o,t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Gt(o,t){const e=W(o,t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function qt(o,t){const e=W(o,t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function me(o,t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Et(o,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>me(o,e)):[me(o,t)]}function ie(o){return o!=null&&typeof o=="object"&&"parts"in o&&Array.isArray(o.parts)}function ge(o){return o!=null&&typeof o=="object"&&"functionCall"in o}function Te(o){return o!=null&&typeof o=="object"&&"functionResponse"in o}function w(o,t){if(t==null)throw new Error("ContentUnion is required");return ie(t)?t:{role:"user",parts:Et(o,t)}}function vt(o,t){if(!t)return[];if(o.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const n=w(o,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(o.isVertexAI()){const e=w(o,t);return e.parts&&e.parts.length>0&&e.parts[0].text!==void 0?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>w(o,e)):[w(o,t)]}function R(o,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(ge(t)||Te(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[w(o,t)]}const e=[],n=[],s=ie(t[0]);for(const l of t){const a=ie(l);if(a!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(l);else{if(ge(l)||Te(l))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(l)}}return s||e.push({role:"user",parts:Et(o,n)}),e}function _t(o,t){return t}function St(o,t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Q(o,t){return t}function Z(o,t){if(!Array.isArray(t))throw new Error("tool is required and must be an array of Tools");return t}function Bt(o,t,e,n=1){const s=!t.startsWith(`${e}/`)&&t.split("/").length===n;return o.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${o.getProject()}/${t}`:t.startsWith(`${e}/`)?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}`:s?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}/${t}`:t:s?`${e}/${t}`:t}function N(o,t){if(typeof t!="string")throw new Error("name must be a string");return Bt(o,t,"cachedContents")}function At(o,t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function D(o,t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function Ht(o){return o!=null&&typeof o=="object"&&"name"in o}function bt(o){return o!=null&&typeof o=="object"&&"video"in o}function $t(o){return o!=null&&typeof o=="object"&&"uri"in o}function It(o,t){var e;let n;if(Ht(t)&&(n=t.name),!($t(t)&&(n=t.uri,n===void 0))&&!(bt(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const l=n.split("files/")[1].match(/[a-z0-9]+/);if(l===null)throw new Error(`Could not extract file name from URI ${n}`);n=l[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Mt(o,t){let e;return o.isVertexAI()?e=t?"publishers/google/models":"models":e=t?"models":"tunedModels",e}function wt(o,t){for(const e of["models","tunedModels","publisherModels"])if(Ot(t,e))return t[e];return[]}function Ot(o,t){return o!==null&&typeof o=="object"&&t in o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jt(o,t){const e={};if(i(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=i(t,["thought"]);n!=null&&r(e,["thought"],n);const s=i(t,["codeExecutionResult"]);s!=null&&r(e,["codeExecutionResult"],s);const l=i(t,["executableCode"]);l!=null&&r(e,["executableCode"],l);const a=i(t,["fileData"]);a!=null&&r(e,["fileData"],a);const u=i(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=i(t,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const d=i(t,["inlineData"]);d!=null&&r(e,["inlineData"],d);const f=i(t,["text"]);return f!=null&&r(e,["text"],f),e}function Ce(o,t){const e={},n=i(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Jt(o,a))),r(e,["parts"],l)}const s=i(t,["role"]);return s!=null&&r(e,["role"],s),e}function Yt(){return{}}function Kt(o,t){const e={},n=i(t,["mode"]);n!=null&&r(e,["mode"],n);const s=i(t,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function Wt(o,t){const e={},n=i(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Kt(o,n)),e}function zt(o,t){const e={};if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");i(t,["googleSearch"])!=null&&r(e,["googleSearch"],Yt());const s=i(t,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],Wt(o,s)),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(t,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=i(t,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function Xt(o,t){const e={},n=i(t,["mode"]);n!=null&&r(e,["mode"],n);const s=i(t,["allowedFunctionNames"]);return s!=null&&r(e,["allowedFunctionNames"],s),e}function Qt(o,t){const e={},n=i(t,["functionCallingConfig"]);if(n!=null&&r(e,["functionCallingConfig"],Xt(o,n)),i(t,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return e}function Zt(o,t,e){const n={},s=i(t,["ttl"]);e!==void 0&&s!=null&&r(e,["ttl"],s);const l=i(t,["expireTime"]);e!==void 0&&l!=null&&r(e,["expireTime"],l);const a=i(t,["displayName"]);e!==void 0&&a!=null&&r(e,["displayName"],a);const u=i(t,["contents"]);if(e!==void 0&&u!=null){let p=R(o,u);Array.isArray(p)&&(p=p.map(h=>Ce(o,h))),r(e,["contents"],p)}const c=i(t,["systemInstruction"]);e!==void 0&&c!=null&&r(e,["systemInstruction"],Ce(o,w(o,c)));const d=i(t,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(h=>zt(o,h))),r(e,["tools"],p)}const f=i(t,["toolConfig"]);return e!==void 0&&f!=null&&r(e,["toolConfig"],Qt(o,f)),n}function jt(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["model"],Ct(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],Zt(o,s,e)),e}function en(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function tn(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function nn(o,t,e){const n={},s=i(t,["ttl"]);e!==void 0&&s!=null&&r(e,["ttl"],s);const l=i(t,["expireTime"]);return e!==void 0&&l!=null&&r(e,["expireTime"],l),n}function on(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],nn(o,s,e)),e}function sn(o,t,e){const n={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(t,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),n}function rn(o,t){const e={},n=i(t,["config"]);return n!=null&&r(e,["config"],sn(o,n,e)),e}function ln(o,t){const e={},n=i(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const s=i(t,["thought"]);s!=null&&r(e,["thought"],s);const l=i(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=i(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=i(t,["fileData"]);u!=null&&r(e,["fileData"],u);const c=i(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=i(t,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=i(t,["inlineData"]);f!=null&&r(e,["inlineData"],f);const p=i(t,["text"]);return p!=null&&r(e,["text"],p),e}function ye(o,t){const e={},n=i(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>ln(o,a))),r(e,["parts"],l)}const s=i(t,["role"]);return s!=null&&r(e,["role"],s),e}function an(){return{}}function un(o,t){const e={},n=i(t,["mode"]);n!=null&&r(e,["mode"],n);const s=i(t,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function dn(o,t){const e={},n=i(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],un(o,n)),e}function cn(){return{}}function fn(o,t){const e={},n=i(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function pn(o,t){const e={},n=i(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],fn(o,n));const s=i(t,["authType"]);s!=null&&r(e,["authType"],s);const l=i(t,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=i(t,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const u=i(t,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const c=i(t,["oidcConfig"]);return c!=null&&r(e,["oidcConfig"],c),e}function hn(o,t){const e={},n=i(t,["authConfig"]);return n!=null&&r(e,["authConfig"],pn(o,n)),e}function mn(o,t){const e={},n=i(t,["retrieval"]);n!=null&&r(e,["retrieval"],n),i(t,["googleSearch"])!=null&&r(e,["googleSearch"],an());const l=i(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],dn(o,l)),i(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],cn());const u=i(t,["googleMaps"]);u!=null&&r(e,["googleMaps"],hn(o,u));const c=i(t,["codeExecution"]);c!=null&&r(e,["codeExecution"],c);const d=i(t,["functionDeclarations"]);return d!=null&&r(e,["functionDeclarations"],d),e}function gn(o,t){const e={},n=i(t,["mode"]);n!=null&&r(e,["mode"],n);const s=i(t,["allowedFunctionNames"]);return s!=null&&r(e,["allowedFunctionNames"],s),e}function Tn(o,t){const e={},n=i(t,["latitude"]);n!=null&&r(e,["latitude"],n);const s=i(t,["longitude"]);return s!=null&&r(e,["longitude"],s),e}function Cn(o,t){const e={},n=i(t,["latLng"]);return n!=null&&r(e,["latLng"],Tn(o,n)),e}function yn(o,t){const e={},n=i(t,["functionCallingConfig"]);n!=null&&r(e,["functionCallingConfig"],gn(o,n));const s=i(t,["retrievalConfig"]);return s!=null&&r(e,["retrievalConfig"],Cn(o,s)),e}function En(o,t,e){const n={},s=i(t,["ttl"]);e!==void 0&&s!=null&&r(e,["ttl"],s);const l=i(t,["expireTime"]);e!==void 0&&l!=null&&r(e,["expireTime"],l);const a=i(t,["displayName"]);e!==void 0&&a!=null&&r(e,["displayName"],a);const u=i(t,["contents"]);if(e!==void 0&&u!=null){let p=R(o,u);Array.isArray(p)&&(p=p.map(h=>ye(o,h))),r(e,["contents"],p)}const c=i(t,["systemInstruction"]);e!==void 0&&c!=null&&r(e,["systemInstruction"],ye(o,w(o,c)));const d=i(t,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(h=>mn(o,h))),r(e,["tools"],p)}const f=i(t,["toolConfig"]);return e!==void 0&&f!=null&&r(e,["toolConfig"],yn(o,f)),n}function vn(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["model"],Ct(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],En(o,s,e)),e}function _n(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function Sn(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function An(o,t,e){const n={},s=i(t,["ttl"]);e!==void 0&&s!=null&&r(e,["ttl"],s);const l=i(t,["expireTime"]);return e!==void 0&&l!=null&&r(e,["expireTime"],l),n}function In(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],An(o,s,e)),e}function Mn(o,t,e){const n={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(t,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),n}function wn(o,t){const e={},n=i(t,["config"]);return n!=null&&r(e,["config"],Mn(o,n,e)),e}function Y(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(t,["model"]);l!=null&&r(e,["model"],l);const a=i(t,["createTime"]);a!=null&&r(e,["createTime"],a);const u=i(t,["updateTime"]);u!=null&&r(e,["updateTime"],u);const c=i(t,["expireTime"]);c!=null&&r(e,["expireTime"],c);const d=i(t,["usageMetadata"]);return d!=null&&r(e,["usageMetadata"],d),e}function xn(){return{}}function Pn(o,t){const e={},n=i(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const s=i(t,["cachedContents"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>Y(o,a))),r(e,["cachedContents"],l)}return e}function K(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(t,["model"]);l!=null&&r(e,["model"],l);const a=i(t,["createTime"]);a!=null&&r(e,["createTime"],a);const u=i(t,["updateTime"]);u!=null&&r(e,["updateTime"],u);const c=i(t,["expireTime"]);c!=null&&r(e,["expireTime"],c);const d=i(t,["usageMetadata"]);return d!=null&&r(e,["usageMetadata"],d),e}function Rn(){return{}}function Nn(o,t){const e={},n=i(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const s=i(t,["cachedContents"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>K(o,a))),r(e,["cachedContents"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var V;(function(o){o.PAGED_ITEM_BATCH_JOBS="batchJobs",o.PAGED_ITEM_MODELS="models",o.PAGED_ITEM_TUNING_JOBS="tuningJobs",o.PAGED_ITEM_FILES="files",o.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(V||(V={}));class j{constructor(t,e,n,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=e,this.init(t,n,s)}init(t,e,n){var s,l;this.nameInternal=t,this.pageInternal=e[this.nameInternal]||[],this.idxInternal=0;let a={config:{}};n?typeof n=="object"?a=Object.assign({},n):a=n:a={config:{}},a.config&&(a.config.pageToken=e.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(l=(s=a.config)===null||s===void 0?void 0:s.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ee;(function(o){o.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Ee||(Ee={}));var ve;(function(o){o.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON"})(ve||(ve={}));var _e;(function(o){o.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(_e||(_e={}));var Se;(function(o){o.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",o.SEVERITY="SEVERITY",o.PROBABILITY="PROBABILITY"})(Se||(Se={}));var Ae;(function(o){o.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE",o.OFF="OFF"})(Ae||(Ae={}));var Ie;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Ie||(Ie={}));var Me;(function(o){o.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",o.NO_AUTH="NO_AUTH",o.API_KEY_AUTH="API_KEY_AUTH",o.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",o.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",o.OAUTH="OAUTH",o.OIDC_AUTH="OIDC_AUTH"})(Me||(Me={}));var we;(function(o){o.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT"})(we||(we={}));var xe;(function(o){o.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",o.STOP="STOP",o.MAX_TOKENS="MAX_TOKENS",o.SAFETY="SAFETY",o.RECITATION="RECITATION",o.LANGUAGE="LANGUAGE",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.SPII="SPII",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.IMAGE_SAFETY="IMAGE_SAFETY"})(xe||(xe={}));var Pe;(function(o){o.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",o.NEGLIGIBLE="NEGLIGIBLE",o.LOW="LOW",o.MEDIUM="MEDIUM",o.HIGH="HIGH"})(Pe||(Pe={}));var Re;(function(o){o.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",o.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",o.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",o.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",o.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Re||(Re={}));var Ne;(function(o){o.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(Ne||(Ne={}));var De;(function(o){o.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",o.ON_DEMAND="ON_DEMAND",o.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(De||(De={}));var z;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.AUDIO="AUDIO"})(z||(z={}));var Le;(function(o){o.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",o.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",o.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",o.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Le||(Le={}));var se;(function(o){o.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",o.JOB_STATE_QUEUED="JOB_STATE_QUEUED",o.JOB_STATE_PENDING="JOB_STATE_PENDING",o.JOB_STATE_RUNNING="JOB_STATE_RUNNING",o.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",o.JOB_STATE_FAILED="JOB_STATE_FAILED",o.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",o.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",o.JOB_STATE_PAUSED="JOB_STATE_PAUSED",o.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",o.JOB_STATE_UPDATING="JOB_STATE_UPDATING",o.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(se||(se={}));var Ve;(function(o){o.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",o.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",o.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",o.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",o.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",o.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",o.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Ve||(Ve={}));var Ue;(function(o){o.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",o.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",o.BALANCED="BALANCED",o.PRIORITIZE_COST="PRIORITIZE_COST"})(Ue||(Ue={}));var Fe;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Fe||(Fe={}));var ke;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE"})(ke||(ke={}));var Ge;(function(o){o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE"})(Ge||(Ge={}));var qe;(function(o){o.DONT_ALLOW="DONT_ALLOW",o.ALLOW_ADULT="ALLOW_ADULT",o.ALLOW_ALL="ALLOW_ALL"})(qe||(qe={}));var Be;(function(o){o.auto="auto",o.en="en",o.ja="ja",o.ko="ko",o.hi="hi"})(Be||(Be={}));var He;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.PROCESSING="PROCESSING",o.ACTIVE="ACTIVE",o.FAILED="FAILED"})(He||(He={}));var be;(function(o){o.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",o.UPLOADED="UPLOADED",o.GENERATED="GENERATED"})(be||(be={}));var $e;(function(o){o.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",o.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",o.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",o.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",o.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})($e||($e={}));var Oe;(function(o){o.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",o.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",o.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",o.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Oe||(Oe={}));var Je;(function(o){o.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",o.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",o.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",o.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Je||(Je={}));var Ye;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.VIDEO="VIDEO",o.AUDIO="AUDIO",o.DOCUMENT="DOCUMENT"})(Ye||(Ye={}));var Ke;(function(o){o.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",o.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",o.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ke||(Ke={}));var We;(function(o){o.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",o.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",o.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(We||(We={}));var ze;(function(o){o.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",o.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",o.NO_INTERRUPTION="NO_INTERRUPTION"})(ze||(ze={}));var Xe;(function(o){o.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",o.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",o.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Xe||(Xe={}));class H{get text(){var t,e,n,s,l,a,u,c;if(((s=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",f=!1;const p=[];for(const h of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[m,g]of Object.entries(h))m!=="text"&&m!=="thought"&&(g!==null||g!==void 0)&&p.push(m);if(typeof h.text=="string"){if(typeof h.thought=="boolean"&&h.thought)continue;f=!0,d+=h.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?d:void 0}get data(){var t,e,n,s,l,a,u,c;if(((s=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const f=[];for(const p of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[h,m]of Object.entries(p))h!=="inlineData"&&(m!==null||m!==void 0)&&f.push(h);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var t,e,n,s,l,a,u,c;if(((s=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var t,e,n,s,l,a,u,c,d;if(((s=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var t,e,n,s,l,a,u,c,d;if(((s=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.output}}class Qe{}class Ze{}class je{}class et{}class tt{}class Dn{}class nt{}class ot{}class it{}class Ln{}class re{constructor(t){const e={};for(const n of t.headers.entries())e[n[0]]=n[1];this.headers=e,this.responseInternal=t}json(){return this.responseInternal.json()}}class Vn{}class Un{}class Fn{get text(){var t,e,n;let s="",l=!1;const a=[];for(const u of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[c,d]of Object.entries(u))c!=="text"&&c!=="thought"&&d!==null&&a.push(c);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;l=!0,s+=u.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?s:void 0}get data(){var t,e,n;let s="";const l=[];for(const a of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[u,c]of Object.entries(a))u!=="inlineData"&&c!==null&&l.push(u);a.inlineData&&typeof a.inlineData.data=="string"&&(s+=atob(a.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kn extends B{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new j(V.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(e),e)}async create(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=vn(this.apiClient,t);return u=C("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>K(this.apiClient,f))}else{const d=jt(this.apiClient,t);return u=C("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Y(this.apiClient,f))}}async get(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=_n(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>K(this.apiClient,f))}else{const d=en(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Y(this.apiClient,f))}}async delete(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Sn(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(()=>{const f=Rn(),p=new ot;return Object.assign(p,f),p})}else{const d=tn(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(()=>{const f=xn(),p=new ot;return Object.assign(p,f),p})}}async update(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=In(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>K(this.apiClient,f))}else{const d=on(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Y(this.apiClient,f))}}async listInternal(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=wn(this.apiClient,t);return u=C("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Nn(this.apiClient,f),h=new it;return Object.assign(h,p),h})}else{const d=rn(this.apiClient,t);return u=C("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Pn(this.apiClient,f),h=new it;return Object.assign(h,p),h})}}}function st(o){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&o[t],n=0;if(e)return e.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(o){return this instanceof M?(this.v=o,this):new M(o)}function X(o,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(o,t||[]),s,l=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),s[Symbol.asyncIterator]=function(){return this},s;function a(m){return function(g){return Promise.resolve(g).then(m,p)}}function u(m,g){n[m]&&(s[m]=function(T){return new Promise(function(y,_){l.push([m,T,y,_])>1||c(m,T)})},g&&(s[m]=g(s[m])))}function c(m,g){try{d(n[m](g))}catch(T){h(l[0][3],T)}}function d(m){m.value instanceof M?Promise.resolve(m.value.v).then(f,p):h(l[0][2],m)}function f(m){c("next",m)}function p(m){c("throw",m)}function h(m,g){m(g),l.shift(),l.length&&c(l[0][0],l[0][1])}}function le(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],e;return t?t.call(o):(o=typeof st=="function"?st(o):o[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(l){e[l]=o[l]&&function(a){return new Promise(function(u,c){a=o[l](a),s(u,c,a.done,a.value)})}}function s(l,a,u,c){Promise.resolve(c).then(function(d){l({value:d,done:u})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gn(o){var t;if(o.candidates==null||o.candidates.length===0)return!1;const e=(t=o.candidates[0])===null||t===void 0?void 0:t.content;return e===void 0?!1:xt(e)}function xt(o){if(o.parts===void 0||o.parts.length===0)return!1;for(const t of o.parts)if(t===void 0||Object.keys(t).length===0||t.text!==void 0&&t.text==="")return!1;return!0}function qn(o){if(o.length!==0){if(o[0].role!=="user")throw new Error("History must start with a user turn.");for(const t of o)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function Bn(o){if(o===void 0||o.length===0)return[];const t=[],e=o.length;let n=0,s=o[0];for(;n<e;)if(o[n].role==="user")s=o[n],n++;else{const l=[];let a=!0;for(;n<e&&o[n].role==="model";)l.push(o[n]),a&&!xt(o[n])&&(a=!1),n++;a&&(t.push(s),t.push(...l))}return t}class Hn{constructor(t,e){this.modelsModule=t,this.apiClient=e}create(t){return new bn(this.apiClient,this.modelsModule,t.model,t.config,t.history)}}class bn{constructor(t,e,n,s={},l=[]){this.apiClient=t,this.modelsModule=e,this.model=n,this.config=s,this.history=l,this.sendPromise=Promise.resolve(),qn(l)}async sendMessage(t){var e;await this.sendPromise;const n=w(this.apiClient,t.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});return this.sendPromise=(async()=>{var l,a;const c=(a=(l=(await s).candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content,d=c?[c]:[];this.recordHistory(n,d)})(),await this.sendPromise,s}async sendMessageStream(t){var e;await this.sendPromise;const n=w(this.apiClient,t.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const l=await s;return this.processStreamResponse(l,n)}getHistory(t=!1){return t?Bn(this.history):this.history}processStreamResponse(t,e){var n,s;return X(this,arguments,function*(){var a,u,c,d;const f=[];try{for(var p=!0,h=le(t),m;m=yield M(h.next()),a=m.done,!a;p=!0){d=m.value,p=!1;const g=d;if(Gn(g)){const T=(s=(n=g.candidates)===null||n===void 0?void 0:n[0])===null||s===void 0?void 0:s.content;T!==void 0&&f.push(T)}yield yield M(g)}}catch(g){u={error:g}}finally{try{!p&&!a&&(c=h.return)&&(yield M(c.call(h)))}finally{if(u)throw u.error}}this.recordHistory(e,f)})}recordHistory(t,e){let n=[];e.length>0&&e.every(s=>s.role==="model")?n=e:n.push({role:"model",parts:[]}),this.history.push(t),this.history.push(...n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $n(o,t,e){const n={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(t,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),n}function On(o,t){const e={},n=i(t,["config"]);return n!=null&&r(e,["config"],$n(o,n,e)),e}function Jn(o,t){const e={},n=i(t,["details"]);n!=null&&r(e,["details"],n);const s=i(t,["message"]);s!=null&&r(e,["message"],s);const l=i(t,["code"]);return l!=null&&r(e,["code"],l),e}function Yn(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(t,["mimeType"]);l!=null&&r(e,["mimeType"],l);const a=i(t,["sizeBytes"]);a!=null&&r(e,["sizeBytes"],a);const u=i(t,["createTime"]);u!=null&&r(e,["createTime"],u);const c=i(t,["expirationTime"]);c!=null&&r(e,["expirationTime"],c);const d=i(t,["updateTime"]);d!=null&&r(e,["updateTime"],d);const f=i(t,["sha256Hash"]);f!=null&&r(e,["sha256Hash"],f);const p=i(t,["uri"]);p!=null&&r(e,["uri"],p);const h=i(t,["downloadUri"]);h!=null&&r(e,["downloadUri"],h);const m=i(t,["state"]);m!=null&&r(e,["state"],m);const g=i(t,["source"]);g!=null&&r(e,["source"],g);const T=i(t,["videoMetadata"]);T!=null&&r(e,["videoMetadata"],T);const y=i(t,["error"]);return y!=null&&r(e,["error"],Jn(o,y)),e}function Kn(o,t){const e={},n=i(t,["file"]);n!=null&&r(e,["file"],Yn(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function Wn(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","file"],It(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function zn(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","file"],It(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function Xn(o,t){const e={},n=i(t,["details"]);n!=null&&r(e,["details"],n);const s=i(t,["message"]);s!=null&&r(e,["message"],s);const l=i(t,["code"]);return l!=null&&r(e,["code"],l),e}function ae(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(t,["mimeType"]);l!=null&&r(e,["mimeType"],l);const a=i(t,["sizeBytes"]);a!=null&&r(e,["sizeBytes"],a);const u=i(t,["createTime"]);u!=null&&r(e,["createTime"],u);const c=i(t,["expirationTime"]);c!=null&&r(e,["expirationTime"],c);const d=i(t,["updateTime"]);d!=null&&r(e,["updateTime"],d);const f=i(t,["sha256Hash"]);f!=null&&r(e,["sha256Hash"],f);const p=i(t,["uri"]);p!=null&&r(e,["uri"],p);const h=i(t,["downloadUri"]);h!=null&&r(e,["downloadUri"],h);const m=i(t,["state"]);m!=null&&r(e,["state"],m);const g=i(t,["source"]);g!=null&&r(e,["source"],g);const T=i(t,["videoMetadata"]);T!=null&&r(e,["videoMetadata"],T);const y=i(t,["error"]);return y!=null&&r(e,["error"],Xn(o,y)),e}function Qn(o,t){const e={},n=i(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const s=i(t,["files"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>ae(o,a))),r(e,["files"],l)}return e}function Zn(){return{}}function jn(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eo extends B{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new j(V.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(e),e)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(e=>ae(this.apiClient,e))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var e,n;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=On(this.apiClient,t);return l=C("files",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Qn(this.apiClient,c),f=new Ln;return Object.assign(f,d),f})}}async createInternal(t){var e,n;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Kn(this.apiClient,t);return l=C("upload/v1beta/files",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),s.then(()=>{const c=Zn(),d=new Vn;return Object.assign(d,c),d})}}async get(t){var e,n;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Wn(this.apiClient,t);return l=C("files/{file}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),s.then(c=>ae(this.apiClient,c))}}async delete(t){var e,n;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=zn(this.apiClient,t);return l=C("files/{file}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),s.then(()=>{const c=jn(),d=new Un;return Object.assign(d,c),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function to(o,t){const e={};if(i(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=i(t,["thought"]);n!=null&&r(e,["thought"],n);const s=i(t,["codeExecutionResult"]);s!=null&&r(e,["codeExecutionResult"],s);const l=i(t,["executableCode"]);l!=null&&r(e,["executableCode"],l);const a=i(t,["fileData"]);a!=null&&r(e,["fileData"],a);const u=i(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=i(t,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const d=i(t,["inlineData"]);d!=null&&r(e,["inlineData"],d);const f=i(t,["text"]);return f!=null&&r(e,["text"],f),e}function no(o,t){const e={},n=i(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const s=i(t,["thought"]);s!=null&&r(e,["thought"],s);const l=i(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=i(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=i(t,["fileData"]);u!=null&&r(e,["fileData"],u);const c=i(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=i(t,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=i(t,["inlineData"]);f!=null&&r(e,["inlineData"],f);const p=i(t,["text"]);return p!=null&&r(e,["text"],p),e}function oo(o,t){const e={},n=i(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>to(o,a))),r(e,["parts"],l)}const s=i(t,["role"]);return s!=null&&r(e,["role"],s),e}function io(o,t){const e={},n=i(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>no(o,a))),r(e,["parts"],l)}const s=i(t,["role"]);return s!=null&&r(e,["role"],s),e}function so(){return{}}function ro(){return{}}function lo(o,t){const e={},n=i(t,["mode"]);n!=null&&r(e,["mode"],n);const s=i(t,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function ao(o,t){const e={},n=i(t,["mode"]);n!=null&&r(e,["mode"],n);const s=i(t,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function uo(o,t){const e={},n=i(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],lo(o,n)),e}function co(o,t){const e={},n=i(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],ao(o,n)),e}function fo(){return{}}function po(o,t){const e={},n=i(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function ho(o,t){const e={},n=i(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],po(o,n));const s=i(t,["authType"]);s!=null&&r(e,["authType"],s);const l=i(t,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=i(t,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const u=i(t,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const c=i(t,["oidcConfig"]);return c!=null&&r(e,["oidcConfig"],c),e}function mo(o,t){const e={},n=i(t,["authConfig"]);return n!=null&&r(e,["authConfig"],ho(o,n)),e}function go(o,t){const e={};if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");i(t,["googleSearch"])!=null&&r(e,["googleSearch"],so());const s=i(t,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],uo(o,s)),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(t,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=i(t,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function To(o,t){const e={},n=i(t,["retrieval"]);n!=null&&r(e,["retrieval"],n),i(t,["googleSearch"])!=null&&r(e,["googleSearch"],ro());const l=i(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],co(o,l)),i(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],fo());const u=i(t,["googleMaps"]);u!=null&&r(e,["googleMaps"],mo(o,u));const c=i(t,["codeExecution"]);c!=null&&r(e,["codeExecution"],c);const d=i(t,["functionDeclarations"]);return d!=null&&r(e,["functionDeclarations"],d),e}function Co(o,t){const e={},n=i(t,["handle"]);if(n!=null&&r(e,["handle"],n),i(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function yo(o,t){const e={},n=i(t,["handle"]);n!=null&&r(e,["handle"],n);const s=i(t,["transparent"]);return s!=null&&r(e,["transparent"],s),e}function rt(){return{}}function lt(){return{}}function Eo(o,t){const e={},n=i(t,["disabled"]);n!=null&&r(e,["disabled"],n);const s=i(t,["startOfSpeechSensitivity"]);s!=null&&r(e,["startOfSpeechSensitivity"],s);const l=i(t,["endOfSpeechSensitivity"]);l!=null&&r(e,["endOfSpeechSensitivity"],l);const a=i(t,["prefixPaddingMs"]);a!=null&&r(e,["prefixPaddingMs"],a);const u=i(t,["silenceDurationMs"]);return u!=null&&r(e,["silenceDurationMs"],u),e}function vo(o,t){const e={},n=i(t,["disabled"]);n!=null&&r(e,["disabled"],n);const s=i(t,["startOfSpeechSensitivity"]);s!=null&&r(e,["startOfSpeechSensitivity"],s);const l=i(t,["endOfSpeechSensitivity"]);l!=null&&r(e,["endOfSpeechSensitivity"],l);const a=i(t,["prefixPaddingMs"]);a!=null&&r(e,["prefixPaddingMs"],a);const u=i(t,["silenceDurationMs"]);return u!=null&&r(e,["silenceDurationMs"],u),e}function _o(o,t){const e={},n=i(t,["automaticActivityDetection"]);n!=null&&r(e,["automaticActivityDetection"],Eo(o,n));const s=i(t,["activityHandling"]);s!=null&&r(e,["activityHandling"],s);const l=i(t,["turnCoverage"]);return l!=null&&r(e,["turnCoverage"],l),e}function So(o,t){const e={},n=i(t,["automaticActivityDetection"]);n!=null&&r(e,["automaticActivityDetection"],vo(o,n));const s=i(t,["activityHandling"]);s!=null&&r(e,["activityHandling"],s);const l=i(t,["turnCoverage"]);return l!=null&&r(e,["turnCoverage"],l),e}function Ao(o,t){const e={},n=i(t,["targetTokens"]);return n!=null&&r(e,["targetTokens"],n),e}function Io(o,t){const e={},n=i(t,["targetTokens"]);return n!=null&&r(e,["targetTokens"],n),e}function Mo(o,t){const e={},n=i(t,["triggerTokens"]);n!=null&&r(e,["triggerTokens"],n);const s=i(t,["slidingWindow"]);return s!=null&&r(e,["slidingWindow"],Ao(o,s)),e}function wo(o,t){const e={},n=i(t,["triggerTokens"]);n!=null&&r(e,["triggerTokens"],n);const s=i(t,["slidingWindow"]);return s!=null&&r(e,["slidingWindow"],Io(o,s)),e}function xo(o,t,e){const n={},s=i(t,["generationConfig"]);e!==void 0&&s!=null&&r(e,["setup","generationConfig"],s);const l=i(t,["responseModalities"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","responseModalities"],l);const a=i(t,["temperature"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","temperature"],a);const u=i(t,["topP"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topP"],u);const c=i(t,["topK"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","topK"],c);const d=i(t,["maxOutputTokens"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","maxOutputTokens"],d);const f=i(t,["mediaResolution"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","mediaResolution"],f);const p=i(t,["seed"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","seed"],p);const h=i(t,["speechConfig"]);e!==void 0&&h!=null&&r(e,["setup","generationConfig","speechConfig"],h);const m=i(t,["systemInstruction"]);e!==void 0&&m!=null&&r(e,["setup","systemInstruction"],oo(o,w(o,m)));const g=i(t,["tools"]);if(e!==void 0&&g!=null){let v=Z(o,g);Array.isArray(v)&&(v=v.map(I=>go(o,Q(o,I)))),r(e,["setup","tools"],v)}const T=i(t,["sessionResumption"]);e!==void 0&&T!=null&&r(e,["setup","sessionResumption"],Co(o,T));const y=i(t,["inputAudioTranscription"]);e!==void 0&&y!=null&&r(e,["setup","inputAudioTranscription"],rt());const _=i(t,["outputAudioTranscription"]);e!==void 0&&_!=null&&r(e,["setup","outputAudioTranscription"],rt());const E=i(t,["realtimeInputConfig"]);e!==void 0&&E!=null&&r(e,["setup","realtimeInputConfig"],_o(o,E));const S=i(t,["contextWindowCompression"]);return e!==void 0&&S!=null&&r(e,["setup","contextWindowCompression"],Mo(o,S)),n}function Po(o,t,e){const n={},s=i(t,["generationConfig"]);e!==void 0&&s!=null&&r(e,["setup","generationConfig"],s);const l=i(t,["responseModalities"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","responseModalities"],l);const a=i(t,["temperature"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","temperature"],a);const u=i(t,["topP"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topP"],u);const c=i(t,["topK"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","topK"],c);const d=i(t,["maxOutputTokens"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","maxOutputTokens"],d);const f=i(t,["mediaResolution"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","mediaResolution"],f);const p=i(t,["seed"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","seed"],p);const h=i(t,["speechConfig"]);e!==void 0&&h!=null&&r(e,["setup","generationConfig","speechConfig"],h);const m=i(t,["systemInstruction"]);e!==void 0&&m!=null&&r(e,["setup","systemInstruction"],io(o,w(o,m)));const g=i(t,["tools"]);if(e!==void 0&&g!=null){let v=Z(o,g);Array.isArray(v)&&(v=v.map(I=>To(o,Q(o,I)))),r(e,["setup","tools"],v)}const T=i(t,["sessionResumption"]);e!==void 0&&T!=null&&r(e,["setup","sessionResumption"],yo(o,T));const y=i(t,["inputAudioTranscription"]);e!==void 0&&y!=null&&r(e,["setup","inputAudioTranscription"],lt());const _=i(t,["outputAudioTranscription"]);e!==void 0&&_!=null&&r(e,["setup","outputAudioTranscription"],lt());const E=i(t,["realtimeInputConfig"]);e!==void 0&&E!=null&&r(e,["setup","realtimeInputConfig"],So(o,E));const S=i(t,["contextWindowCompression"]);return e!==void 0&&S!=null&&r(e,["setup","contextWindowCompression"],wo(o,S)),n}function Ro(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["setup","model"],A(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],xo(o,s,e)),e}function No(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["setup","model"],A(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],Po(o,s,e)),e}function Do(){return{}}function Lo(){return{}}function Vo(){return{}}function Uo(){return{}}function Fo(o,t){const e={},n=i(t,["media"]);n!=null&&r(e,["mediaChunks"],yt(o,n));const s=i(t,["audio"]);s!=null&&r(e,["audio"],qt(o,s));const l=i(t,["audioStreamEnd"]);l!=null&&r(e,["audioStreamEnd"],l);const a=i(t,["video"]);a!=null&&r(e,["video"],Gt(o,a));const u=i(t,["text"]);return u!=null&&r(e,["text"],u),i(t,["activityStart"])!=null&&r(e,["activityStart"],Do()),i(t,["activityEnd"])!=null&&r(e,["activityEnd"],Vo()),e}function ko(o,t){const e={},n=i(t,["media"]);if(n!=null&&r(e,["mediaChunks"],yt(o,n)),i(t,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=i(t,["audioStreamEnd"]);if(s!=null&&r(e,["audioStreamEnd"],s),i(t,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(i(t,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return i(t,["activityStart"])!=null&&r(e,["activityStart"],Lo()),i(t,["activityEnd"])!=null&&r(e,["activityEnd"],Uo()),e}function Go(){return{}}function qo(){return{}}function Bo(o,t){const e={},n=i(t,["thought"]);n!=null&&r(e,["thought"],n);const s=i(t,["codeExecutionResult"]);s!=null&&r(e,["codeExecutionResult"],s);const l=i(t,["executableCode"]);l!=null&&r(e,["executableCode"],l);const a=i(t,["fileData"]);a!=null&&r(e,["fileData"],a);const u=i(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=i(t,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const d=i(t,["inlineData"]);d!=null&&r(e,["inlineData"],d);const f=i(t,["text"]);return f!=null&&r(e,["text"],f),e}function Ho(o,t){const e={},n=i(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const s=i(t,["thought"]);s!=null&&r(e,["thought"],s);const l=i(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=i(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=i(t,["fileData"]);u!=null&&r(e,["fileData"],u);const c=i(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=i(t,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=i(t,["inlineData"]);f!=null&&r(e,["inlineData"],f);const p=i(t,["text"]);return p!=null&&r(e,["text"],p),e}function bo(o,t){const e={},n=i(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Bo(o,a))),r(e,["parts"],l)}const s=i(t,["role"]);return s!=null&&r(e,["role"],s),e}function $o(o,t){const e={},n=i(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Ho(o,a))),r(e,["parts"],l)}const s=i(t,["role"]);return s!=null&&r(e,["role"],s),e}function at(o,t){const e={},n=i(t,["text"]);n!=null&&r(e,["text"],n);const s=i(t,["finished"]);return s!=null&&r(e,["finished"],s),e}function ut(o,t){const e={},n=i(t,["text"]);n!=null&&r(e,["text"],n);const s=i(t,["finished"]);return s!=null&&r(e,["finished"],s),e}function Oo(o,t){const e={},n=i(t,["modelTurn"]);n!=null&&r(e,["modelTurn"],bo(o,n));const s=i(t,["turnComplete"]);s!=null&&r(e,["turnComplete"],s);const l=i(t,["interrupted"]);l!=null&&r(e,["interrupted"],l);const a=i(t,["groundingMetadata"]);a!=null&&r(e,["groundingMetadata"],a);const u=i(t,["generationComplete"]);u!=null&&r(e,["generationComplete"],u);const c=i(t,["inputTranscription"]);c!=null&&r(e,["inputTranscription"],at(o,c));const d=i(t,["outputTranscription"]);return d!=null&&r(e,["outputTranscription"],at(o,d)),e}function Jo(o,t){const e={},n=i(t,["modelTurn"]);n!=null&&r(e,["modelTurn"],$o(o,n));const s=i(t,["turnComplete"]);s!=null&&r(e,["turnComplete"],s);const l=i(t,["interrupted"]);l!=null&&r(e,["interrupted"],l);const a=i(t,["groundingMetadata"]);a!=null&&r(e,["groundingMetadata"],a);const u=i(t,["generationComplete"]);u!=null&&r(e,["generationComplete"],u);const c=i(t,["inputTranscription"]);c!=null&&r(e,["inputTranscription"],ut(o,c));const d=i(t,["outputTranscription"]);return d!=null&&r(e,["outputTranscription"],ut(o,d)),e}function Yo(o,t){const e={},n=i(t,["id"]);n!=null&&r(e,["id"],n);const s=i(t,["args"]);s!=null&&r(e,["args"],s);const l=i(t,["name"]);return l!=null&&r(e,["name"],l),e}function Ko(o,t){const e={},n=i(t,["args"]);n!=null&&r(e,["args"],n);const s=i(t,["name"]);return s!=null&&r(e,["name"],s),e}function Wo(o,t){const e={},n=i(t,["functionCalls"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Yo(o,l))),r(e,["functionCalls"],s)}return e}function zo(o,t){const e={},n=i(t,["functionCalls"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Ko(o,l))),r(e,["functionCalls"],s)}return e}function Xo(o,t){const e={},n=i(t,["ids"]);return n!=null&&r(e,["ids"],n),e}function Qo(o,t){const e={},n=i(t,["ids"]);return n!=null&&r(e,["ids"],n),e}function b(o,t){const e={},n=i(t,["modality"]);n!=null&&r(e,["modality"],n);const s=i(t,["tokenCount"]);return s!=null&&r(e,["tokenCount"],s),e}function O(o,t){const e={},n=i(t,["modality"]);n!=null&&r(e,["modality"],n);const s=i(t,["tokenCount"]);return s!=null&&r(e,["tokenCount"],s),e}function Zo(o,t){const e={},n=i(t,["promptTokenCount"]);n!=null&&r(e,["promptTokenCount"],n);const s=i(t,["cachedContentTokenCount"]);s!=null&&r(e,["cachedContentTokenCount"],s);const l=i(t,["responseTokenCount"]);l!=null&&r(e,["responseTokenCount"],l);const a=i(t,["toolUsePromptTokenCount"]);a!=null&&r(e,["toolUsePromptTokenCount"],a);const u=i(t,["thoughtsTokenCount"]);u!=null&&r(e,["thoughtsTokenCount"],u);const c=i(t,["totalTokenCount"]);c!=null&&r(e,["totalTokenCount"],c);const d=i(t,["promptTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(g=>b(o,g))),r(e,["promptTokensDetails"],m)}const f=i(t,["cacheTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>b(o,g))),r(e,["cacheTokensDetails"],m)}const p=i(t,["responseTokensDetails"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(g=>b(o,g))),r(e,["responseTokensDetails"],m)}const h=i(t,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>b(o,g))),r(e,["toolUsePromptTokensDetails"],m)}return e}function jo(o,t){const e={},n=i(t,["promptTokenCount"]);n!=null&&r(e,["promptTokenCount"],n);const s=i(t,["cachedContentTokenCount"]);s!=null&&r(e,["cachedContentTokenCount"],s);const l=i(t,["candidatesTokenCount"]);l!=null&&r(e,["responseTokenCount"],l);const a=i(t,["toolUsePromptTokenCount"]);a!=null&&r(e,["toolUsePromptTokenCount"],a);const u=i(t,["thoughtsTokenCount"]);u!=null&&r(e,["thoughtsTokenCount"],u);const c=i(t,["totalTokenCount"]);c!=null&&r(e,["totalTokenCount"],c);const d=i(t,["promptTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(T=>O(o,T))),r(e,["promptTokensDetails"],g)}const f=i(t,["cacheTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(T=>O(o,T))),r(e,["cacheTokensDetails"],g)}const p=i(t,["candidatesTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(T=>O(o,T))),r(e,["responseTokensDetails"],g)}const h=i(t,["toolUsePromptTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(T=>O(o,T))),r(e,["toolUsePromptTokensDetails"],g)}const m=i(t,["trafficType"]);return m!=null&&r(e,["trafficType"],m),e}function ei(o,t){const e={},n=i(t,["timeLeft"]);return n!=null&&r(e,["timeLeft"],n),e}function ti(o,t){const e={},n=i(t,["timeLeft"]);return n!=null&&r(e,["timeLeft"],n),e}function ni(o,t){const e={},n=i(t,["newHandle"]);n!=null&&r(e,["newHandle"],n);const s=i(t,["resumable"]);s!=null&&r(e,["resumable"],s);const l=i(t,["lastConsumedClientMessageIndex"]);return l!=null&&r(e,["lastConsumedClientMessageIndex"],l),e}function oi(o,t){const e={},n=i(t,["newHandle"]);n!=null&&r(e,["newHandle"],n);const s=i(t,["resumable"]);s!=null&&r(e,["resumable"],s);const l=i(t,["lastConsumedClientMessageIndex"]);return l!=null&&r(e,["lastConsumedClientMessageIndex"],l),e}function ii(o,t){const e={};i(t,["setupComplete"])!=null&&r(e,["setupComplete"],Go());const s=i(t,["serverContent"]);s!=null&&r(e,["serverContent"],Oo(o,s));const l=i(t,["toolCall"]);l!=null&&r(e,["toolCall"],Wo(o,l));const a=i(t,["toolCallCancellation"]);a!=null&&r(e,["toolCallCancellation"],Xo(o,a));const u=i(t,["usageMetadata"]);u!=null&&r(e,["usageMetadata"],Zo(o,u));const c=i(t,["goAway"]);c!=null&&r(e,["goAway"],ei(o,c));const d=i(t,["sessionResumptionUpdate"]);return d!=null&&r(e,["sessionResumptionUpdate"],ni(o,d)),e}function si(o,t){const e={};i(t,["setupComplete"])!=null&&r(e,["setupComplete"],qo());const s=i(t,["serverContent"]);s!=null&&r(e,["serverContent"],Jo(o,s));const l=i(t,["toolCall"]);l!=null&&r(e,["toolCall"],zo(o,l));const a=i(t,["toolCallCancellation"]);a!=null&&r(e,["toolCallCancellation"],Qo(o,a));const u=i(t,["usageMetadata"]);u!=null&&r(e,["usageMetadata"],jo(o,u));const c=i(t,["goAway"]);c!=null&&r(e,["goAway"],ti(o,c));const d=i(t,["sessionResumptionUpdate"]);return d!=null&&r(e,["sessionResumptionUpdate"],oi(o,d)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ri(o,t){const e={};if(i(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=i(t,["thought"]);n!=null&&r(e,["thought"],n);const s=i(t,["codeExecutionResult"]);s!=null&&r(e,["codeExecutionResult"],s);const l=i(t,["executableCode"]);l!=null&&r(e,["executableCode"],l);const a=i(t,["fileData"]);a!=null&&r(e,["fileData"],a);const u=i(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=i(t,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const d=i(t,["inlineData"]);d!=null&&r(e,["inlineData"],d);const f=i(t,["text"]);return f!=null&&r(e,["text"],f),e}function ee(o,t){const e={},n=i(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>ri(o,a))),r(e,["parts"],l)}const s=i(t,["role"]);return s!=null&&r(e,["role"],s),e}function li(o,t){const e={};if(i(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=i(t,["category"]);n!=null&&r(e,["category"],n);const s=i(t,["threshold"]);return s!=null&&r(e,["threshold"],s),e}function ai(){return{}}function ui(o,t){const e={},n=i(t,["mode"]);n!=null&&r(e,["mode"],n);const s=i(t,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function di(o,t){const e={},n=i(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],ui(o,n)),e}function ci(o,t){const e={};if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");i(t,["googleSearch"])!=null&&r(e,["googleSearch"],ai());const s=i(t,["googleSearchRetrieval"]);if(s!=null&&r(e,["googleSearchRetrieval"],di(o,s)),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(i(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=i(t,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=i(t,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function fi(o,t){const e={},n=i(t,["mode"]);n!=null&&r(e,["mode"],n);const s=i(t,["allowedFunctionNames"]);return s!=null&&r(e,["allowedFunctionNames"],s),e}function pi(o,t){const e={},n=i(t,["functionCallingConfig"]);if(n!=null&&r(e,["functionCallingConfig"],fi(o,n)),i(t,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return e}function hi(o,t){const e={},n=i(t,["voiceName"]);return n!=null&&r(e,["voiceName"],n),e}function mi(o,t){const e={},n=i(t,["prebuiltVoiceConfig"]);return n!=null&&r(e,["prebuiltVoiceConfig"],hi(o,n)),e}function gi(o,t){const e={},n=i(t,["voiceConfig"]);n!=null&&r(e,["voiceConfig"],mi(o,n));const s=i(t,["languageCode"]);return s!=null&&r(e,["languageCode"],s),e}function Ti(o,t){const e={},n=i(t,["includeThoughts"]);n!=null&&r(e,["includeThoughts"],n);const s=i(t,["thinkingBudget"]);return s!=null&&r(e,["thinkingBudget"],s),e}function Ci(o,t,e){const n={},s=i(t,["systemInstruction"]);e!==void 0&&s!=null&&r(e,["systemInstruction"],ee(o,w(o,s)));const l=i(t,["temperature"]);l!=null&&r(n,["temperature"],l);const a=i(t,["topP"]);a!=null&&r(n,["topP"],a);const u=i(t,["topK"]);u!=null&&r(n,["topK"],u);const c=i(t,["candidateCount"]);c!=null&&r(n,["candidateCount"],c);const d=i(t,["maxOutputTokens"]);d!=null&&r(n,["maxOutputTokens"],d);const f=i(t,["stopSequences"]);f!=null&&r(n,["stopSequences"],f);const p=i(t,["responseLogprobs"]);p!=null&&r(n,["responseLogprobs"],p);const h=i(t,["logprobs"]);h!=null&&r(n,["logprobs"],h);const m=i(t,["presencePenalty"]);m!=null&&r(n,["presencePenalty"],m);const g=i(t,["frequencyPenalty"]);g!=null&&r(n,["frequencyPenalty"],g);const T=i(t,["seed"]);T!=null&&r(n,["seed"],T);const y=i(t,["responseMimeType"]);y!=null&&r(n,["responseMimeType"],y);const _=i(t,["responseSchema"]);if(_!=null&&r(n,["responseSchema"],_t(o,_)),i(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(i(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=i(t,["safetySettings"]);if(e!==void 0&&E!=null){let x=E;Array.isArray(x)&&(x=x.map(L=>li(o,L))),r(e,["safetySettings"],x)}const S=i(t,["tools"]);if(e!==void 0&&S!=null){let x=Z(o,S);Array.isArray(x)&&(x=x.map(L=>ci(o,Q(o,L)))),r(e,["tools"],x)}const v=i(t,["toolConfig"]);if(e!==void 0&&v!=null&&r(e,["toolConfig"],pi(o,v)),i(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const I=i(t,["cachedContent"]);e!==void 0&&I!=null&&r(e,["cachedContent"],N(o,I));const F=i(t,["responseModalities"]);F!=null&&r(n,["responseModalities"],F);const k=i(t,["mediaResolution"]);k!=null&&r(n,["mediaResolution"],k);const G=i(t,["speechConfig"]);if(G!=null&&r(n,["speechConfig"],gi(o,St(o,G))),i(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const q=i(t,["thinkingConfig"]);return q!=null&&r(n,["thinkingConfig"],Ti(o,q)),n}function dt(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["contents"]);if(s!=null){let a=R(o,s);Array.isArray(a)&&(a=a.map(u=>ee(o,u))),r(e,["contents"],a)}const l=i(t,["config"]);return l!=null&&r(e,["generationConfig"],Ci(o,l,e)),e}function yi(o,t,e){const n={},s=i(t,["taskType"]);e!==void 0&&s!=null&&r(e,["requests[]","taskType"],s);const l=i(t,["title"]);e!==void 0&&l!=null&&r(e,["requests[]","title"],l);const a=i(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&r(e,["requests[]","outputDimensionality"],a),i(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(i(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Ei(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["contents"]);s!=null&&r(e,["requests[]","content"],vt(o,s));const l=i(t,["config"]);l!=null&&r(e,["config"],yi(o,l,e));const a=i(t,["model"]);return a!==void 0&&r(e,["requests[]","model"],A(o,a)),e}function vi(o,t,e){const n={};if(i(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(i(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=i(t,["numberOfImages"]);e!==void 0&&s!=null&&r(e,["parameters","sampleCount"],s);const l=i(t,["aspectRatio"]);e!==void 0&&l!=null&&r(e,["parameters","aspectRatio"],l);const a=i(t,["guidanceScale"]);if(e!==void 0&&a!=null&&r(e,["parameters","guidanceScale"],a),i(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=i(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&r(e,["parameters","safetySetting"],u);const c=i(t,["personGeneration"]);e!==void 0&&c!=null&&r(e,["parameters","personGeneration"],c);const d=i(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&r(e,["parameters","includeSafetyAttributes"],d);const f=i(t,["includeRaiReason"]);e!==void 0&&f!=null&&r(e,["parameters","includeRaiReason"],f);const p=i(t,["language"]);e!==void 0&&p!=null&&r(e,["parameters","language"],p);const h=i(t,["outputMimeType"]);e!==void 0&&h!=null&&r(e,["parameters","outputOptions","mimeType"],h);const m=i(t,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&r(e,["parameters","outputOptions","compressionQuality"],m),i(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(i(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function _i(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["prompt"]);s!=null&&r(e,["instances[0]","prompt"],s);const l=i(t,["config"]);return l!=null&&r(e,["config"],vi(o,l,e)),e}function Si(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","name"],A(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function Ai(o,t,e){const n={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=i(t,["filter"]);e!==void 0&&a!=null&&r(e,["_query","filter"],a);const u=i(t,["queryBase"]);return e!==void 0&&u!=null&&r(e,["_url","models_url"],Mt(o,u)),n}function Ii(o,t){const e={},n=i(t,["config"]);return n!=null&&r(e,["config"],Ai(o,n,e)),e}function Mi(o,t,e){const n={},s=i(t,["displayName"]);e!==void 0&&s!=null&&r(e,["displayName"],s);const l=i(t,["description"]);return e!==void 0&&l!=null&&r(e,["description"],l),n}function wi(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","name"],A(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],Mi(o,s,e)),e}function xi(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","name"],A(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function Pi(o,t){const e={};if(i(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(i(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(i(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Ri(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["contents"]);if(s!=null){let a=R(o,s);Array.isArray(a)&&(a=a.map(u=>ee(o,u))),r(e,["contents"],a)}const l=i(t,["config"]);return l!=null&&r(e,["config"],Pi(o,l)),e}function Ni(o,t){const e={};if(i(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=i(t,["imageBytes"]);n!=null&&r(e,["bytesBase64Encoded"],D(o,n));const s=i(t,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function Di(o,t,e){const n={},s=i(t,["numberOfVideos"]);if(e!==void 0&&s!=null&&r(e,["parameters","sampleCount"],s),i(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(i(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=i(t,["durationSeconds"]);if(e!==void 0&&l!=null&&r(e,["parameters","durationSeconds"],l),i(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=i(t,["aspectRatio"]);if(e!==void 0&&a!=null&&r(e,["parameters","aspectRatio"],a),i(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=i(t,["personGeneration"]);if(e!==void 0&&u!=null&&r(e,["parameters","personGeneration"],u),i(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=i(t,["negativePrompt"]);if(e!==void 0&&c!=null&&r(e,["parameters","negativePrompt"],c),i(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Li(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["prompt"]);s!=null&&r(e,["instances[0]","prompt"],s);const l=i(t,["image"]);l!=null&&r(e,["instances[0]","image"],Ni(o,l));const a=i(t,["config"]);return a!=null&&r(e,["config"],Di(o,a,e)),e}function Vi(o,t){const e={},n=i(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const s=i(t,["thought"]);s!=null&&r(e,["thought"],s);const l=i(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=i(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=i(t,["fileData"]);u!=null&&r(e,["fileData"],u);const c=i(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=i(t,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=i(t,["inlineData"]);f!=null&&r(e,["inlineData"],f);const p=i(t,["text"]);return p!=null&&r(e,["text"],p),e}function U(o,t){const e={},n=i(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Vi(o,a))),r(e,["parts"],l)}const s=i(t,["role"]);return s!=null&&r(e,["role"],s),e}function Ui(o,t){const e={},n=i(t,["featureSelectionPreference"]);return n!=null&&r(e,["featureSelectionPreference"],n),e}function Fi(o,t){const e={},n=i(t,["method"]);n!=null&&r(e,["method"],n);const s=i(t,["category"]);s!=null&&r(e,["category"],s);const l=i(t,["threshold"]);return l!=null&&r(e,["threshold"],l),e}function ki(){return{}}function Gi(o,t){const e={},n=i(t,["mode"]);n!=null&&r(e,["mode"],n);const s=i(t,["dynamicThreshold"]);return s!=null&&r(e,["dynamicThreshold"],s),e}function qi(o,t){const e={},n=i(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Gi(o,n)),e}function Bi(){return{}}function Hi(o,t){const e={},n=i(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function bi(o,t){const e={},n=i(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],Hi(o,n));const s=i(t,["authType"]);s!=null&&r(e,["authType"],s);const l=i(t,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=i(t,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const u=i(t,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const c=i(t,["oidcConfig"]);return c!=null&&r(e,["oidcConfig"],c),e}function $i(o,t){const e={},n=i(t,["authConfig"]);return n!=null&&r(e,["authConfig"],bi(o,n)),e}function Pt(o,t){const e={},n=i(t,["retrieval"]);n!=null&&r(e,["retrieval"],n),i(t,["googleSearch"])!=null&&r(e,["googleSearch"],ki());const l=i(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],qi(o,l)),i(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],Bi());const u=i(t,["googleMaps"]);u!=null&&r(e,["googleMaps"],$i(o,u));const c=i(t,["codeExecution"]);c!=null&&r(e,["codeExecution"],c);const d=i(t,["functionDeclarations"]);return d!=null&&r(e,["functionDeclarations"],d),e}function Oi(o,t){const e={},n=i(t,["mode"]);n!=null&&r(e,["mode"],n);const s=i(t,["allowedFunctionNames"]);return s!=null&&r(e,["allowedFunctionNames"],s),e}function Ji(o,t){const e={},n=i(t,["latitude"]);n!=null&&r(e,["latitude"],n);const s=i(t,["longitude"]);return s!=null&&r(e,["longitude"],s),e}function Yi(o,t){const e={},n=i(t,["latLng"]);return n!=null&&r(e,["latLng"],Ji(o,n)),e}function Ki(o,t){const e={},n=i(t,["functionCallingConfig"]);n!=null&&r(e,["functionCallingConfig"],Oi(o,n));const s=i(t,["retrievalConfig"]);return s!=null&&r(e,["retrievalConfig"],Yi(o,s)),e}function Wi(o,t){const e={},n=i(t,["voiceName"]);return n!=null&&r(e,["voiceName"],n),e}function zi(o,t){const e={},n=i(t,["prebuiltVoiceConfig"]);return n!=null&&r(e,["prebuiltVoiceConfig"],Wi(o,n)),e}function Xi(o,t){const e={},n=i(t,["voiceConfig"]);n!=null&&r(e,["voiceConfig"],zi(o,n));const s=i(t,["languageCode"]);return s!=null&&r(e,["languageCode"],s),e}function Qi(o,t){const e={},n=i(t,["includeThoughts"]);n!=null&&r(e,["includeThoughts"],n);const s=i(t,["thinkingBudget"]);return s!=null&&r(e,["thinkingBudget"],s),e}function Zi(o,t,e){const n={},s=i(t,["systemInstruction"]);e!==void 0&&s!=null&&r(e,["systemInstruction"],U(o,w(o,s)));const l=i(t,["temperature"]);l!=null&&r(n,["temperature"],l);const a=i(t,["topP"]);a!=null&&r(n,["topP"],a);const u=i(t,["topK"]);u!=null&&r(n,["topK"],u);const c=i(t,["candidateCount"]);c!=null&&r(n,["candidateCount"],c);const d=i(t,["maxOutputTokens"]);d!=null&&r(n,["maxOutputTokens"],d);const f=i(t,["stopSequences"]);f!=null&&r(n,["stopSequences"],f);const p=i(t,["responseLogprobs"]);p!=null&&r(n,["responseLogprobs"],p);const h=i(t,["logprobs"]);h!=null&&r(n,["logprobs"],h);const m=i(t,["presencePenalty"]);m!=null&&r(n,["presencePenalty"],m);const g=i(t,["frequencyPenalty"]);g!=null&&r(n,["frequencyPenalty"],g);const T=i(t,["seed"]);T!=null&&r(n,["seed"],T);const y=i(t,["responseMimeType"]);y!=null&&r(n,["responseMimeType"],y);const _=i(t,["responseSchema"]);_!=null&&r(n,["responseSchema"],_t(o,_));const E=i(t,["routingConfig"]);E!=null&&r(n,["routingConfig"],E);const S=i(t,["modelSelectionConfig"]);S!=null&&r(n,["modelConfig"],Ui(o,S));const v=i(t,["safetySettings"]);if(e!==void 0&&v!=null){let P=v;Array.isArray(P)&&(P=P.map(te=>Fi(o,te))),r(e,["safetySettings"],P)}const I=i(t,["tools"]);if(e!==void 0&&I!=null){let P=Z(o,I);Array.isArray(P)&&(P=P.map(te=>Pt(o,Q(o,te)))),r(e,["tools"],P)}const F=i(t,["toolConfig"]);e!==void 0&&F!=null&&r(e,["toolConfig"],Ki(o,F));const k=i(t,["labels"]);e!==void 0&&k!=null&&r(e,["labels"],k);const G=i(t,["cachedContent"]);e!==void 0&&G!=null&&r(e,["cachedContent"],N(o,G));const q=i(t,["responseModalities"]);q!=null&&r(n,["responseModalities"],q);const x=i(t,["mediaResolution"]);x!=null&&r(n,["mediaResolution"],x);const L=i(t,["speechConfig"]);L!=null&&r(n,["speechConfig"],Xi(o,St(o,L)));const pe=i(t,["audioTimestamp"]);pe!=null&&r(n,["audioTimestamp"],pe);const he=i(t,["thinkingConfig"]);return he!=null&&r(n,["thinkingConfig"],Qi(o,he)),n}function ct(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["contents"]);if(s!=null){let a=R(o,s);Array.isArray(a)&&(a=a.map(u=>U(o,u))),r(e,["contents"],a)}const l=i(t,["config"]);return l!=null&&r(e,["generationConfig"],Zi(o,l,e)),e}function ji(o,t,e){const n={},s=i(t,["taskType"]);e!==void 0&&s!=null&&r(e,["instances[]","task_type"],s);const l=i(t,["title"]);e!==void 0&&l!=null&&r(e,["instances[]","title"],l);const a=i(t,["outputDimensionality"]);e!==void 0&&a!=null&&r(e,["parameters","outputDimensionality"],a);const u=i(t,["mimeType"]);e!==void 0&&u!=null&&r(e,["instances[]","mimeType"],u);const c=i(t,["autoTruncate"]);return e!==void 0&&c!=null&&r(e,["parameters","autoTruncate"],c),n}function es(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["contents"]);s!=null&&r(e,["instances[]","content"],vt(o,s));const l=i(t,["config"]);return l!=null&&r(e,["config"],ji(o,l,e)),e}function ts(o,t,e){const n={},s=i(t,["outputGcsUri"]);e!==void 0&&s!=null&&r(e,["parameters","storageUri"],s);const l=i(t,["negativePrompt"]);e!==void 0&&l!=null&&r(e,["parameters","negativePrompt"],l);const a=i(t,["numberOfImages"]);e!==void 0&&a!=null&&r(e,["parameters","sampleCount"],a);const u=i(t,["aspectRatio"]);e!==void 0&&u!=null&&r(e,["parameters","aspectRatio"],u);const c=i(t,["guidanceScale"]);e!==void 0&&c!=null&&r(e,["parameters","guidanceScale"],c);const d=i(t,["seed"]);e!==void 0&&d!=null&&r(e,["parameters","seed"],d);const f=i(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&r(e,["parameters","safetySetting"],f);const p=i(t,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const h=i(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&r(e,["parameters","includeSafetyAttributes"],h);const m=i(t,["includeRaiReason"]);e!==void 0&&m!=null&&r(e,["parameters","includeRaiReason"],m);const g=i(t,["language"]);e!==void 0&&g!=null&&r(e,["parameters","language"],g);const T=i(t,["outputMimeType"]);e!==void 0&&T!=null&&r(e,["parameters","outputOptions","mimeType"],T);const y=i(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&r(e,["parameters","outputOptions","compressionQuality"],y);const _=i(t,["addWatermark"]);e!==void 0&&_!=null&&r(e,["parameters","addWatermark"],_);const E=i(t,["enhancePrompt"]);return e!==void 0&&E!=null&&r(e,["parameters","enhancePrompt"],E),n}function ns(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["prompt"]);s!=null&&r(e,["instances[0]","prompt"],s);const l=i(t,["config"]);return l!=null&&r(e,["config"],ts(o,l,e)),e}function os(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","name"],A(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function is(o,t,e){const n={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=i(t,["filter"]);e!==void 0&&a!=null&&r(e,["_query","filter"],a);const u=i(t,["queryBase"]);return e!==void 0&&u!=null&&r(e,["_url","models_url"],Mt(o,u)),n}function ss(o,t){const e={},n=i(t,["config"]);return n!=null&&r(e,["config"],is(o,n,e)),e}function rs(o,t,e){const n={},s=i(t,["displayName"]);e!==void 0&&s!=null&&r(e,["displayName"],s);const l=i(t,["description"]);return e!==void 0&&l!=null&&r(e,["description"],l),n}function ls(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],rs(o,s,e)),e}function as(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","name"],A(o,n));const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function us(o,t,e){const n={},s=i(t,["systemInstruction"]);e!==void 0&&s!=null&&r(e,["systemInstruction"],U(o,w(o,s)));const l=i(t,["tools"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(c=>Pt(o,c))),r(e,["tools"],u)}const a=i(t,["generationConfig"]);return e!==void 0&&a!=null&&r(e,["generationConfig"],a),n}function ds(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["contents"]);if(s!=null){let a=R(o,s);Array.isArray(a)&&(a=a.map(u=>U(o,u))),r(e,["contents"],a)}const l=i(t,["config"]);return l!=null&&r(e,["config"],us(o,l,e)),e}function cs(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["contents"]);if(s!=null){let a=R(o,s);Array.isArray(a)&&(a=a.map(u=>U(o,u))),r(e,["contents"],a)}const l=i(t,["config"]);return l!=null&&r(e,["config"],l),e}function fs(o,t){const e={},n=i(t,["gcsUri"]);n!=null&&r(e,["gcsUri"],n);const s=i(t,["imageBytes"]);s!=null&&r(e,["bytesBase64Encoded"],D(o,s));const l=i(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function ps(o,t,e){const n={},s=i(t,["numberOfVideos"]);e!==void 0&&s!=null&&r(e,["parameters","sampleCount"],s);const l=i(t,["outputGcsUri"]);e!==void 0&&l!=null&&r(e,["parameters","storageUri"],l);const a=i(t,["fps"]);e!==void 0&&a!=null&&r(e,["parameters","fps"],a);const u=i(t,["durationSeconds"]);e!==void 0&&u!=null&&r(e,["parameters","durationSeconds"],u);const c=i(t,["seed"]);e!==void 0&&c!=null&&r(e,["parameters","seed"],c);const d=i(t,["aspectRatio"]);e!==void 0&&d!=null&&r(e,["parameters","aspectRatio"],d);const f=i(t,["resolution"]);e!==void 0&&f!=null&&r(e,["parameters","resolution"],f);const p=i(t,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const h=i(t,["pubsubTopic"]);e!==void 0&&h!=null&&r(e,["parameters","pubsubTopic"],h);const m=i(t,["negativePrompt"]);e!==void 0&&m!=null&&r(e,["parameters","negativePrompt"],m);const g=i(t,["enhancePrompt"]);return e!==void 0&&g!=null&&r(e,["parameters","enhancePrompt"],g),n}function hs(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const s=i(t,["prompt"]);s!=null&&r(e,["instances[0]","prompt"],s);const l=i(t,["image"]);l!=null&&r(e,["instances[0]","image"],fs(o,l));const a=i(t,["config"]);return a!=null&&r(e,["config"],ps(o,a,e)),e}function ms(o,t){const e={},n=i(t,["thought"]);n!=null&&r(e,["thought"],n);const s=i(t,["codeExecutionResult"]);s!=null&&r(e,["codeExecutionResult"],s);const l=i(t,["executableCode"]);l!=null&&r(e,["executableCode"],l);const a=i(t,["fileData"]);a!=null&&r(e,["fileData"],a);const u=i(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=i(t,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const d=i(t,["inlineData"]);d!=null&&r(e,["inlineData"],d);const f=i(t,["text"]);return f!=null&&r(e,["text"],f),e}function gs(o,t){const e={},n=i(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>ms(o,a))),r(e,["parts"],l)}const s=i(t,["role"]);return s!=null&&r(e,["role"],s),e}function Ts(o,t){const e={},n=i(t,["citationSources"]);return n!=null&&r(e,["citations"],n),e}function Cs(o,t){const e={},n=i(t,["content"]);n!=null&&r(e,["content"],gs(o,n));const s=i(t,["citationMetadata"]);s!=null&&r(e,["citationMetadata"],Ts(o,s));const l=i(t,["tokenCount"]);l!=null&&r(e,["tokenCount"],l);const a=i(t,["finishReason"]);a!=null&&r(e,["finishReason"],a);const u=i(t,["avgLogprobs"]);u!=null&&r(e,["avgLogprobs"],u);const c=i(t,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const d=i(t,["index"]);d!=null&&r(e,["index"],d);const f=i(t,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=i(t,["safetyRatings"]);return p!=null&&r(e,["safetyRatings"],p),e}function ft(o,t){const e={},n=i(t,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(c=>Cs(o,c))),r(e,["candidates"],u)}const s=i(t,["modelVersion"]);s!=null&&r(e,["modelVersion"],s);const l=i(t,["promptFeedback"]);l!=null&&r(e,["promptFeedback"],l);const a=i(t,["usageMetadata"]);return a!=null&&r(e,["usageMetadata"],a),e}function ys(o,t){const e={},n=i(t,["values"]);return n!=null&&r(e,["values"],n),e}function Es(){return{}}function vs(o,t){const e={},n=i(t,["embeddings"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>ys(o,a))),r(e,["embeddings"],l)}return i(t,["metadata"])!=null&&r(e,["metadata"],Es()),e}function _s(o,t){const e={},n=i(t,["bytesBase64Encoded"]);n!=null&&r(e,["imageBytes"],D(o,n));const s=i(t,["mimeType"]);return s!=null&&r(e,["mimeType"],s),e}function Rt(o,t){const e={},n=i(t,["safetyAttributes","categories"]);n!=null&&r(e,["categories"],n);const s=i(t,["safetyAttributes","scores"]);s!=null&&r(e,["scores"],s);const l=i(t,["contentType"]);return l!=null&&r(e,["contentType"],l),e}function Ss(o,t){const e={},n=i(t,["_self"]);n!=null&&r(e,["image"],_s(o,n));const s=i(t,["raiFilteredReason"]);s!=null&&r(e,["raiFilteredReason"],s);const l=i(t,["_self"]);return l!=null&&r(e,["safetyAttributes"],Rt(o,l)),e}function As(o,t){const e={},n=i(t,["predictions"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Ss(o,a))),r(e,["generatedImages"],l)}const s=i(t,["positivePromptSafetyAttributes"]);return s!=null&&r(e,["positivePromptSafetyAttributes"],Rt(o,s)),e}function Is(o,t){const e={},n=i(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const s=i(t,["createTime"]);s!=null&&r(e,["createTime"],s);const l=i(t,["updateTime"]);return l!=null&&r(e,["updateTime"],l),e}function ue(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(t,["description"]);l!=null&&r(e,["description"],l);const a=i(t,["version"]);a!=null&&r(e,["version"],a);const u=i(t,["_self"]);u!=null&&r(e,["tunedModelInfo"],Is(o,u));const c=i(t,["inputTokenLimit"]);c!=null&&r(e,["inputTokenLimit"],c);const d=i(t,["outputTokenLimit"]);d!=null&&r(e,["outputTokenLimit"],d);const f=i(t,["supportedGenerationMethods"]);return f!=null&&r(e,["supportedActions"],f),e}function Ms(o,t){const e={},n=i(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const s=i(t,["_self"]);if(s!=null){let l=wt(o,s);Array.isArray(l)&&(l=l.map(a=>ue(o,a))),r(e,["models"],l)}return e}function ws(){return{}}function xs(o,t){const e={},n=i(t,["totalTokens"]);n!=null&&r(e,["totalTokens"],n);const s=i(t,["cachedContentTokenCount"]);return s!=null&&r(e,["cachedContentTokenCount"],s),e}function Ps(o,t){const e={},n=i(t,["video","uri"]);n!=null&&r(e,["uri"],n);const s=i(t,["video","encodedVideo"]);s!=null&&r(e,["videoBytes"],D(o,s));const l=i(t,["encoding"]);return l!=null&&r(e,["mimeType"],l),e}function Rs(o,t){const e={},n=i(t,["_self"]);return n!=null&&r(e,["video"],Ps(o,n)),e}function Ns(o,t){const e={},n=i(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(u=>Rs(o,u))),r(e,["generatedVideos"],a)}const s=i(t,["raiMediaFilteredCount"]);s!=null&&r(e,["raiMediaFilteredCount"],s);const l=i(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function Ds(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(t,["done"]);l!=null&&r(e,["done"],l);const a=i(t,["error"]);a!=null&&r(e,["error"],a);const u=i(t,["response","generateVideoResponse"]);return u!=null&&r(e,["response"],Ns(o,u)),e}function Ls(o,t){const e={},n=i(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const s=i(t,["thought"]);s!=null&&r(e,["thought"],s);const l=i(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=i(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=i(t,["fileData"]);u!=null&&r(e,["fileData"],u);const c=i(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=i(t,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=i(t,["inlineData"]);f!=null&&r(e,["inlineData"],f);const p=i(t,["text"]);return p!=null&&r(e,["text"],p),e}function Vs(o,t){const e={},n=i(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Ls(o,a))),r(e,["parts"],l)}const s=i(t,["role"]);return s!=null&&r(e,["role"],s),e}function Us(o,t){const e={},n=i(t,["citations"]);return n!=null&&r(e,["citations"],n),e}function Fs(o,t){const e={},n=i(t,["content"]);n!=null&&r(e,["content"],Vs(o,n));const s=i(t,["citationMetadata"]);s!=null&&r(e,["citationMetadata"],Us(o,s));const l=i(t,["finishMessage"]);l!=null&&r(e,["finishMessage"],l);const a=i(t,["finishReason"]);a!=null&&r(e,["finishReason"],a);const u=i(t,["avgLogprobs"]);u!=null&&r(e,["avgLogprobs"],u);const c=i(t,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const d=i(t,["index"]);d!=null&&r(e,["index"],d);const f=i(t,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=i(t,["safetyRatings"]);return p!=null&&r(e,["safetyRatings"],p),e}function pt(o,t){const e={},n=i(t,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>Fs(o,f))),r(e,["candidates"],d)}const s=i(t,["createTime"]);s!=null&&r(e,["createTime"],s);const l=i(t,["responseId"]);l!=null&&r(e,["responseId"],l);const a=i(t,["modelVersion"]);a!=null&&r(e,["modelVersion"],a);const u=i(t,["promptFeedback"]);u!=null&&r(e,["promptFeedback"],u);const c=i(t,["usageMetadata"]);return c!=null&&r(e,["usageMetadata"],c),e}function ks(o,t){const e={},n=i(t,["truncated"]);n!=null&&r(e,["truncated"],n);const s=i(t,["token_count"]);return s!=null&&r(e,["tokenCount"],s),e}function Gs(o,t){const e={},n=i(t,["values"]);n!=null&&r(e,["values"],n);const s=i(t,["statistics"]);return s!=null&&r(e,["statistics"],ks(o,s)),e}function qs(o,t){const e={},n=i(t,["billableCharacterCount"]);return n!=null&&r(e,["billableCharacterCount"],n),e}function Bs(o,t){const e={},n=i(t,["predictions[]","embeddings"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Gs(o,a))),r(e,["embeddings"],l)}const s=i(t,["metadata"]);return s!=null&&r(e,["metadata"],qs(o,s)),e}function Hs(o,t){const e={},n=i(t,["gcsUri"]);n!=null&&r(e,["gcsUri"],n);const s=i(t,["bytesBase64Encoded"]);s!=null&&r(e,["imageBytes"],D(o,s));const l=i(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Nt(o,t){const e={},n=i(t,["safetyAttributes","categories"]);n!=null&&r(e,["categories"],n);const s=i(t,["safetyAttributes","scores"]);s!=null&&r(e,["scores"],s);const l=i(t,["contentType"]);return l!=null&&r(e,["contentType"],l),e}function bs(o,t){const e={},n=i(t,["_self"]);n!=null&&r(e,["image"],Hs(o,n));const s=i(t,["raiFilteredReason"]);s!=null&&r(e,["raiFilteredReason"],s);const l=i(t,["_self"]);l!=null&&r(e,["safetyAttributes"],Nt(o,l));const a=i(t,["prompt"]);return a!=null&&r(e,["enhancedPrompt"],a),e}function $s(o,t){const e={},n=i(t,["predictions"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>bs(o,a))),r(e,["generatedImages"],l)}const s=i(t,["positivePromptSafetyAttributes"]);return s!=null&&r(e,["positivePromptSafetyAttributes"],Nt(o,s)),e}function Os(o,t){const e={},n=i(t,["endpoint"]);n!=null&&r(e,["name"],n);const s=i(t,["deployedModelId"]);return s!=null&&r(e,["deployedModelId"],s),e}function Js(o,t){const e={},n=i(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&r(e,["baseModel"],n);const s=i(t,["createTime"]);s!=null&&r(e,["createTime"],s);const l=i(t,["updateTime"]);return l!=null&&r(e,["updateTime"],l),e}function de(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["displayName"]);s!=null&&r(e,["displayName"],s);const l=i(t,["description"]);l!=null&&r(e,["description"],l);const a=i(t,["versionId"]);a!=null&&r(e,["version"],a);const u=i(t,["deployedModels"]);if(u!=null){let f=u;Array.isArray(f)&&(f=f.map(p=>Os(o,p))),r(e,["endpoints"],f)}const c=i(t,["labels"]);c!=null&&r(e,["labels"],c);const d=i(t,["_self"]);return d!=null&&r(e,["tunedModelInfo"],Js(o,d)),e}function Ys(o,t){const e={},n=i(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const s=i(t,["_self"]);if(s!=null){let l=wt(o,s);Array.isArray(l)&&(l=l.map(a=>de(o,a))),r(e,["models"],l)}return e}function Ks(){return{}}function Ws(o,t){const e={},n=i(t,["totalTokens"]);return n!=null&&r(e,["totalTokens"],n),e}function zs(o,t){const e={},n=i(t,["tokensInfo"]);return n!=null&&r(e,["tokensInfo"],n),e}function Xs(o,t){const e={},n=i(t,["gcsUri"]);n!=null&&r(e,["uri"],n);const s=i(t,["bytesBase64Encoded"]);s!=null&&r(e,["videoBytes"],D(o,s));const l=i(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Qs(o,t){const e={},n=i(t,["_self"]);return n!=null&&r(e,["video"],Xs(o,n)),e}function Zs(o,t){const e={},n=i(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(u=>Qs(o,u))),r(e,["generatedVideos"],a)}const s=i(t,["raiMediaFilteredCount"]);s!=null&&r(e,["raiMediaFilteredCount"],s);const l=i(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function js(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(t,["done"]);l!=null&&r(e,["done"],l);const a=i(t,["error"]);a!=null&&r(e,["error"],a);const u=i(t,["response"]);return u!=null&&r(e,["response"],Zs(o,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const er="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function tr(o,t,e){const n=new Fn;let s;if(e.data instanceof Blob?s=JSON.parse(await e.data.text()):s=JSON.parse(e.data),o.isVertexAI()){const l=si(o,s);Object.assign(n,l)}else{const l=ii(o,s);Object.assign(n,l)}t(n)}class nr{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n}async connect(t){var e,n,s,l;const a=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let c;const d=rr(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())c=`${a}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{const v=this.apiClient.getApiKey();c=`${a}/ws/google.ai.generativelanguage.${u}.GenerativeService.BidiGenerateContent?key=${v}`}let f=()=>{};const p=new Promise(v=>{f=v}),h=t.callbacks,m=function(){var v;(v=h==null?void 0:h.onopen)===null||v===void 0||v.call(h),f({})},g=this.apiClient,T={onopen:m,onmessage:v=>{tr(g,h.onmessage,v)},onerror:(e=h==null?void 0:h.onerror)!==null&&e!==void 0?e:function(v){},onclose:(n=h==null?void 0:h.onclose)!==null&&n!==void 0?n:function(v){}},y=this.webSocketFactory.create(c,sr(d),T);y.connect(),await p;let _=A(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&_.startsWith("publishers/")){const v=this.apiClient.getProject(),I=this.apiClient.getLocation();_=`projects/${v}/locations/${I}/`+_}let E={};this.apiClient.isVertexAI()&&((s=t.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[z.AUDIO]}:t.config.responseModalities=[z.AUDIO]),!((l=t.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const S={model:_,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?E=No(this.apiClient,S):E=Ro(this.apiClient,S),delete E.config,y.send(JSON.stringify(E)),new ir(y,this.apiClient)}}const or={turnComplete:!0};class ir{constructor(t,e){this.conn=t,this.apiClient=e}tLiveClientContent(t,e){if(e.turns!==null&&e.turns!==void 0){let n=[];try{n=R(t,e.turns),t.isVertexAI()?n=n.map(s=>U(t,s)):n=n.map(s=>ee(t,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof e.turns}'`)}return{clientContent:{turns:n,turnComplete:e.turnComplete}}}return{clientContent:{turnComplete:e.turnComplete}}}tLiveClienttToolResponse(t,e){let n=[];if(e.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(e.functionResponses)?n=e.functionResponses:n=[e.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const l of n){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!t.isVertexAI()&&!("id"in l))throw new Error(er)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},or),t);const e=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(e))}sendRealtimeInput(t){let e={};this.apiClient.isVertexAI()?e={realtimeInput:ko(this.apiClient,t)}:e={realtimeInput:Fo(this.apiClient,t)},this.conn.send(JSON.stringify(e))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const e=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(e))}close(){this.conn.close()}}function sr(o){const t={};return o.forEach((e,n)=>{t[n]=e}),t}function rr(o){const t=new Headers;for(const[e,n]of Object.entries(o))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lr extends B{constructor(t){super(),this.apiClient=t,this.generateContent=async e=>await this.generateContentInternal(e),this.generateContentStream=async e=>await this.generateContentStreamInternal(e),this.generateImages=async e=>await this.generateImagesInternal(e).then(n=>{var s;let l;const a=[];if(n!=null&&n.generatedImages)for(const c of n.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?l=c==null?void 0:c.safetyAttributes:a.push(c);let u;return l?u={generatedImages:a,positivePromptSafetyAttributes:l}:u={generatedImages:a},u}),this.list=async e=>{var n;const a={config:Object.assign(Object.assign({},{queryBase:!0}),e==null?void 0:e.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((n=a.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new j(V.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(a),a)}}async generateContentInternal(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ct(this.apiClient,t);return u=C("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=pt(this.apiClient,f),h=new H;return Object.assign(h,p),h})}else{const d=dt(this.apiClient,t);return u=C("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=ft(this.apiClient,f),h=new H;return Object.assign(h,p),h})}}async generateContentStreamInternal(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ct(this.apiClient,t);u=C("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const f=this.apiClient;return a=f.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}),a.then(function(p){return X(this,arguments,function*(){var h,m,g,T;try{for(var y=!0,_=le(p),E;E=yield M(_.next()),h=E.done,!h;y=!0){T=E.value,y=!1;const v=pt(f,yield M(T.json())),I=new H;Object.assign(I,v),yield yield M(I)}}catch(S){m={error:S}}finally{try{!y&&!h&&(g=_.return)&&(yield M(g.call(_)))}finally{if(m)throw m.error}}})})}else{const d=dt(this.apiClient,t);u=C("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const f=this.apiClient;return a=f.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}),a.then(function(p){return X(this,arguments,function*(){var h,m,g,T;try{for(var y=!0,_=le(p),E;E=yield M(_.next()),h=E.done,!h;y=!0){T=E.value,y=!1;const v=ft(f,yield M(T.json())),I=new H;Object.assign(I,v),yield yield M(I)}}catch(S){m={error:S}}finally{try{!y&&!h&&(g=_.return)&&(yield M(g.call(_)))}finally{if(m)throw m.error}}})})}}async embedContent(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=es(this.apiClient,t);return u=C("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Bs(this.apiClient,f),h=new Qe;return Object.assign(h,p),h})}else{const d=Ei(this.apiClient,t);return u=C("{model}:batchEmbedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=vs(this.apiClient,f),h=new Qe;return Object.assign(h,p),h})}}async generateImagesInternal(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ns(this.apiClient,t);return u=C("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=$s(this.apiClient,f),h=new Ze;return Object.assign(h,p),h})}else{const d=_i(this.apiClient,t);return u=C("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=As(this.apiClient,f),h=new Ze;return Object.assign(h,p),h})}}async get(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=os(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>de(this.apiClient,f))}else{const d=Si(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>ue(this.apiClient,f))}}async listInternal(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ss(this.apiClient,t);return u=C("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Ys(this.apiClient,f),h=new je;return Object.assign(h,p),h})}else{const d=Ii(this.apiClient,t);return u=C("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Ms(this.apiClient,f),h=new je;return Object.assign(h,p),h})}}async update(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ls(this.apiClient,t);return u=C("{model}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>de(this.apiClient,f))}else{const d=wi(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>ue(this.apiClient,f))}}async delete(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=as(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(()=>{const f=Ks(),p=new et;return Object.assign(p,f),p})}else{const d=xi(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(()=>{const f=ws(),p=new et;return Object.assign(p,f),p})}}async countTokens(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ds(this.apiClient,t);return u=C("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Ws(this.apiClient,f),h=new tt;return Object.assign(h,p),h})}else{const d=Ri(this.apiClient,t);return u=C("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=xs(this.apiClient,f),h=new tt;return Object.assign(h,p),h})}}async computeTokens(t){var e,n;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=cs(this.apiClient,t);return l=C("{model}:computeTokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),s.then(c=>{const d=zs(this.apiClient,c),f=new Dn;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=hs(this.apiClient,t);return u=C("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>js(this.apiClient,f))}else{const d=Li(this.apiClient,t);return u=C("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Ds(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ar(o,t){const e={},n=i(t,["operationName"]);n!=null&&r(e,["_url","operationName"],n);const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function ur(o,t){const e={},n=i(t,["operationName"]);n!=null&&r(e,["_url","operationName"],n);const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function dr(o,t){const e={},n=i(t,["operationName"]);n!=null&&r(e,["operationName"],n);const s=i(t,["resourceName"]);s!=null&&r(e,["_url","resourceName"],s);const l=i(t,["config"]);return l!=null&&r(e,["config"],l),e}function cr(o,t){const e={},n=i(t,["video","uri"]);n!=null&&r(e,["uri"],n);const s=i(t,["video","encodedVideo"]);s!=null&&r(e,["videoBytes"],D(o,s));const l=i(t,["encoding"]);return l!=null&&r(e,["mimeType"],l),e}function fr(o,t){const e={},n=i(t,["_self"]);return n!=null&&r(e,["video"],cr(o,n)),e}function pr(o,t){const e={},n=i(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(u=>fr(o,u))),r(e,["generatedVideos"],a)}const s=i(t,["raiMediaFilteredCount"]);s!=null&&r(e,["raiMediaFilteredCount"],s);const l=i(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function hr(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(t,["done"]);l!=null&&r(e,["done"],l);const a=i(t,["error"]);a!=null&&r(e,["error"],a);const u=i(t,["response","generateVideoResponse"]);return u!=null&&r(e,["response"],pr(o,u)),e}function mr(o,t){const e={},n=i(t,["gcsUri"]);n!=null&&r(e,["uri"],n);const s=i(t,["bytesBase64Encoded"]);s!=null&&r(e,["videoBytes"],D(o,s));const l=i(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function gr(o,t){const e={},n=i(t,["_self"]);return n!=null&&r(e,["video"],mr(o,n)),e}function Tr(o,t){const e={},n=i(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(u=>gr(o,u))),r(e,["generatedVideos"],a)}const s=i(t,["raiMediaFilteredCount"]);s!=null&&r(e,["raiMediaFilteredCount"],s);const l=i(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function ht(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(t,["done"]);l!=null&&r(e,["done"],l);const a=i(t,["error"]);a!=null&&r(e,["error"],a);const u=i(t,["response"]);return u!=null&&r(e,["response"],Tr(o,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cr extends B{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const e=t.operation,n=t.config;if(e.name===void 0||e.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=e.name.split("/operations/")[0];let l;return n&&"httpOptions"in n&&(l=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:e.name,resourceName:s,config:{httpOptions:l}})}else return this.getVideosOperationInternal({operationName:e.name,config:n})}async getVideosOperationInternal(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ur(this.apiClient,t);return u=C("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>ht(this.apiClient,f))}else{const d=ar(this.apiClient,t);return u=C("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>hr(this.apiClient,f))}}async fetchPredictVideosOperationInternal(t){var e,n;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=dr(this.apiClient,t);return l=C("{resourceName}:fetchPredictOperation",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),s.then(c=>ht(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yr="Content-Type",Er="X-Server-Timeout",vr="User-Agent",_r="x-goog-api-client",Sr="0.13.0",Ar=`google-genai-sdk/${Sr}`,Ir="v1beta1",Mr="v1beta",mt=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Dt extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ClientError"}}class ce extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ServerError"}}class wr{constructor(t){var e,n;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(e=this.clientOptions.apiVersion)!==null&&e!==void 0?e:Ir,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Mr,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),e=new URL(t);return e.protocol=e.protocol=="http:"?"ws":"wss",e.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,e,n){const s=[this.getRequestUrlInternal(e)];return n&&s.push(this.getBaseResourcePath()),t!==""&&s.push(t),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),s=this.constructUrl(t.path,e,n);if(t.queryParams)for(const[a,u]of Object.entries(t.queryParams))s.searchParams.append(a,String(u));let l={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=t.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,e,t.abortSignal),this.unaryApiCall(s,l,t.httpMethod)}patchHttpOptions(t,e){const n=JSON.parse(JSON.stringify(t));for(const[s,l]of Object.entries(e))typeof l=="object"?n[s]=Object.assign(Object.assign({},n[s]),l):l!==void 0&&(n[s]=l);return n}async requestStream(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),s=this.constructUrl(t.path,e,n);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let l={};return l.body=t.body,l=await this.includeExtraHttpOptionsToRequestInit(l,e,t.abortSignal),this.streamApiCall(s,l,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,e,n){if(e&&e.timeout||n){const s=new AbortController,l=s.signal;e.timeout&&(e==null?void 0:e.timeout)>0&&setTimeout(()=>s.abort(),e.timeout),n&&n.addEventListener("abort",()=>{s.abort()}),t.signal=l}return t.headers=await this.getHeadersInternal(e),t}async unaryApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async s=>(await gt(s),new re(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async s=>(await gt(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(t){var e;return X(this,arguments,function*(){const s=(e=t==null?void 0:t.body)===null||e===void 0?void 0:e.getReader(),l=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let a="";for(;;){const{done:u,value:c}=yield M(s.read());if(u){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=l.decode(c);try{const p=JSON.parse(d);if("error"in p){const h=JSON.parse(JSON.stringify(p.error)),m=h.status,g=h.code,T=`got status: ${m}. ${JSON.stringify(p)}`;if(g>=400&&g<500)throw new Dt(T);if(g>=500&&g<600)throw new ce(T)}}catch(p){const h=p;if(h.name==="ClientError"||h.name==="ServerError")throw p}a+=d;let f=a.match(mt);for(;f;){const p=f[1];try{const h=new Response(p,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield M(new re(h)),a=a.slice(f[0].length),f=a.match(mt)}catch(h){throw new Error(`exception parsing stream chunk ${p}. ${h}`)}}}}finally{s.releaseLock()}})}async apiCall(t,e){return fetch(t,e).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},e=Ar+" "+this.clientOptions.userAgentExtra;return t[vr]=e,t[_r]=e,t[yr]="application/json",t}async getHeadersInternal(t){const e=new Headers;if(t&&t.headers){for(const[n,s]of Object.entries(t.headers))e.append(n,s);t.timeout&&t.timeout>0&&e.append(Er,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(e),e}async uploadFile(t,e){var n;const s={};e!=null&&(s.mimeType=e.mimeType,s.name=e.name,s.displayName=e.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const l=this.clientOptions.uploader,a=await l.stat(t);s.sizeBytes=String(a.size);const u=(n=e==null?void 0:e.mimeType)!==null&&n!==void 0?n:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=u;const c=await this.fetchUploadUrl(s,e);return l.upload(t,c,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,e){var n;let s={};e!=null&&e.httpOptions?s=e.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const l={file:t},a=await this.request({path:C("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:s});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(n=a==null?void 0:a.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function gt(o){var t;if(o===void 0)throw new ce("response is undefined");if(!o.ok){const e=o.status,n=o.statusText;let s;!((t=o.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?s=await o.json():s={error:{message:await o.text(),code:o.status,status:o.statusText}};const l=`got status: ${e} ${n}. ${JSON.stringify(s)}`;throw e>=400&&e<500?new Dt(l):e>=500&&e<600?new ce(l):new Error(l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xr(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","name"],n);const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function Pr(o,t,e){const n={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=i(t,["filter"]);return e!==void 0&&a!=null&&r(e,["_query","filter"],a),n}function Rr(o,t){const e={},n=i(t,["config"]);return n!=null&&r(e,["config"],Pr(o,n,e)),e}function Nr(o,t){const e={},n=i(t,["textInput"]);n!=null&&r(e,["textInput"],n);const s=i(t,["output"]);return s!=null&&r(e,["output"],s),e}function Dr(o,t){const e={};if(i(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=i(t,["examples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Nr(o,l))),r(e,["examples","examples"],s)}return e}function Lr(o,t,e){const n={};if(i(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=i(t,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&r(e,["displayName"],s),i(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=i(t,["epochCount"]);e!==void 0&&l!=null&&r(e,["tuningTask","hyperparameters","epochCount"],l);const a=i(t,["learningRateMultiplier"]);if(a!=null&&r(n,["tuningTask","hyperparameters","learningRateMultiplier"],a),i(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=i(t,["batchSize"]);e!==void 0&&u!=null&&r(e,["tuningTask","hyperparameters","batchSize"],u);const c=i(t,["learningRate"]);return e!==void 0&&c!=null&&r(e,["tuningTask","hyperparameters","learningRate"],c),n}function Vr(o,t){const e={},n=i(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const s=i(t,["trainingDataset"]);s!=null&&r(e,["tuningTask","trainingData"],Dr(o,s));const l=i(t,["config"]);return l!=null&&r(e,["config"],Lr(o,l,e)),e}function Ur(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["_url","name"],n);const s=i(t,["config"]);return s!=null&&r(e,["config"],s),e}function Fr(o,t,e){const n={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&r(e,["_query","pageSize"],s);const l=i(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=i(t,["filter"]);return e!==void 0&&a!=null&&r(e,["_query","filter"],a),n}function kr(o,t){const e={},n=i(t,["config"]);return n!=null&&r(e,["config"],Fr(o,n,e)),e}function Gr(o,t,e){const n={},s=i(t,["gcsUri"]);if(e!==void 0&&s!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],s),i(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function qr(o,t){const e={},n=i(t,["gcsUri"]);return n!=null&&r(e,["validationDatasetUri"],n),e}function Br(o,t,e){const n={},s=i(t,["validationDataset"]);e!==void 0&&s!=null&&r(e,["supervisedTuningSpec"],qr(o,s));const l=i(t,["tunedModelDisplayName"]);e!==void 0&&l!=null&&r(e,["tunedModelDisplayName"],l);const a=i(t,["description"]);e!==void 0&&a!=null&&r(e,["description"],a);const u=i(t,["epochCount"]);e!==void 0&&u!=null&&r(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const c=i(t,["learningRateMultiplier"]);e!==void 0&&c!=null&&r(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=i(t,["adapterSize"]);if(e!==void 0&&d!=null&&r(e,["supervisedTuningSpec","hyperParameters","adapterSize"],d),i(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(i(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function Hr(o,t){const e={},n=i(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const s=i(t,["trainingDataset"]);s!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],Gr(o,s,e));const l=i(t,["config"]);return l!=null&&r(e,["config"],Br(o,l,e)),e}function br(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["model"],n);const s=i(t,["name"]);return s!=null&&r(e,["endpoint"],s),e}function Lt(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["state"]);s!=null&&r(e,["state"],At(o,s));const l=i(t,["createTime"]);l!=null&&r(e,["createTime"],l);const a=i(t,["tuningTask","startTime"]);a!=null&&r(e,["startTime"],a);const u=i(t,["tuningTask","completeTime"]);u!=null&&r(e,["endTime"],u);const c=i(t,["updateTime"]);c!=null&&r(e,["updateTime"],c);const d=i(t,["description"]);d!=null&&r(e,["description"],d);const f=i(t,["baseModel"]);f!=null&&r(e,["baseModel"],f);const p=i(t,["_self"]);p!=null&&r(e,["tunedModel"],br(o,p));const h=i(t,["distillationSpec"]);h!=null&&r(e,["distillationSpec"],h);const m=i(t,["experiment"]);m!=null&&r(e,["experiment"],m);const g=i(t,["labels"]);g!=null&&r(e,["labels"],g);const T=i(t,["pipelineJob"]);T!=null&&r(e,["pipelineJob"],T);const y=i(t,["tunedModelDisplayName"]);return y!=null&&r(e,["tunedModelDisplayName"],y),e}function $r(o,t){const e={},n=i(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const s=i(t,["tunedModels"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>Lt(o,a))),r(e,["tuningJobs"],l)}return e}function Or(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["metadata"]);s!=null&&r(e,["metadata"],s);const l=i(t,["done"]);l!=null&&r(e,["done"],l);const a=i(t,["error"]);return a!=null&&r(e,["error"],a),e}function Jr(o,t){const e={},n=i(t,["model"]);n!=null&&r(e,["model"],n);const s=i(t,["endpoint"]);return s!=null&&r(e,["endpoint"],s),e}function fe(o,t){const e={},n=i(t,["name"]);n!=null&&r(e,["name"],n);const s=i(t,["state"]);s!=null&&r(e,["state"],At(o,s));const l=i(t,["createTime"]);l!=null&&r(e,["createTime"],l);const a=i(t,["startTime"]);a!=null&&r(e,["startTime"],a);const u=i(t,["endTime"]);u!=null&&r(e,["endTime"],u);const c=i(t,["updateTime"]);c!=null&&r(e,["updateTime"],c);const d=i(t,["error"]);d!=null&&r(e,["error"],d);const f=i(t,["description"]);f!=null&&r(e,["description"],f);const p=i(t,["baseModel"]);p!=null&&r(e,["baseModel"],p);const h=i(t,["tunedModel"]);h!=null&&r(e,["tunedModel"],Jr(o,h));const m=i(t,["supervisedTuningSpec"]);m!=null&&r(e,["supervisedTuningSpec"],m);const g=i(t,["tuningDataStats"]);g!=null&&r(e,["tuningDataStats"],g);const T=i(t,["encryptionSpec"]);T!=null&&r(e,["encryptionSpec"],T);const y=i(t,["partnerModelTuningSpec"]);y!=null&&r(e,["partnerModelTuningSpec"],y);const _=i(t,["distillationSpec"]);_!=null&&r(e,["distillationSpec"],_);const E=i(t,["experiment"]);E!=null&&r(e,["experiment"],E);const S=i(t,["labels"]);S!=null&&r(e,["labels"],S);const v=i(t,["pipelineJob"]);v!=null&&r(e,["pipelineJob"],v);const I=i(t,["tunedModelDisplayName"]);return I!=null&&r(e,["tunedModelDisplayName"],I),e}function Yr(o,t){const e={},n=i(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const s=i(t,["tuningJobs"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(a=>fe(o,a))),r(e,["tuningJobs"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kr extends B{constructor(t){super(),this.apiClient=t,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new j(V.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{const n=await this.tuneMldevInternal(e);let s="";return n.metadata!==void 0&&n.metadata.tunedModel!==void 0?s=n.metadata.tunedModel:n.name!==void 0&&n.name.includes("/operations/")&&(s=n.name.split("/operations/")[0]),{name:s,state:se.JOB_STATE_QUEUED}}}}async getInternal(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ur(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>fe(this.apiClient,f))}else{const d=xr(this.apiClient,t);return u=C("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Lt(this.apiClient,f))}}async listInternal(t){var e,n,s,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=kr(this.apiClient,t);return u=C("tuningJobs",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Yr(this.apiClient,f),h=new nt;return Object.assign(h,p),h})}else{const d=Rr(this.apiClient,t);return u=C("tunedModels",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=$r(this.apiClient,f),h=new nt;return Object.assign(h,p),h})}}async tuneInternal(t){var e,n;let s,l="",a={};if(this.apiClient.isVertexAI()){const u=Hr(this.apiClient,t);return l=C("tuningJobs",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),s.then(c=>fe(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var e,n;let s,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Vr(this.apiClient,t);return l=C("tunedModels",u._url),a=u._query,delete u.config,delete u._url,delete u._query,s=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),s.then(c=>Or(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wr{async download(t,e){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const zr=1024*1024*8,Xr=3,Qr=1e3,Zr=2,ne="x-goog-upload-status";async function jr(o,t,e){var n,s,l;let a=0,u=0,c=new re(new Response),d="upload";for(a=o.size;u<a;){const p=Math.min(zr,a-u),h=o.slice(u,u+p);u+p>=a&&(d+=", finalize");let m=0,g=Qr;for(;m<Xr&&(c=await e.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((n=c==null?void 0:c.headers)===null||n===void 0)&&n[ne]));)m++,await tl(g),g=g*Zr;if(u+=p,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[ne])!=="active")break;if(a<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(c==null?void 0:c.json());if(((l=c==null?void 0:c.headers)===null||l===void 0?void 0:l[ne])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function el(o){return{size:o.size,type:o.type}}function tl(o){return new Promise(t=>setTimeout(t,o))}class nl{async upload(t,e,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await jr(t,e,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await el(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ol{create(t,e,n){return new il(t,e,n)}}class il{constructor(t,e,n){this.url=t,this.headers=e,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Tt="x-goog-api-key";class sl{constructor(t){this.apiKey=t}async addAuthHeaders(t){t.get(Tt)===null&&t.append(Tt,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rl="gl-node/";class ll{constructor(t){var e;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(e=t.vertexai)!==null&&e!==void 0?e:!1,this.apiKey=t.apiKey;const n=kt(t,void 0,void 0);n&&(t.httpOptions?t.httpOptions.baseUrl=n:t.httpOptions={baseUrl:n}),this.apiVersion=t.apiVersion;const s=new sl(this.apiKey);this.apiClient=new wr({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:rl+"web",uploader:new nl,downloader:new Wr}),this.models=new lr(this.apiClient),this.live=new nr(this.apiClient,s,new ol),this.chats=new Hn(this.models,this.apiClient),this.caches=new kn(this.apiClient),this.files=new eo(this.apiClient),this.operations=new Cr(this.apiClient),this.tunings=new Kr(this.apiClient)}}window.GLOBAL_CHAT_MODULE=null;window.GLOBAL_CHAT_MACHINE_INDEX=null;window.GLOBAL_CHAT_PROBLEM=null;window.GLOBAL_OPERARIO=void 0;const J=["RECTA 1 AGUJA","RECTA 2 AGUJAS","OVERLOCK","COVERSTITCH","PRESILLADORA","ZZ","OJAL","BOTON","SCHIPS","ISEW","FLAT SEAMER","SUPREME"],oe=[{name:"TENSIÓN",key:"tension",times:[2,2,3,3,2,3,3,3,3,3,5,2]},{name:"TIPO Y POSICIÓN DE AGUJAS",key:"agujas",times:[1,1,2,2,1,1,1,1,2,2,2,1]},{name:"ENHEBRADO HILO",key:"enhebrado",times:[1,.5,2,2,1,1,1,1,2,2,4,4]},{name:"PRESIÓN PRENSATELAS",key:"prensatelas",times:[.5,1,.5,.5,null,.5,null,null,.5,.5,1,null]},{name:"PPP",key:"ppp",times:[1,1,1,1,null,1,null,null,1,1,null,null]}];class al{constructor(){this.state={ai:null,modelName:"gemini-2.5-pro-exp-03-25",userProblem:"",userModule:"",selectedMachineIndex:null,nextResponseHandler:null,currentStep:null,totalEstimatedIATime:0,actualStepTimes:{}},this.elements={chatMessages:null,messageInput:null,form:null},this.activeIntervals=[],this.handleSubmit=this.handleSubmit.bind(this),this.cleanup=this.cleanup.bind(this)}initializeElements(){this.elements={chatMessages:document.getElementById("chat-messages"),messageInput:document.getElementById("message"),form:document.getElementById("chat-form")}}init(){try{if(this.initializeElements(),!this.elements.form)throw new Error("Chat form not found");const t=this.elements.form.getAttribute("data-gemini-key");if(!t)throw new Error("Gemini API key not found");this.state.ai=new ll({apiKey:t}),this.setupEventListeners(),this.startConversation(this.elements.chatMessages)}catch(t){console.error("Initialization error:",t),this.showError("Error al inicializar el chat")}}showError(t){Swal.fire({icon:"error",title:"Error",text:t,customClass:{container:"z-50"}})}async startConversation(t){const e=this.getTimeBasedGreeting();await this.appendChatMessage(`${e}`,t),await this.askModule(t)}setupEventListeners(){this.elements.form.addEventListener("submit",this.handleSubmit),new MutationObserver(()=>{this.elements.chatMessages.scrollTop=this.elements.chatMessages.scrollHeight}).observe(this.elements.chatMessages,{childList:!0,subtree:!0})}isGreeting(t){const e=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return GREETINGS.some(n=>e.includes(n))}getTimeBasedGreeting(){const t=new Date().getHours();return t>=5&&t<12?"Hola, buenos días ☀ !":t>=12&&t<19?"Hola, buenas tardes 🌤 !":"Hola, buenas noches 🌕!"}async showTypingIndicator(t){const e=document.createElement("div");e.className="text-left mb-4 flex items-start gap-2";const n=document.createElement("div");n.className="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600 flex-shrink-0",n.innerHTML=`
            <img class="w-10 h-10 p-1 rounded-full ring-2 ring-gray-300 dark:ring-gray-500"
                 src="/images/Avatar.webp"
                 alt="AI Avatar">
        `;const s=document.createElement("span");s.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%] animate-pulse",s.textContent="Escribiendo...",e.appendChild(n),e.appendChild(s),t.appendChild(e),t.scrollTop=t.scrollHeight,await new Promise(l=>setTimeout(l,1500)),e.remove()}async appendChatMessage(t,e){await this.showTypingIndicator(e);const n=document.createElement("div");n.className="text-left mb-4 flex items-start gap-2";const s=document.createElement("div");s.className="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600 flex-shrink-0",s.innerHTML=`
            <img class="w-10 h-10 p-1 rounded-full ring-2 ring-gray-300 dark:ring-gray-500"
                 src="/images/Avatar.webp"
                 alt="AI Avatar">
        `;const l=document.createElement("span");l.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]",l.innerHTML=t,n.appendChild(s),n.appendChild(l),e.appendChild(n),e.scrollTop=e.scrollHeight}async handleSubmit(t){t.preventDefault(),t.stopPropagation();try{const e=this.elements.messageInput.value.trim();if(!e)return;if(this.elements.chatMessages.innerHTML+=`
                <div class="text-right mb-4">
                    <span class="bg-blue-500 text-white p-3 rounded-lg inline-block max-w-[70%]">
                    ${this.escapeHtml(e)}
                    </span>
                </div>`,this.elements.messageInput.value="",this.state.nextResponseHandler){const n=this.state.nextResponseHandler;this.state.nextResponseHandler=null,await n(e)}}catch(e){this.showError("Error al procesar el mensaje"),console.error(e)}}askModule(t){const e=document.createElement("div");e.className="text-left mb-4";const n=document.createElement("span");n.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]",n.innerHTML=`Por favor selecciona el modulo que se atendera:<br>
            <select id="modul" style="width:100%"></select>
            <div id="operario-select-container" class="mt-4"></div>`,e.appendChild(n),t.appendChild(e),t.scrollTop=t.scrollHeight,setTimeout(()=>{window.$&&$("#modul").length&&($("#modul").select2({placeholder:"Selecciona un módulo",ajax:{url:"/obtener-modulos",type:"GET",dataType:"json",delay:250,data:function(s){return{search:s.term||""}},processResults:function(s,l){let a=$.map(s,function(u){return{id:u.Modulo,text:u.Modulo}});if(l.term&&l.term.length>0){const u=l.term.toLowerCase();a=a.filter(c=>c.text.toLowerCase().includes(u))}return{results:a}}},minimumResultsForSearch:0}),$("#modul").on("select2:open",function(){$(".select2-search__field").focus()}),$("#modul").on("select2:select",s=>{const l=s.params.data.text||"";if(this.state.userModule&&this.state.userModule!==l){this.state.userModule=l,window.GLOBAL_CHAT_MODULE=l,this.showOperarioSelect(l);return}this.state.userModule=l,window.GLOBAL_CHAT_MODULE=l,window.iaChatStep=3,this.showOperarioSelect(l)}))},100),window.iaChatStep=99}showOperarioSelect(t){const e=document.getElementById("operario-select-container");e&&(e.innerHTML=`<label class="block mb-2">Selecciona el operario:</label>
            <select id="operario-select" style="width:100%"></select>`,setTimeout(()=>{window.$&&$("#operario-select").length&&($("#operario-select").select2({placeholder:"Selecciona un operario",ajax:{url:"/obtener-operarios",type:"GET",dataType:"json",delay:250,data:function(n){return{modulo:t,search:n.term||""}},processResults:function(n,s){let l=$.map(n,function(a){return{id:a.NumOperario,text:`${a.Nombre} - ${a.NumOperario}`}});if(s.term&&s.term.length>0){const a=s.term.toLowerCase();l=l.filter(u=>u.text.toLowerCase().includes(a))}return{results:l}}},minimumResultsForSearch:0}),$("#operario-select").on("select2:open",function(){$(".select2-search__field").focus()}),$("#operario-select").on("select2:select",n=>{const s=n.params.data.id,l=n.params.data.text;this.state.selectedOperario={id:s,text:l};const a=l.split(" - ");window.GLOBAL_OPERARIO={nombre:a[0]||"",numero:a[1]||""},this.showMachineSelect()}))},100))}showMachineSelect(){const t=this.elements.chatMessages,e=document.createElement("div");e.className="text-left mb-4";const n=document.createElement("span");n.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]";let s=`<label class="block mb-2">Por favor selecciona el tipo de máquina:</label>
        <select id="machine-select" class="w-full p-2 border rounded dark:bg-gray-700 dark:text-white">
            <option value="">Selecciona una máquina</option>`;J.forEach((l,a)=>{s+=`<option value="${a}">${l}</option>`}),s+='</select><div id="machine-steps" class="mt-4"></div>',n.innerHTML=s,e.appendChild(n),t.appendChild(e),t.scrollTop=t.scrollHeight,this.setupMachineSelectListener()}setupMachineSelectListener(){const t=document.getElementById("machine-select");t&&t.addEventListener("change",e=>{const n=parseInt(e.target.value);if(!isNaN(n)){if(typeof this.state.selectedMachineIndex=="number"&&this.state.selectedMachineIndex!==null&&this.state.selectedMachineIndex!==n){this.state.selectedMachineIndex=n,window.GLOBAL_CHAT_MACHINE_INDEX=n;return}this.state.selectedMachineIndex=n,window.GLOBAL_CHAT_MACHINE_INDEX=n,this.askUserProblem(n)}})}async askUserProblem(t){const e=this.elements.chatMessages;await this.appendChatMessage("Por favor, describe el problema que estás teniendo con la máquina:",e),this.elements.messageInput.disabled=!1,this.elements.messageInput.focus(),this.state.selectedMachineIndex=t,window.GLOBAL_CHAT_MACHINE_INDEX=t,this.state.nextResponseHandler=async n=>{this.state.userProblem=n||"",window.GLOBAL_CHAT_PROBLEM=this.state.userProblem,await this.showSummary(e),setTimeout(()=>{this.showSteps(this.state.selectedMachineIndex)},1e3)}}showSummary(t){const e=document.createElement("div");e.className="text-left mb-4";const n=document.createElement("span");n.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]";let s="",l="";if(this.state.selectedOperario&&this.state.selectedOperario.text){const a=this.state.selectedOperario.text.split(" - ");s=a[0]||"",l=a[1]||""}return n.innerHTML=`<strong>Resumen de la solicitud:</strong><br>
            <b>Módulo:</b> ${this.escapeHtml(this.state.userModule)}<br>
            <b>Operario:</b> ${this.escapeHtml(l)}<br>
            <b>Nombre:</b> ${this.escapeHtml(s)}<br>
            <b>Máquina:</b> ${this.escapeHtml(J[this.state.selectedMachineIndex])}<br>
            <b>Problema/Descripción:</b> ${this.escapeHtml(this.state.userProblem)}`,e.appendChild(n),t.appendChild(e),t.scrollTop=t.scrollHeight,new Promise(a=>setTimeout(a,1e3))}async showSteps(t){const e=this.elements.chatMessages;this.cleanup(),this.elements.messageInput.disabled=!0,await this.appendChatMessage("Por favor sigue estos pasos:",e),this.state.totalEstimatedIATime=0,oe.forEach(s=>{const l=s.times[t];l!==null&&(this.state.totalEstimatedIATime+=l)}),console.log(`Tiempo total estimado de pasos de IA para máquina ${J[t]}: ${this.state.totalEstimatedIATime} minutos`),setTimeout(()=>{let s=0;const l=()=>{if(s>=oe.length){this.elements.messageInput.disabled=!1,this.showFinalQuestion();return}const a=oe[s],u=a.times[t];if(u===null){s++,l();return}this.showStep(a,u,s,()=>{s++,l()})};l()},500)}async showStep(t,e,n,s){const l=this.elements.chatMessages,a=document.createElement("div");a.className="text-left mb-4";const u=document.createElement("span");u.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%] flex flex-col";let c=e>=1?`${Math.round(e)} min`:`${Math.round(e*60)} seg`,d=Math.round(e*60),f=d;u.innerHTML=`
            <strong>Paso ${n+1}:</strong> ${t.name}
            <span class="ml-2 text-xs text-gray-500">
                (<span class="timer">${this.formatTime(f)}</span> restante | <span class="timer-num">${c}</span>)
            </span>
            <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-2 next-step-btn">
                Siguiente paso
            </button>`,a.appendChild(u),l.appendChild(a),this.elements.messageInput.disabled=!0;let p=!1;const h=u.querySelector(".next-step-btn");(!this.state.actualStepTimes||typeof this.state.actualStepTimes!="object")&&(this.state.actualStepTimes={});const m=()=>{if(p)return;p=!0,clearInterval(this.state.currentStep.interval),h.disabled=!0;const g=d-f;this.state.actualStepTimes||(this.state.actualStepTimes={}),this.state.actualStepTimes[t.key]=g,console.log(`Paso "${t.name}" completado. Tiempo real: ${g} segundos.`),this.state.currentStep=null,s()};this.state.currentStep={interval:setInterval(()=>{f--,u.querySelector(".timer").textContent=this.formatTime(f),f<=0&&m()},1e3),element:u},h.addEventListener("click",m)}clearCurrentStep(){this.state.currentStep&&(clearInterval(this.state.currentStep.interval),this.state.currentStep.element.querySelector(".next-step-btn").disabled=!0,this.state.currentStep=null)}showFinalQuestion(){const t=this.elements.chatMessages,e=document.createElement("div");e.className="text-left mb-4";const n=document.createElement("span");n.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]";let s=60,l=document.createElement("div");l.className="text-center text-xs font-bold text-red-600 mt-2",l.innerHTML='Tiempo para responder: <span id="final-question-timer">01:00</span>';function a(){const u=Math.floor(s/60),c=s%60;l.querySelector("#final-question-timer").textContent=`${u.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`}n.innerHTML=`
            <p>¿Pudiste resolver el problema, con los pasos de ayuda?</p>
            <div class="flex gap-4 mt-3">
                <button class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded" onclick="window.chatManager.handleResponse(true)">
                    SI
                </button>
                <button class="bg-orange-400 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded" onclick="window.chatManager.handleResponse(false)">
                    NO
                </button>
                <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded" onclick="window.chatManager.handleResponse('CANCELADO')">
                    Cancelar ticket
                </button>
            </div>
        `,n.appendChild(l),e.appendChild(n),t.appendChild(e),t.scrollTop=t.scrollHeight,a(),this.finalQuestionTimerInterval=setInterval(()=>{s--,a(),s<=0&&(clearInterval(this.finalQuestionTimerInterval),this.state.actualStepTimes||(this.state.actualStepTimes={}),this.state.actualStepTimes.final_wait=60,this.handleResponse("CANCELADO",!0))},1e3),this.finalQuestionTimerActive=!0}async handleResponse(t,e=!1){this.finalQuestionTimerActive&&this.finalQuestionTimerInterval&&(clearInterval(this.finalQuestionTimerInterval),this.finalQuestionTimerActive=!1);const n=this.elements.chatMessages;try{const s=this.state.userModule||window.GLOBAL_CHAT_MODULE,l=this.state.userProblem||window.GLOBAL_CHAT_PROBLEM,a=typeof this.state.selectedMachineIndex=="number"&&!isNaN(this.state.selectedMachineIndex)?this.state.selectedMachineIndex:window.GLOBAL_CHAT_MACHINE_INDEX;if(console.log("Valores antes de enviar:",{modulo:s,problema:l,selectedMachineIndex:a}),!s||!l||a===null||typeof a>"u"){Swal.fire({icon:"error",title:"Error",text:"Por favor, selecciona el módulo, la máquina y describe el problema antes de continuar."});return}let u=0;for(const E in this.state.actualStepTimes)this.state.actualStepTimes.hasOwnProperty(E)&&(u+=this.state.actualStepTimes[E]);const c=this.state.totalEstimatedIATime,d=Math.floor(u/60),f=u%60,p=`${d}:${f.toString().padStart(2,"0")}`;let h;t===!0?h="AUTONOMO":t===!1?h="SIN_ASIGNAR":t==="CANCELADO"&&(h="CANCELADO");let m="",g="";if(this.state.selectedOperario&&this.state.selectedOperario.text){const E=this.state.selectedOperario.text.split(" - ");m=E[0]||"",g=E[1]||""}(!m||!g)&&window.GLOBAL_OPERARIO&&(m=window.GLOBAL_OPERARIO.nombre||"",g=window.GLOBAL_OPERARIO.numero||"");const T={modulo:s,problema:l,descripcion:l,status:h,maquina:J[a],tiempo_estimado_ia:c,tiempo_real_ia:p,Operario:g,NombreOperario:m};console.log("Enviando datos al backend:",T);const _=await(await fetch("/ticketsOT",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify(T)})).json();if(_.success){let E="success",S="",v="";h==="AUTONOMO"?(E="success",S="Excelente trabajo",v="Gracias por haberlo resuelto de forma autónoma."):h==="SIN_ASIGNAR"?(E="success",S="Ticket registrado",v=`La Orden de Trabajo fue creada exitosamente con el folio: ${_.folio}`):h==="CANCELADO"&&(E="warning",S="El ticket fue cancelado",v=e?"Por inactividad se ha cancelado tu ticket":""),await Swal.fire({icon:E,title:S,text:v,confirmButtonText:"OK"}),h==="AUTONOMO"?await this.appendChatMessage("Me alegra 😃 que se haya podido solucionar el problema.<br>Recuerda que estoy para ayudarte 🤖",n):h==="SIN_ASIGNAR"?(await this.appendChatMessage(`<strong>Folio generado:</strong> ${_.folio}`,n),await this.appendChatMessage("Se ha generado tu ticket, en breve te atenderá el mecánico.",n)):h==="CANCELADO"&&await this.appendChatMessage(e?"Por inactividad se ha cancelado tu ticket.<br>Que lastima que hayas cancelado 😥 , recuerda que estoy para ayudarte":"Que lastima que hayas cancelado 😥 , recuerda que estoy para ayudarte",n),setTimeout(()=>this.showFinalResetQuestion(n),1e3)}else throw new Error(_.message||"Error al procesar la solicitud")}catch(s){console.error("Error en handleResponse:",s),Swal.fire({icon:"error",title:"Error",text:"Hubo un error al procesar la solicitud"})}}showFinalResetQuestion(t){const e=document.createElement("div");e.className="text-left mb-4";const n=document.createElement("span");n.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]",n.innerHTML=`
            <p>¿Quieres generar una nueva asistencia?</p>
            <div class="flex gap-4 mt-3">
                <button class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded" onclick="window.chatManager.handleResetResponse(true)">
                    SI
                </button>
                <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded" onclick="window.chatManager.handleResetResponse(false)">
                    NO
                </button>
            </div>
        `,e.appendChild(n),t.appendChild(e),t.scrollTop=t.scrollHeight}handleResetResponse(t){const e=this.elements.chatMessages;e.innerHTML="",this.resetChat(),this.startConversation(e)}resetChat(){this.state.userProblem="",this.state.userModule="",this.state.selectedOperario={},this.state.selectedMachineIndex=null,this.state.nextResponseHandler=null,this.state.totalEstimatedIATime=0,this.state.actualStepTimes={},window.iaChatStep=0,window.GLOBAL_OPERARIO=void 0}escapeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}formatTime(t){const e=Math.floor(t/60),n=t%60;return`${e}:${n.toString().padStart(2,"0")}`}cleanup(){try{this.activeIntervals.forEach(t=>clearInterval(t)),this.activeIntervals=[],Object.keys(this.state).forEach(t=>{typeof this.state[t]!="function"&&(this.state[t]=null)})}catch(t){console.error("Cleanup error:",t)}}}document.addEventListener("DOMContentLoaded",()=>{try{window.chatManager=new al,window.chatManager.init()}catch(o){console.error("Fatal initialization error:",o)}});
