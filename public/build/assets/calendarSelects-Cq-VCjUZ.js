document.addEventListener("DOMContentLoaded",async()=>{var h,w;const o=document.getElementById("calendar-month"),a=document.getElementById("calendar-year"),r=document.getElementById("calendar-day");if(!o||!a||!r)return;let v=[];try{let p=function(e){o.innerHTML="";const t=[...new Set(l.filter(n=>n.year===e).map(n=>n.month))];for(let n=0;n<12;n++)if(t.includes(n)){const m=document.createElement("option");m.value=n,m.textContent=y[n],o.appendChild(m)}},u=function(e,t){r.innerHTML="";const n=document.createElement("option");n.value="",n.textContent="Todos",r.appendChild(n),[...new Set(l.filter(c=>c.year===e&&c.month===t).map(c=>c.day))].sort((c,d)=>c-d).forEach(c=>{const d=document.createElement("option");d.value=c,d.textContent=c,r.appendChild(d)})};var M=p,f=u;v=await(await fetch("/cardsAteOTs")).json();const l=v.map(e=>e.created_at).filter(Boolean).map(e=>{const t=new Date(e);return{year:t.getFullYear(),month:t.getMonth(),day:t.getDate()}}),b=[...new Set(l.map(e=>e.year))].sort((e,t)=>e-t);a.innerHTML="",b.forEach(e=>{const t=document.createElement("option");t.value=e,t.textContent=e,a.appendChild(t)});const y=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],E=new Date;let i=E.getFullYear(),s=E.getMonth();[...a.options].some(e=>Number(e.value)===i)||(i=Number((h=a.options[0])==null?void 0:h.value)),p(i),[...o.options].some(e=>Number(e.value)===s)||(s=Number((w=o.options[0])==null?void 0:w.value)),a.value=i,o.value=s,u(i,s),r.value="",window.dispatchEvent(new Event("calendar:change")),a.addEventListener("change",()=>{var e;p(Number(a.value)),o.value=(e=o.options[0])==null?void 0:e.value,u(Number(a.value),Number(o.value)),r.value="",window.dispatchEvent(new Event("calendar:change"))}),o.addEventListener("change",()=>{u(Number(a.value),Number(o.value)),r.value="",window.dispatchEvent(new Event("calendar:change"))}),r.addEventListener("change",()=>{window.dispatchEvent(new Event("calendar:change"))})}catch{const l=new Date;a.innerHTML=`<option value="${l.getFullYear()}">${l.getFullYear()}</option>`,o.innerHTML=`<option value="${l.getMonth()}">${["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][l.getMonth()]}</option>`,r.innerHTML='<option value="">Todos</option>',window.dispatchEvent(new Event("calendar:change"))}});
