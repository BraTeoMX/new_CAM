document.addEventListener("DOMContentLoaded",async()=>{var b,y;const t=document.getElementById("calendar-month"),a=document.getElementById("calendar-year"),r=document.getElementById("calendar-day");if(!t||!a||!r)return;let h=[];try{let p=function(e){t.innerHTML="";const n=[...new Set(u.filter(o=>o.year===e).map(o=>o.month))];for(let o=0;o<12;o++)if(n.includes(o)){const v=document.createElement("option");v.value=o,v.textContent=M[o],t.appendChild(v)}},m=function(e,n){r.innerHTML="";const o=document.createElement("option");o.value="",o.textContent="Todos",r.appendChild(o),[...new Set(u.filter(l=>l.year===e&&l.month===n).map(l=>l.day))].sort((l,d)=>l-d).forEach(l=>{const d=document.createElement("option");d.value=l,d.textContent=l,r.appendChild(d)})},i=function(){const e={year:Number(a.value),month:Number(t.value),day:r.value?Number(r.value):null};window.dispatchEvent(new CustomEvent("calendar:change",{detail:e}))};var N=p,f=m,L=i;h=await(await fetch("/cardsAteOTs")).json();const u=h.map(e=>e.created_at).filter(Boolean).map(e=>{const n=new Date(e);return{year:n.getFullYear(),month:n.getMonth(),day:n.getDate()}}),w=[...new Set(u.map(e=>e.year))].sort((e,n)=>e-n);a.innerHTML="",w.forEach(e=>{const n=document.createElement("option");n.value=e,n.textContent=e,a.appendChild(n)});const M=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],g=new Date;let c=g.getFullYear(),s=g.getMonth();[...a.options].some(e=>Number(e.value)===c)||(c=Number((b=a.options[0])==null?void 0:b.value)),p(c),[...t.options].some(e=>Number(e.value)===s)||(s=Number((y=t.options[0])==null?void 0:y.value)),a.value=c,t.value=s,m(c,s),r.value="",i(),a.addEventListener("change",()=>{var e;p(Number(a.value)),t.value=(e=t.options[0])==null?void 0:e.value,m(Number(a.value),Number(t.value)),r.value="",i()}),t.addEventListener("change",()=>{m(Number(a.value),Number(t.value)),r.value="",i()}),r.addEventListener("change",()=>{i()})}catch{const u=new Date;a.innerHTML=`<option value="${u.getFullYear()}">${u.getFullYear()}</option>`,t.innerHTML=`<option value="${u.getMonth()}">${["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][u.getMonth()]}</option>`,r.innerHTML='<option value="">Todos</option>',window.dispatchEvent(new Event("calendar:change"))}});
