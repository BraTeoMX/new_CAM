function l(r,a,n){if(typeof Highcharts>"u"){const i=document.getElementById("dashboard-tops");i&&(i.innerHTML=`
                <div class="text-center p-4 rounded-lg bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 border border-red-300 dark:border-red-700 shadow">
                    <span class="font-bold">Error:</span> Highcharts no está cargado.<br>
                    <span class="text-sm">Asegúrate de incluir la librería Highcharts antes de este script.</span>
                </div>
            `);return}const e=document.documentElement.classList.contains("dark"),o=e?"#1e293b":"#fff",t=e?"#f1f5f9":"#1e293b";Highcharts.chart("dashboard-tops",{chart:{type:"gauge",plotBackgroundColor:null,plotBackgroundImage:null,plotBorderWidth:0,plotShadow:!1,height:"80%",backgroundColor:o},title:{text:"Efectividad de Atención",style:{color:t,fontWeight:"bold"}},pane:{startAngle:-90,endAngle:89.9,background:null,center:["50%","75%"],size:"110%"},yAxis:{min:0,max:100,tickPixelInterval:72,tickPosition:"inside",tickColor:o,tickLength:20,tickWidth:2,minorTickInterval:null,labels:{distance:20,style:{fontSize:"14px",color:t}},lineWidth:0,plotBands:[{from:0,to:70,color:"#DF5353",thickness:20,borderRadius:"50%"},{from:70,to:90,color:"#DDDF0D",thickness:20},{from:90,to:100,color:"#55BF3B",thickness:20,borderRadius:"50%"}]},series:[{name:"Efectividad",data:[r],tooltip:{valueSuffix:" %"},dataLabels:{format:"{y} %",borderWidth:0,color:t,style:{fontSize:"16px",color:t}},dial:{radius:"80%",backgroundColor:e?"#64748b":"gray",baseWidth:12,baseLength:"0%",rearLength:"0%"},pivot:{backgroundColor:e?"#64748b":"gray",radius:6}}],credits:{enabled:!1}});const c=document.getElementById("dashboard-tops");let d=document.getElementById("efectividad-info");d||(d=document.createElement("div"),d.id="efectividad-info",d.className="text-center mt-4 text-base font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800 rounded-lg py-2 px-4 shadow border border-gray-200 dark:border-gray-700",c.appendChild(d)),d.innerHTML=`
        <span class="text-gray-600 dark:text-gray-300">Tickets efectivos:</span>
        <b class="text-emerald-600 dark:text-emerald-400">${n}</b>
        <span class="text-gray-400 dark:text-gray-500">/</span>
        <b class="text-blue-600 dark:text-blue-400">${a}</b>
    `}async function s({year:r,month:a,day:n}){const e=new URLSearchParams;r&&e.append("year",r),a!=null&&e.append("month",a),n&&e.append("day",n);const t=await(await fetch(`/dashboard/efectividad?${e.toString()}`)).json();l(t.efectividad,t.total,t.efectivos)}window.addEventListener("calendar:change",r=>{const a=r.detail||{};s(a)});document.addEventListener("DOMContentLoaded",()=>{s({year:new Date().getFullYear(),month:new Date().getMonth(),day:null})});
