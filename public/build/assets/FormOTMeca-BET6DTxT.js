const k="modulepreload",T=function(e){return"/build/"+e},f={},S=function(o,a,t){let l=Promise.resolve();if(a&&a.length>0){let r=function(s){return Promise.all(s.map(p=>Promise.resolve(p).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),i=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));l=r(a.map(s=>{if(s=T(s),s in f)return;f[s]=!0;const p=s.endsWith(".css"),u=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${u}`))return;const c=document.createElement("link");if(c.rel=p?"stylesheet":k,p||(c.as="script"),c.crossOrigin="",c.href=s,i&&c.setAttribute("nonce",i),document.head.appendChild(c),p)return new Promise((E,v)=>{c.addEventListener("load",E),c.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${s}`)))})}))}function d(r){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=r,window.dispatchEvent(n),!n.defaultPrevented)throw r}return l.then(r=>{for(const n of r||[])n.status==="rejected"&&d(n.reason);return o().catch(d)})};let w=[];const g="ordenTrabajoTable",L=e=>{localStorage.setItem("ordenTrabajoData",JSON.stringify(e))},$=()=>{const e=localStorage.getItem("ordenTrabajoData");return e?JSON.parse(e):[]},D=async()=>{try{const e=await fetch("/form-ot-data");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const o=await e.json();return console.log("Datos recibidos del backend:",o),w=o,L(w),w}catch(e){return console.error("Error fetching data:",e),w=$(),w}},B=(e,o)=>{const a=new Date(e),l=new Date(o).getTime()-a.getTime();return Math.round(l/6e4)},I=e=>{if(!e)return null;const o=e.split(":").map(Number);return o.length===2?o[0]*60+o[1]:o.length===1?o[0]:null},M=e=>{const a=document.getElementById(g).querySelector("tbody");a.innerHTML="",e.forEach((t,l)=>{console.log(`Fila ${l}:`,t);const d=document.createElement("tr");d.className="bg-white border-b dark:bg-gray-900 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors";let r="",n="text-purple-700 dark:text-purple-400",i=null;t.follow_atention&&t.follow_atention.created_at&&t.follow_atention.updated_at&&(r=B(t.follow_atention.created_at,t.follow_atention.updated_at),i=I(t.follow_atention.TimeEstimado),i!==null&&r!==""&&(r>i?n="text-red-700 dark:text-red-400 font-bold":n="text-green-700 dark:text-green-400 font-bold")),d.innerHTML=`
            <td class="px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white">${t.follow_atention.Folio??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white">${t.follow_atention.Modulo??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${t.follow_atention.Supervisor??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${t.follow_atention.Operario??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${t.follow_atention.NombreOperario??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${t.follow_atention.Problema??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-blue-700 dark:text-blue-400">${t.follow_atention.created_at?new Date(t.follow_atention.created_at).toLocaleString():""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-green-700 dark:text-green-400">${t.follow_atention.updated_at?new Date(t.follow_atention.updated_at).toLocaleString():""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm ${n}">${r!==""?r+" min":""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${t.follow_atention.NumMach??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${t.follow_atention.Maquina??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${t.follow_atention.Mecanico??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-red-700 dark:text-red-400">${t.follow_atention.Falla??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-yellow-700 dark:text-yellow-400">${t.follow_atention.Causa??""}</td>
            <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-700 dark:text-gray-200">${t.follow_atention.Accion??""}</td>
        `,a.appendChild(d)})},P=()=>{const e=document.getElementById(g);if(!e)return;const o=e.cloneNode(!0);o.querySelectorAll("input").forEach(l=>l.remove());const a=document.createElement("div");a.appendChild(o);const t=document.createRange();t.selectNode(a),window.getSelection().removeAllRanges(),window.getSelection().addRange(t);try{document.execCommand("copy")}catch{navigator.clipboard.writeText(a.innerHTML)}window.getSelection().removeAllRanges(),alert("Tabla copiada al portapapeles")},A=()=>{const e=document.getElementById(g);if(!e)return;const o=e.cloneNode(!0);o.querySelectorAll("input").forEach(t=>t.remove());const a=XLSX.utils.table_to_book(o,{sheet:"OT MecÃ¡nicos"});XLSX.writeFile(a,"OT_Mecanicos.xlsx")},C=()=>{const e=document.getElementById(g);if(!e)return;const o=e.cloneNode(!0);o.querySelectorAll("input").forEach(a=>a.remove()),S(()=>import("https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"),[]).then(()=>{html2canvas(o).then(a=>{const t=a.toDataURL("image/png"),l=new window.jspdf.jsPDF({orientation:"landscape",unit:"pt",format:"a4"}),d=l.internal.pageSize.getWidth();l.internal.pageSize.getHeight();const r=d-40,n=a.height*r/a.width;l.addImage(t,"PNG",20,20,r,n),l.save("OT_Mecanicos.pdf")})})},m=document.getElementById("save-modal"),y=document.getElementById("save-table-btn"),x=document.getElementById("close-modal-btn"),h=document.getElementById("download-excel-btn"),b=document.getElementById("download-pdf-btn");y&&y.addEventListener("click",()=>{m.classList.remove("hidden")});x&&x.addEventListener("click",()=>{m.classList.add("hidden")});h&&h.addEventListener("click",()=>{A(),m.classList.add("hidden")});b&&b.addEventListener("click",()=>{C(),m.classList.add("hidden")});const _=document.getElementById("copy-table-btn");_&&_.addEventListener("click",P);const N=async()=>{let e=await D();M(e)};document.addEventListener("DOMContentLoaded",N);
