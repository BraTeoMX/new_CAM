document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("btn-open-usercreate"),c=document.getElementById("btn-close-usercreate"),d=document.getElementById("btn-cancel-usercreate"),e=document.getElementById("modal-usercreate"),n=document.getElementById("form-usercreate"),o=document.getElementById("usercreate-puesto"),u=()=>{const t=document.querySelector('meta[name="csrf-token"]');return t?t.getAttribute("content"):""};!a||!c||!d||!e||!n||!o||(a.addEventListener("click",()=>{o.innerHTML='<option value="">Cargando...</option>',fetch("/admin-control/puestos",{headers:{"X-CSRF-TOKEN":u(),"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"}).then(t=>t.json()).then(t=>{o.innerHTML='<option value="">Seleccione un puesto</option>'+t.map(r=>`<option value="${r}">${r}</option>`).join("")}).catch(()=>{o.innerHTML='<option value="">Error al cargar puestos</option>'}),e.classList.remove("hidden"),e.classList.add("flex")}),c.addEventListener("click",()=>{e.classList.add("hidden"),e.classList.remove("flex"),n.reset()}),d.addEventListener("click",()=>{e.classList.add("hidden"),e.classList.remove("flex"),n.reset()}),n.addEventListener("submit",t=>{t.preventDefault();const r={name:document.getElementById("usercreate-name").value,email:document.getElementById("usercreate-email").value,num_empleado:document.getElementById("usercreate-num_empleado").value,password:document.getElementById("usercreate-password").value,puesto:document.getElementById("usercreate-puesto").value};fetch("/admin-control/users",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":u(),"X-Requested-With":"XMLHttpRequest"},credentials:"same-origin",body:JSON.stringify(r)}).then(s=>{if(!s.ok)throw new Error("Error al crear usuario");return s.json()}).then(()=>{Swal.fire("Agregado","Usuario creado correctamente","success"),e.classList.add("hidden"),e.classList.remove("flex"),n.reset(),typeof fetchUsers=="function"&&fetchUsers()}).catch(s=>{console.error("Error creando usuario:",s),Swal.fire("Error","No se pudo crear el usuario.","error")})}))});
