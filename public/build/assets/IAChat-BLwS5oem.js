/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Vt,Ut;function kt(){return{geminiUrl:Vt,vertexUrl:Ut}}function Ft(o,t,e){var n,i,l;if(!(!((n=o.httpOptions)===null||n===void 0)&&n.baseUrl)){const a=kt();return o.vertexai?(i=a.vertexUrl)!==null&&i!==void 0?i:t:(l=a.geminiUrl)!==null&&l!==void 0?l:e}return o.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class b{}function y(o,t){const e=/\{([^}]+)\}/g;return o.replace(e,(n,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const l=t[i];return l!=null?String(l):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function r(o,t,e){for(let l=0;l<t.length-1;l++){const a=t[l];if(a.endsWith("[]")){const u=a.slice(0,-2);if(!(u in o))if(Array.isArray(e))o[u]=Array.from({length:e.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(o[u])){const c=o[u];if(Array.isArray(e))for(let d=0;d<c.length;d++){const f=c[d];r(f,t.slice(l+1),e[d])}else for(const d of c)r(d,t.slice(l+1),e)}return}else if(a.endsWith("[0]")){const u=a.slice(0,-3);u in o||(o[u]=[{}]);const c=o[u];r(c[0],t.slice(l+1),e);return}(!o[a]||typeof o[a]!="object")&&(o[a]={}),o=o[a]}const n=t[t.length-1],i=o[n];if(i!==void 0){if(!e||typeof e=="object"&&Object.keys(e).length===0||e===i)return;if(typeof i=="object"&&typeof e=="object"&&i!==null&&e!==null)Object.assign(i,e);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else o[n]=e}function s(o,t){try{if(t.length===1&&t[0]==="_self")return o;for(let e=0;e<t.length;e++){if(typeof o!="object"||o===null)return;const n=t[e];if(n.endsWith("[]")){const i=n.slice(0,-2);if(i in o){const l=o[i];return Array.isArray(l)?l.map(a=>s(a,t.slice(e+1))):void 0}else return}else o=o[n]}return o}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function I(o,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(o.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function Tt(o,t){const e=I(o,t);return e?e.startsWith("publishers/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}`:e.startsWith("models/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/publishers/google/${e}`:e:""}function yt(o,t){return Array.isArray(t)?t.map(e=>W(o,e)):[W(o,t)]}function W(o,t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Gt(o,t){const e=W(o,t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function qt(o,t){const e=W(o,t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function he(o,t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function vt(o,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>he(o,e)):[he(o,t)]}function ie(o){return o!=null&&typeof o=="object"&&"parts"in o&&Array.isArray(o.parts)}function ge(o){return o!=null&&typeof o=="object"&&"functionCall"in o}function Ce(o){return o!=null&&typeof o=="object"&&"functionResponse"in o}function w(o,t){if(t==null)throw new Error("ContentUnion is required");return ie(t)?t:{role:"user",parts:vt(o,t)}}function Et(o,t){if(!t)return[];if(o.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const n=w(o,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(o.isVertexAI()){const e=w(o,t);return e.parts&&e.parts.length>0&&e.parts[0].text!==void 0?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>w(o,e)):[w(o,t)]}function R(o,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(ge(t)||Ce(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[w(o,t)]}const e=[],n=[],i=ie(t[0]);for(const l of t){const a=ie(l);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(l);else{if(ge(l)||Ce(l))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(l)}}return i||e.push({role:"user",parts:vt(o,n)}),e}function _t(o,t){return t}function St(o,t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Q(o,t){return t}function Z(o,t){if(!Array.isArray(t))throw new Error("tool is required and must be an array of Tools");return t}function bt(o,t,e,n=1){const i=!t.startsWith(`${e}/`)&&t.split("/").length===n;return o.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${o.getProject()}/${t}`:t.startsWith(`${e}/`)?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}`:i?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}/${t}`:t:i?`${e}/${t}`:t}function N(o,t){if(typeof t!="string")throw new Error("name must be a string");return bt(o,t,"cachedContents")}function At(o,t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function D(o,t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function Ht(o){return o!=null&&typeof o=="object"&&"name"in o}function Bt(o){return o!=null&&typeof o=="object"&&"video"in o}function $t(o){return o!=null&&typeof o=="object"&&"uri"in o}function It(o,t){var e;let n;if(Ht(t)&&(n=t.name),!($t(t)&&(n=t.uri,n===void 0))&&!(Bt(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const l=n.split("files/")[1].match(/[a-z0-9]+/);if(l===null)throw new Error(`Could not extract file name from URI ${n}`);n=l[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Mt(o,t){let e;return o.isVertexAI()?e=t?"publishers/google/models":"models":e=t?"models":"tunedModels",e}function wt(o,t){for(const e of["models","tunedModels","publisherModels"])if(Ot(t,e))return t[e];return[]}function Ot(o,t){return o!==null&&typeof o=="object"&&t in o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jt(o,t){const e={};if(s(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=s(t,["thought"]);n!=null&&r(e,["thought"],n);const i=s(t,["codeExecutionResult"]);i!=null&&r(e,["codeExecutionResult"],i);const l=s(t,["executableCode"]);l!=null&&r(e,["executableCode"],l);const a=s(t,["fileData"]);a!=null&&r(e,["fileData"],a);const u=s(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=s(t,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const d=s(t,["inlineData"]);d!=null&&r(e,["inlineData"],d);const f=s(t,["text"]);return f!=null&&r(e,["text"],f),e}function Te(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Jt(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function Yt(){return{}}function Kt(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function Wt(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Kt(o,n)),e}function zt(o,t){const e={};if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(t,["googleSearch"])!=null&&r(e,["googleSearch"],Yt());const i=s(t,["googleSearchRetrieval"]);if(i!=null&&r(e,["googleSearchRetrieval"],Wt(o,i)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=s(t,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=s(t,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function Xt(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function Qt(o,t){const e={},n=s(t,["functionCallingConfig"]);if(n!=null&&r(e,["functionCallingConfig"],Xt(o,n)),s(t,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return e}function Zt(o,t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(t,["expireTime"]);e!==void 0&&l!=null&&r(e,["expireTime"],l);const a=s(t,["displayName"]);e!==void 0&&a!=null&&r(e,["displayName"],a);const u=s(t,["contents"]);if(e!==void 0&&u!=null){let p=R(o,u);Array.isArray(p)&&(p=p.map(m=>Te(o,m))),r(e,["contents"],p)}const c=s(t,["systemInstruction"]);e!==void 0&&c!=null&&r(e,["systemInstruction"],Te(o,w(o,c)));const d=s(t,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>zt(o,m))),r(e,["tools"],p)}const f=s(t,["toolConfig"]);return e!==void 0&&f!=null&&r(e,["toolConfig"],Qt(o,f)),n}function jt(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["model"],Tt(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],Zt(o,i,e)),e}function en(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function tn(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function nn(o,t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(t,["expireTime"]);return e!==void 0&&l!=null&&r(e,["expireTime"],l),n}function on(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],nn(o,i,e)),e}function sn(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),n}function rn(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],sn(o,n,e)),e}function ln(o,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const i=s(t,["thought"]);i!=null&&r(e,["thought"],i);const l=s(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=s(t,["fileData"]);u!=null&&r(e,["fileData"],u);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=s(t,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=s(t,["inlineData"]);f!=null&&r(e,["inlineData"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function ye(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>ln(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function an(){return{}}function un(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function dn(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],un(o,n)),e}function cn(){return{}}function fn(o,t){const e={},n=s(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function pn(o,t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],fn(o,n));const i=s(t,["authType"]);i!=null&&r(e,["authType"],i);const l=s(t,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=s(t,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const u=s(t,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const c=s(t,["oidcConfig"]);return c!=null&&r(e,["oidcConfig"],c),e}function mn(o,t){const e={},n=s(t,["authConfig"]);return n!=null&&r(e,["authConfig"],pn(o,n)),e}function hn(o,t){const e={},n=s(t,["retrieval"]);n!=null&&r(e,["retrieval"],n),s(t,["googleSearch"])!=null&&r(e,["googleSearch"],an());const l=s(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],dn(o,l)),s(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],cn());const u=s(t,["googleMaps"]);u!=null&&r(e,["googleMaps"],mn(o,u));const c=s(t,["codeExecution"]);c!=null&&r(e,["codeExecution"],c);const d=s(t,["functionDeclarations"]);return d!=null&&r(e,["functionDeclarations"],d),e}function gn(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function Cn(o,t){const e={},n=s(t,["latitude"]);n!=null&&r(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&r(e,["longitude"],i),e}function Tn(o,t){const e={},n=s(t,["latLng"]);return n!=null&&r(e,["latLng"],Cn(o,n)),e}function yn(o,t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&r(e,["functionCallingConfig"],gn(o,n));const i=s(t,["retrievalConfig"]);return i!=null&&r(e,["retrievalConfig"],Tn(o,i)),e}function vn(o,t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(t,["expireTime"]);e!==void 0&&l!=null&&r(e,["expireTime"],l);const a=s(t,["displayName"]);e!==void 0&&a!=null&&r(e,["displayName"],a);const u=s(t,["contents"]);if(e!==void 0&&u!=null){let p=R(o,u);Array.isArray(p)&&(p=p.map(m=>ye(o,m))),r(e,["contents"],p)}const c=s(t,["systemInstruction"]);e!==void 0&&c!=null&&r(e,["systemInstruction"],ye(o,w(o,c)));const d=s(t,["tools"]);if(e!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>hn(o,m))),r(e,["tools"],p)}const f=s(t,["toolConfig"]);return e!==void 0&&f!=null&&r(e,["toolConfig"],yn(o,f)),n}function En(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["model"],Tt(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],vn(o,i,e)),e}function _n(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Sn(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function An(o,t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(t,["expireTime"]);return e!==void 0&&l!=null&&r(e,["expireTime"],l),n}function In(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],N(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],An(o,i,e)),e}function Mn(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),n}function wn(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],Mn(o,n,e)),e}function Y(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["model"]);l!=null&&r(e,["model"],l);const a=s(t,["createTime"]);a!=null&&r(e,["createTime"],a);const u=s(t,["updateTime"]);u!=null&&r(e,["updateTime"],u);const c=s(t,["expireTime"]);c!=null&&r(e,["expireTime"],c);const d=s(t,["usageMetadata"]);return d!=null&&r(e,["usageMetadata"],d),e}function xn(){return{}}function Pn(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["cachedContents"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(a=>Y(o,a))),r(e,["cachedContents"],l)}return e}function K(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["model"]);l!=null&&r(e,["model"],l);const a=s(t,["createTime"]);a!=null&&r(e,["createTime"],a);const u=s(t,["updateTime"]);u!=null&&r(e,["updateTime"],u);const c=s(t,["expireTime"]);c!=null&&r(e,["expireTime"],c);const d=s(t,["usageMetadata"]);return d!=null&&r(e,["usageMetadata"],d),e}function Rn(){return{}}function Nn(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["cachedContents"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(a=>K(o,a))),r(e,["cachedContents"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var V;(function(o){o.PAGED_ITEM_BATCH_JOBS="batchJobs",o.PAGED_ITEM_MODELS="models",o.PAGED_ITEM_TUNING_JOBS="tuningJobs",o.PAGED_ITEM_FILES="files",o.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(V||(V={}));class j{constructor(t,e,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=e,this.init(t,n,i)}init(t,e,n){var i,l;this.nameInternal=t,this.pageInternal=e[this.nameInternal]||[],this.idxInternal=0;let a={config:{}};n?typeof n=="object"?a=Object.assign({},n):a=n:a={config:{}},a.config&&(a.config.pageToken=e.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(l=(i=a.config)===null||i===void 0?void 0:i.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ve;(function(o){o.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ve||(ve={}));var Ee;(function(o){o.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON"})(Ee||(Ee={}));var _e;(function(o){o.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(_e||(_e={}));var Se;(function(o){o.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",o.SEVERITY="SEVERITY",o.PROBABILITY="PROBABILITY"})(Se||(Se={}));var Ae;(function(o){o.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE",o.OFF="OFF"})(Ae||(Ae={}));var Ie;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Ie||(Ie={}));var Me;(function(o){o.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",o.NO_AUTH="NO_AUTH",o.API_KEY_AUTH="API_KEY_AUTH",o.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",o.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",o.OAUTH="OAUTH",o.OIDC_AUTH="OIDC_AUTH"})(Me||(Me={}));var we;(function(o){o.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT"})(we||(we={}));var xe;(function(o){o.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",o.STOP="STOP",o.MAX_TOKENS="MAX_TOKENS",o.SAFETY="SAFETY",o.RECITATION="RECITATION",o.LANGUAGE="LANGUAGE",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.SPII="SPII",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.IMAGE_SAFETY="IMAGE_SAFETY"})(xe||(xe={}));var Pe;(function(o){o.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",o.NEGLIGIBLE="NEGLIGIBLE",o.LOW="LOW",o.MEDIUM="MEDIUM",o.HIGH="HIGH"})(Pe||(Pe={}));var Re;(function(o){o.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",o.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",o.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",o.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",o.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Re||(Re={}));var Ne;(function(o){o.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(Ne||(Ne={}));var De;(function(o){o.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",o.ON_DEMAND="ON_DEMAND",o.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(De||(De={}));var z;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.AUDIO="AUDIO"})(z||(z={}));var Le;(function(o){o.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",o.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",o.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",o.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Le||(Le={}));var se;(function(o){o.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",o.JOB_STATE_QUEUED="JOB_STATE_QUEUED",o.JOB_STATE_PENDING="JOB_STATE_PENDING",o.JOB_STATE_RUNNING="JOB_STATE_RUNNING",o.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",o.JOB_STATE_FAILED="JOB_STATE_FAILED",o.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",o.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",o.JOB_STATE_PAUSED="JOB_STATE_PAUSED",o.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",o.JOB_STATE_UPDATING="JOB_STATE_UPDATING",o.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(se||(se={}));var Ve;(function(o){o.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",o.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",o.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",o.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",o.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",o.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",o.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Ve||(Ve={}));var Ue;(function(o){o.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",o.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",o.BALANCED="BALANCED",o.PRIORITIZE_COST="PRIORITIZE_COST"})(Ue||(Ue={}));var ke;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(ke||(ke={}));var Fe;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE"})(Fe||(Fe={}));var Ge;(function(o){o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE"})(Ge||(Ge={}));var qe;(function(o){o.DONT_ALLOW="DONT_ALLOW",o.ALLOW_ADULT="ALLOW_ADULT",o.ALLOW_ALL="ALLOW_ALL"})(qe||(qe={}));var be;(function(o){o.auto="auto",o.en="en",o.ja="ja",o.ko="ko",o.hi="hi"})(be||(be={}));var He;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.PROCESSING="PROCESSING",o.ACTIVE="ACTIVE",o.FAILED="FAILED"})(He||(He={}));var Be;(function(o){o.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",o.UPLOADED="UPLOADED",o.GENERATED="GENERATED"})(Be||(Be={}));var $e;(function(o){o.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",o.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",o.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",o.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",o.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})($e||($e={}));var Oe;(function(o){o.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",o.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",o.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",o.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Oe||(Oe={}));var Je;(function(o){o.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",o.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",o.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",o.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Je||(Je={}));var Ye;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.VIDEO="VIDEO",o.AUDIO="AUDIO",o.DOCUMENT="DOCUMENT"})(Ye||(Ye={}));var Ke;(function(o){o.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",o.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",o.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ke||(Ke={}));var We;(function(o){o.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",o.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",o.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(We||(We={}));var ze;(function(o){o.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",o.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",o.NO_INTERRUPTION="NO_INTERRUPTION"})(ze||(ze={}));var Xe;(function(o){o.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",o.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",o.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Xe||(Xe={}));class H{get text(){var t,e,n,i,l,a,u,c;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",f=!1;const p=[];for(const m of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[h,g]of Object.entries(m))h!=="text"&&h!=="thought"&&(g!==null||g!==void 0)&&p.push(h);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;f=!0,d+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?d:void 0}get data(){var t,e,n,i,l,a,u,c;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const f=[];for(const p of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[m,h]of Object.entries(p))m!=="inlineData"&&(h!==null||h!==void 0)&&f.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var t,e,n,i,l,a,u,c;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var t,e,n,i,l,a,u,c,d;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var t,e,n,i,l,a,u,c,d;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.output}}class Qe{}class Ze{}class je{}class et{}class tt{}class Dn{}class nt{}class ot{}class it{}class Ln{}class re{constructor(t){const e={};for(const n of t.headers.entries())e[n[0]]=n[1];this.headers=e,this.responseInternal=t}json(){return this.responseInternal.json()}}class Vn{}class Un{}class kn{get text(){var t,e,n;let i="",l=!1;const a=[];for(const u of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[c,d]of Object.entries(u))c!=="text"&&c!=="thought"&&d!==null&&a.push(c);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;l=!0,i+=u.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?i:void 0}get data(){var t,e,n;let i="";const l=[];for(const a of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[u,c]of Object.entries(a))u!=="inlineData"&&c!==null&&l.push(u);a.inlineData&&typeof a.inlineData.data=="string"&&(i+=atob(a.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fn extends b{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new j(V.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(e),e)}async create(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=En(this.apiClient,t);return u=y("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>K(this.apiClient,f))}else{const d=jt(this.apiClient,t);return u=y("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Y(this.apiClient,f))}}async get(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=_n(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>K(this.apiClient,f))}else{const d=en(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Y(this.apiClient,f))}}async delete(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Sn(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(()=>{const f=Rn(),p=new ot;return Object.assign(p,f),p})}else{const d=tn(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(()=>{const f=xn(),p=new ot;return Object.assign(p,f),p})}}async update(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=In(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>K(this.apiClient,f))}else{const d=on(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Y(this.apiClient,f))}}async listInternal(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=wn(this.apiClient,t);return u=y("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Nn(this.apiClient,f),m=new it;return Object.assign(m,p),m})}else{const d=rn(this.apiClient,t);return u=y("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Pn(this.apiClient,f),m=new it;return Object.assign(m,p),m})}}}function st(o){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&o[t],n=0;if(e)return e.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(o){return this instanceof M?(this.v=o,this):new M(o)}function X(o,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(o,t||[]),i,l=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(h){return function(g){return Promise.resolve(g).then(h,p)}}function u(h,g){n[h]&&(i[h]=function(C){return new Promise(function(T,S){l.push([h,C,T,S])>1||c(h,C)})},g&&(i[h]=g(i[h])))}function c(h,g){try{d(n[h](g))}catch(C){m(l[0][3],C)}}function d(h){h.value instanceof M?Promise.resolve(h.value.v).then(f,p):m(l[0][2],h)}function f(h){c("next",h)}function p(h){c("throw",h)}function m(h,g){h(g),l.shift(),l.length&&c(l[0][0],l[0][1])}}function le(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],e;return t?t.call(o):(o=typeof st=="function"?st(o):o[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(l){e[l]=o[l]&&function(a){return new Promise(function(u,c){a=o[l](a),i(u,c,a.done,a.value)})}}function i(l,a,u,c){Promise.resolve(c).then(function(d){l({value:d,done:u})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Gn(o){var t;if(o.candidates==null||o.candidates.length===0)return!1;const e=(t=o.candidates[0])===null||t===void 0?void 0:t.content;return e===void 0?!1:xt(e)}function xt(o){if(o.parts===void 0||o.parts.length===0)return!1;for(const t of o.parts)if(t===void 0||Object.keys(t).length===0||t.text!==void 0&&t.text==="")return!1;return!0}function qn(o){if(o.length!==0){if(o[0].role!=="user")throw new Error("History must start with a user turn.");for(const t of o)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function bn(o){if(o===void 0||o.length===0)return[];const t=[],e=o.length;let n=0,i=o[0];for(;n<e;)if(o[n].role==="user")i=o[n],n++;else{const l=[];let a=!0;for(;n<e&&o[n].role==="model";)l.push(o[n]),a&&!xt(o[n])&&(a=!1),n++;a&&(t.push(i),t.push(...l))}return t}class Hn{constructor(t,e){this.modelsModule=t,this.apiClient=e}create(t){return new Bn(this.apiClient,this.modelsModule,t.model,t.config,t.history)}}class Bn{constructor(t,e,n,i={},l=[]){this.apiClient=t,this.modelsModule=e,this.model=n,this.config=i,this.history=l,this.sendPromise=Promise.resolve(),qn(l)}async sendMessage(t){var e;await this.sendPromise;const n=w(this.apiClient,t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});return this.sendPromise=(async()=>{var l,a;const c=(a=(l=(await i).candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content,d=c?[c]:[];this.recordHistory(n,d)})(),await this.sendPromise,i}async sendMessageStream(t){var e;await this.sendPromise;const n=w(this.apiClient,t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const l=await i;return this.processStreamResponse(l,n)}getHistory(t=!1){return t?bn(this.history):this.history}processStreamResponse(t,e){var n,i;return X(this,arguments,function*(){var a,u,c,d;const f=[];try{for(var p=!0,m=le(t),h;h=yield M(m.next()),a=h.done,!a;p=!0){d=h.value,p=!1;const g=d;if(Gn(g)){const C=(i=(n=g.candidates)===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.content;C!==void 0&&f.push(C)}yield yield M(g)}}catch(g){u={error:g}}finally{try{!p&&!a&&(c=m.return)&&(yield M(c.call(m)))}finally{if(u)throw u.error}}this.recordHistory(e,f)})}recordHistory(t,e){let n=[];e.length>0&&e.every(i=>i.role==="model")?n=e:n.push({role:"model",parts:[]}),this.history.push(t),this.history.push(...n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $n(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),n}function On(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],$n(o,n,e)),e}function Jn(o,t){const e={},n=s(t,["details"]);n!=null&&r(e,["details"],n);const i=s(t,["message"]);i!=null&&r(e,["message"],i);const l=s(t,["code"]);return l!=null&&r(e,["code"],l),e}function Yn(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["mimeType"]);l!=null&&r(e,["mimeType"],l);const a=s(t,["sizeBytes"]);a!=null&&r(e,["sizeBytes"],a);const u=s(t,["createTime"]);u!=null&&r(e,["createTime"],u);const c=s(t,["expirationTime"]);c!=null&&r(e,["expirationTime"],c);const d=s(t,["updateTime"]);d!=null&&r(e,["updateTime"],d);const f=s(t,["sha256Hash"]);f!=null&&r(e,["sha256Hash"],f);const p=s(t,["uri"]);p!=null&&r(e,["uri"],p);const m=s(t,["downloadUri"]);m!=null&&r(e,["downloadUri"],m);const h=s(t,["state"]);h!=null&&r(e,["state"],h);const g=s(t,["source"]);g!=null&&r(e,["source"],g);const C=s(t,["videoMetadata"]);C!=null&&r(e,["videoMetadata"],C);const T=s(t,["error"]);return T!=null&&r(e,["error"],Jn(o,T)),e}function Kn(o,t){const e={},n=s(t,["file"]);n!=null&&r(e,["file"],Yn(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Wn(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","file"],It(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function zn(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","file"],It(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Xn(o,t){const e={},n=s(t,["details"]);n!=null&&r(e,["details"],n);const i=s(t,["message"]);i!=null&&r(e,["message"],i);const l=s(t,["code"]);return l!=null&&r(e,["code"],l),e}function ae(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["mimeType"]);l!=null&&r(e,["mimeType"],l);const a=s(t,["sizeBytes"]);a!=null&&r(e,["sizeBytes"],a);const u=s(t,["createTime"]);u!=null&&r(e,["createTime"],u);const c=s(t,["expirationTime"]);c!=null&&r(e,["expirationTime"],c);const d=s(t,["updateTime"]);d!=null&&r(e,["updateTime"],d);const f=s(t,["sha256Hash"]);f!=null&&r(e,["sha256Hash"],f);const p=s(t,["uri"]);p!=null&&r(e,["uri"],p);const m=s(t,["downloadUri"]);m!=null&&r(e,["downloadUri"],m);const h=s(t,["state"]);h!=null&&r(e,["state"],h);const g=s(t,["source"]);g!=null&&r(e,["source"],g);const C=s(t,["videoMetadata"]);C!=null&&r(e,["videoMetadata"],C);const T=s(t,["error"]);return T!=null&&r(e,["error"],Xn(o,T)),e}function Qn(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["files"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(a=>ae(o,a))),r(e,["files"],l)}return e}function Zn(){return{}}function jn(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eo extends b{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new j(V.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(e),e)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(e=>ae(this.apiClient,e))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=On(this.apiClient,t);return l=y("files",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>{const d=Qn(this.apiClient,c),f=new Ln;return Object.assign(f,d),f})}}async createInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Kn(this.apiClient,t);return l=y("upload/v1beta/files",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(()=>{const c=Zn(),d=new Vn;return Object.assign(d,c),d})}}async get(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Wn(this.apiClient,t);return l=y("files/{file}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>ae(this.apiClient,c))}}async delete(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=zn(this.apiClient,t);return l=y("files/{file}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(()=>{const c=jn(),d=new Un;return Object.assign(d,c),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function to(o,t){const e={};if(s(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=s(t,["thought"]);n!=null&&r(e,["thought"],n);const i=s(t,["codeExecutionResult"]);i!=null&&r(e,["codeExecutionResult"],i);const l=s(t,["executableCode"]);l!=null&&r(e,["executableCode"],l);const a=s(t,["fileData"]);a!=null&&r(e,["fileData"],a);const u=s(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=s(t,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const d=s(t,["inlineData"]);d!=null&&r(e,["inlineData"],d);const f=s(t,["text"]);return f!=null&&r(e,["text"],f),e}function no(o,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const i=s(t,["thought"]);i!=null&&r(e,["thought"],i);const l=s(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=s(t,["fileData"]);u!=null&&r(e,["fileData"],u);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=s(t,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=s(t,["inlineData"]);f!=null&&r(e,["inlineData"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function oo(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>to(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function io(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>no(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function so(){return{}}function ro(){return{}}function lo(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function ao(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function uo(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],lo(o,n)),e}function co(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],ao(o,n)),e}function fo(){return{}}function po(o,t){const e={},n=s(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function mo(o,t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],po(o,n));const i=s(t,["authType"]);i!=null&&r(e,["authType"],i);const l=s(t,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=s(t,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const u=s(t,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const c=s(t,["oidcConfig"]);return c!=null&&r(e,["oidcConfig"],c),e}function ho(o,t){const e={},n=s(t,["authConfig"]);return n!=null&&r(e,["authConfig"],mo(o,n)),e}function go(o,t){const e={};if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(t,["googleSearch"])!=null&&r(e,["googleSearch"],so());const i=s(t,["googleSearchRetrieval"]);if(i!=null&&r(e,["googleSearchRetrieval"],uo(o,i)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=s(t,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=s(t,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function Co(o,t){const e={},n=s(t,["retrieval"]);n!=null&&r(e,["retrieval"],n),s(t,["googleSearch"])!=null&&r(e,["googleSearch"],ro());const l=s(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],co(o,l)),s(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],fo());const u=s(t,["googleMaps"]);u!=null&&r(e,["googleMaps"],ho(o,u));const c=s(t,["codeExecution"]);c!=null&&r(e,["codeExecution"],c);const d=s(t,["functionDeclarations"]);return d!=null&&r(e,["functionDeclarations"],d),e}function To(o,t){const e={},n=s(t,["handle"]);if(n!=null&&r(e,["handle"],n),s(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function yo(o,t){const e={},n=s(t,["handle"]);n!=null&&r(e,["handle"],n);const i=s(t,["transparent"]);return i!=null&&r(e,["transparent"],i),e}function rt(){return{}}function lt(){return{}}function vo(o,t){const e={},n=s(t,["disabled"]);n!=null&&r(e,["disabled"],n);const i=s(t,["startOfSpeechSensitivity"]);i!=null&&r(e,["startOfSpeechSensitivity"],i);const l=s(t,["endOfSpeechSensitivity"]);l!=null&&r(e,["endOfSpeechSensitivity"],l);const a=s(t,["prefixPaddingMs"]);a!=null&&r(e,["prefixPaddingMs"],a);const u=s(t,["silenceDurationMs"]);return u!=null&&r(e,["silenceDurationMs"],u),e}function Eo(o,t){const e={},n=s(t,["disabled"]);n!=null&&r(e,["disabled"],n);const i=s(t,["startOfSpeechSensitivity"]);i!=null&&r(e,["startOfSpeechSensitivity"],i);const l=s(t,["endOfSpeechSensitivity"]);l!=null&&r(e,["endOfSpeechSensitivity"],l);const a=s(t,["prefixPaddingMs"]);a!=null&&r(e,["prefixPaddingMs"],a);const u=s(t,["silenceDurationMs"]);return u!=null&&r(e,["silenceDurationMs"],u),e}function _o(o,t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&r(e,["automaticActivityDetection"],vo(o,n));const i=s(t,["activityHandling"]);i!=null&&r(e,["activityHandling"],i);const l=s(t,["turnCoverage"]);return l!=null&&r(e,["turnCoverage"],l),e}function So(o,t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&r(e,["automaticActivityDetection"],Eo(o,n));const i=s(t,["activityHandling"]);i!=null&&r(e,["activityHandling"],i);const l=s(t,["turnCoverage"]);return l!=null&&r(e,["turnCoverage"],l),e}function Ao(o,t){const e={},n=s(t,["targetTokens"]);return n!=null&&r(e,["targetTokens"],n),e}function Io(o,t){const e={},n=s(t,["targetTokens"]);return n!=null&&r(e,["targetTokens"],n),e}function Mo(o,t){const e={},n=s(t,["triggerTokens"]);n!=null&&r(e,["triggerTokens"],n);const i=s(t,["slidingWindow"]);return i!=null&&r(e,["slidingWindow"],Ao(o,i)),e}function wo(o,t){const e={},n=s(t,["triggerTokens"]);n!=null&&r(e,["triggerTokens"],n);const i=s(t,["slidingWindow"]);return i!=null&&r(e,["slidingWindow"],Io(o,i)),e}function xo(o,t,e){const n={},i=s(t,["generationConfig"]);e!==void 0&&i!=null&&r(e,["setup","generationConfig"],i);const l=s(t,["responseModalities"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","responseModalities"],l);const a=s(t,["temperature"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","temperature"],a);const u=s(t,["topP"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topP"],u);const c=s(t,["topK"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","topK"],c);const d=s(t,["maxOutputTokens"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","maxOutputTokens"],d);const f=s(t,["mediaResolution"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","mediaResolution"],f);const p=s(t,["seed"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","seed"],p);const m=s(t,["speechConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","speechConfig"],m);const h=s(t,["systemInstruction"]);e!==void 0&&h!=null&&r(e,["setup","systemInstruction"],oo(o,w(o,h)));const g=s(t,["tools"]);if(e!==void 0&&g!=null){let v=Z(o,g);Array.isArray(v)&&(v=v.map(A=>go(o,Q(o,A)))),r(e,["setup","tools"],v)}const C=s(t,["sessionResumption"]);e!==void 0&&C!=null&&r(e,["setup","sessionResumption"],To(o,C));const T=s(t,["inputAudioTranscription"]);e!==void 0&&T!=null&&r(e,["setup","inputAudioTranscription"],rt());const S=s(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&r(e,["setup","outputAudioTranscription"],rt());const E=s(t,["realtimeInputConfig"]);e!==void 0&&E!=null&&r(e,["setup","realtimeInputConfig"],_o(o,E));const _=s(t,["contextWindowCompression"]);return e!==void 0&&_!=null&&r(e,["setup","contextWindowCompression"],Mo(o,_)),n}function Po(o,t,e){const n={},i=s(t,["generationConfig"]);e!==void 0&&i!=null&&r(e,["setup","generationConfig"],i);const l=s(t,["responseModalities"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","responseModalities"],l);const a=s(t,["temperature"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","temperature"],a);const u=s(t,["topP"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","topP"],u);const c=s(t,["topK"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","topK"],c);const d=s(t,["maxOutputTokens"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","maxOutputTokens"],d);const f=s(t,["mediaResolution"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","mediaResolution"],f);const p=s(t,["seed"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","seed"],p);const m=s(t,["speechConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","speechConfig"],m);const h=s(t,["systemInstruction"]);e!==void 0&&h!=null&&r(e,["setup","systemInstruction"],io(o,w(o,h)));const g=s(t,["tools"]);if(e!==void 0&&g!=null){let v=Z(o,g);Array.isArray(v)&&(v=v.map(A=>Co(o,Q(o,A)))),r(e,["setup","tools"],v)}const C=s(t,["sessionResumption"]);e!==void 0&&C!=null&&r(e,["setup","sessionResumption"],yo(o,C));const T=s(t,["inputAudioTranscription"]);e!==void 0&&T!=null&&r(e,["setup","inputAudioTranscription"],lt());const S=s(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&r(e,["setup","outputAudioTranscription"],lt());const E=s(t,["realtimeInputConfig"]);e!==void 0&&E!=null&&r(e,["setup","realtimeInputConfig"],So(o,E));const _=s(t,["contextWindowCompression"]);return e!==void 0&&_!=null&&r(e,["setup","contextWindowCompression"],wo(o,_)),n}function Ro(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["setup","model"],I(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],xo(o,i,e)),e}function No(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["setup","model"],I(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],Po(o,i,e)),e}function Do(){return{}}function Lo(){return{}}function Vo(){return{}}function Uo(){return{}}function ko(o,t){const e={},n=s(t,["media"]);n!=null&&r(e,["mediaChunks"],yt(o,n));const i=s(t,["audio"]);i!=null&&r(e,["audio"],qt(o,i));const l=s(t,["audioStreamEnd"]);l!=null&&r(e,["audioStreamEnd"],l);const a=s(t,["video"]);a!=null&&r(e,["video"],Gt(o,a));const u=s(t,["text"]);return u!=null&&r(e,["text"],u),s(t,["activityStart"])!=null&&r(e,["activityStart"],Do()),s(t,["activityEnd"])!=null&&r(e,["activityEnd"],Vo()),e}function Fo(o,t){const e={},n=s(t,["media"]);if(n!=null&&r(e,["mediaChunks"],yt(o,n)),s(t,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const i=s(t,["audioStreamEnd"]);if(i!=null&&r(e,["audioStreamEnd"],i),s(t,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(s(t,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return s(t,["activityStart"])!=null&&r(e,["activityStart"],Lo()),s(t,["activityEnd"])!=null&&r(e,["activityEnd"],Uo()),e}function Go(){return{}}function qo(){return{}}function bo(o,t){const e={},n=s(t,["thought"]);n!=null&&r(e,["thought"],n);const i=s(t,["codeExecutionResult"]);i!=null&&r(e,["codeExecutionResult"],i);const l=s(t,["executableCode"]);l!=null&&r(e,["executableCode"],l);const a=s(t,["fileData"]);a!=null&&r(e,["fileData"],a);const u=s(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=s(t,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const d=s(t,["inlineData"]);d!=null&&r(e,["inlineData"],d);const f=s(t,["text"]);return f!=null&&r(e,["text"],f),e}function Ho(o,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const i=s(t,["thought"]);i!=null&&r(e,["thought"],i);const l=s(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=s(t,["fileData"]);u!=null&&r(e,["fileData"],u);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=s(t,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=s(t,["inlineData"]);f!=null&&r(e,["inlineData"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function Bo(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>bo(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function $o(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Ho(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function at(o,t){const e={},n=s(t,["text"]);n!=null&&r(e,["text"],n);const i=s(t,["finished"]);return i!=null&&r(e,["finished"],i),e}function ut(o,t){const e={},n=s(t,["text"]);n!=null&&r(e,["text"],n);const i=s(t,["finished"]);return i!=null&&r(e,["finished"],i),e}function Oo(o,t){const e={},n=s(t,["modelTurn"]);n!=null&&r(e,["modelTurn"],Bo(o,n));const i=s(t,["turnComplete"]);i!=null&&r(e,["turnComplete"],i);const l=s(t,["interrupted"]);l!=null&&r(e,["interrupted"],l);const a=s(t,["groundingMetadata"]);a!=null&&r(e,["groundingMetadata"],a);const u=s(t,["generationComplete"]);u!=null&&r(e,["generationComplete"],u);const c=s(t,["inputTranscription"]);c!=null&&r(e,["inputTranscription"],at(o,c));const d=s(t,["outputTranscription"]);return d!=null&&r(e,["outputTranscription"],at(o,d)),e}function Jo(o,t){const e={},n=s(t,["modelTurn"]);n!=null&&r(e,["modelTurn"],$o(o,n));const i=s(t,["turnComplete"]);i!=null&&r(e,["turnComplete"],i);const l=s(t,["interrupted"]);l!=null&&r(e,["interrupted"],l);const a=s(t,["groundingMetadata"]);a!=null&&r(e,["groundingMetadata"],a);const u=s(t,["generationComplete"]);u!=null&&r(e,["generationComplete"],u);const c=s(t,["inputTranscription"]);c!=null&&r(e,["inputTranscription"],ut(o,c));const d=s(t,["outputTranscription"]);return d!=null&&r(e,["outputTranscription"],ut(o,d)),e}function Yo(o,t){const e={},n=s(t,["id"]);n!=null&&r(e,["id"],n);const i=s(t,["args"]);i!=null&&r(e,["args"],i);const l=s(t,["name"]);return l!=null&&r(e,["name"],l),e}function Ko(o,t){const e={},n=s(t,["args"]);n!=null&&r(e,["args"],n);const i=s(t,["name"]);return i!=null&&r(e,["name"],i),e}function Wo(o,t){const e={},n=s(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>Yo(o,l))),r(e,["functionCalls"],i)}return e}function zo(o,t){const e={},n=s(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>Ko(o,l))),r(e,["functionCalls"],i)}return e}function Xo(o,t){const e={},n=s(t,["ids"]);return n!=null&&r(e,["ids"],n),e}function Qo(o,t){const e={},n=s(t,["ids"]);return n!=null&&r(e,["ids"],n),e}function B(o,t){const e={},n=s(t,["modality"]);n!=null&&r(e,["modality"],n);const i=s(t,["tokenCount"]);return i!=null&&r(e,["tokenCount"],i),e}function O(o,t){const e={},n=s(t,["modality"]);n!=null&&r(e,["modality"],n);const i=s(t,["tokenCount"]);return i!=null&&r(e,["tokenCount"],i),e}function Zo(o,t){const e={},n=s(t,["promptTokenCount"]);n!=null&&r(e,["promptTokenCount"],n);const i=s(t,["cachedContentTokenCount"]);i!=null&&r(e,["cachedContentTokenCount"],i);const l=s(t,["responseTokenCount"]);l!=null&&r(e,["responseTokenCount"],l);const a=s(t,["toolUsePromptTokenCount"]);a!=null&&r(e,["toolUsePromptTokenCount"],a);const u=s(t,["thoughtsTokenCount"]);u!=null&&r(e,["thoughtsTokenCount"],u);const c=s(t,["totalTokenCount"]);c!=null&&r(e,["totalTokenCount"],c);const d=s(t,["promptTokensDetails"]);if(d!=null){let h=d;Array.isArray(h)&&(h=h.map(g=>B(o,g))),r(e,["promptTokensDetails"],h)}const f=s(t,["cacheTokensDetails"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(g=>B(o,g))),r(e,["cacheTokensDetails"],h)}const p=s(t,["responseTokensDetails"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(g=>B(o,g))),r(e,["responseTokensDetails"],h)}const m=s(t,["toolUsePromptTokensDetails"]);if(m!=null){let h=m;Array.isArray(h)&&(h=h.map(g=>B(o,g))),r(e,["toolUsePromptTokensDetails"],h)}return e}function jo(o,t){const e={},n=s(t,["promptTokenCount"]);n!=null&&r(e,["promptTokenCount"],n);const i=s(t,["cachedContentTokenCount"]);i!=null&&r(e,["cachedContentTokenCount"],i);const l=s(t,["candidatesTokenCount"]);l!=null&&r(e,["responseTokenCount"],l);const a=s(t,["toolUsePromptTokenCount"]);a!=null&&r(e,["toolUsePromptTokenCount"],a);const u=s(t,["thoughtsTokenCount"]);u!=null&&r(e,["thoughtsTokenCount"],u);const c=s(t,["totalTokenCount"]);c!=null&&r(e,["totalTokenCount"],c);const d=s(t,["promptTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(C=>O(o,C))),r(e,["promptTokensDetails"],g)}const f=s(t,["cacheTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(C=>O(o,C))),r(e,["cacheTokensDetails"],g)}const p=s(t,["candidatesTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(C=>O(o,C))),r(e,["responseTokensDetails"],g)}const m=s(t,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(C=>O(o,C))),r(e,["toolUsePromptTokensDetails"],g)}const h=s(t,["trafficType"]);return h!=null&&r(e,["trafficType"],h),e}function ei(o,t){const e={},n=s(t,["timeLeft"]);return n!=null&&r(e,["timeLeft"],n),e}function ti(o,t){const e={},n=s(t,["timeLeft"]);return n!=null&&r(e,["timeLeft"],n),e}function ni(o,t){const e={},n=s(t,["newHandle"]);n!=null&&r(e,["newHandle"],n);const i=s(t,["resumable"]);i!=null&&r(e,["resumable"],i);const l=s(t,["lastConsumedClientMessageIndex"]);return l!=null&&r(e,["lastConsumedClientMessageIndex"],l),e}function oi(o,t){const e={},n=s(t,["newHandle"]);n!=null&&r(e,["newHandle"],n);const i=s(t,["resumable"]);i!=null&&r(e,["resumable"],i);const l=s(t,["lastConsumedClientMessageIndex"]);return l!=null&&r(e,["lastConsumedClientMessageIndex"],l),e}function ii(o,t){const e={};s(t,["setupComplete"])!=null&&r(e,["setupComplete"],Go());const i=s(t,["serverContent"]);i!=null&&r(e,["serverContent"],Oo(o,i));const l=s(t,["toolCall"]);l!=null&&r(e,["toolCall"],Wo(o,l));const a=s(t,["toolCallCancellation"]);a!=null&&r(e,["toolCallCancellation"],Xo(o,a));const u=s(t,["usageMetadata"]);u!=null&&r(e,["usageMetadata"],Zo(o,u));const c=s(t,["goAway"]);c!=null&&r(e,["goAway"],ei(o,c));const d=s(t,["sessionResumptionUpdate"]);return d!=null&&r(e,["sessionResumptionUpdate"],ni(o,d)),e}function si(o,t){const e={};s(t,["setupComplete"])!=null&&r(e,["setupComplete"],qo());const i=s(t,["serverContent"]);i!=null&&r(e,["serverContent"],Jo(o,i));const l=s(t,["toolCall"]);l!=null&&r(e,["toolCall"],zo(o,l));const a=s(t,["toolCallCancellation"]);a!=null&&r(e,["toolCallCancellation"],Qo(o,a));const u=s(t,["usageMetadata"]);u!=null&&r(e,["usageMetadata"],jo(o,u));const c=s(t,["goAway"]);c!=null&&r(e,["goAway"],ti(o,c));const d=s(t,["sessionResumptionUpdate"]);return d!=null&&r(e,["sessionResumptionUpdate"],oi(o,d)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ri(o,t){const e={};if(s(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=s(t,["thought"]);n!=null&&r(e,["thought"],n);const i=s(t,["codeExecutionResult"]);i!=null&&r(e,["codeExecutionResult"],i);const l=s(t,["executableCode"]);l!=null&&r(e,["executableCode"],l);const a=s(t,["fileData"]);a!=null&&r(e,["fileData"],a);const u=s(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=s(t,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const d=s(t,["inlineData"]);d!=null&&r(e,["inlineData"],d);const f=s(t,["text"]);return f!=null&&r(e,["text"],f),e}function ee(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>ri(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function li(o,t){const e={};if(s(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=s(t,["category"]);n!=null&&r(e,["category"],n);const i=s(t,["threshold"]);return i!=null&&r(e,["threshold"],i),e}function ai(){return{}}function ui(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function di(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],ui(o,n)),e}function ci(o,t){const e={};if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(t,["googleSearch"])!=null&&r(e,["googleSearch"],ai());const i=s(t,["googleSearchRetrieval"]);if(i!=null&&r(e,["googleSearchRetrieval"],di(o,i)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=s(t,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=s(t,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function fi(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function pi(o,t){const e={},n=s(t,["functionCallingConfig"]);if(n!=null&&r(e,["functionCallingConfig"],fi(o,n)),s(t,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return e}function mi(o,t){const e={},n=s(t,["voiceName"]);return n!=null&&r(e,["voiceName"],n),e}function hi(o,t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&r(e,["prebuiltVoiceConfig"],mi(o,n)),e}function gi(o,t){const e={},n=s(t,["voiceConfig"]);n!=null&&r(e,["voiceConfig"],hi(o,n));const i=s(t,["languageCode"]);return i!=null&&r(e,["languageCode"],i),e}function Ci(o,t){const e={},n=s(t,["includeThoughts"]);n!=null&&r(e,["includeThoughts"],n);const i=s(t,["thinkingBudget"]);return i!=null&&r(e,["thinkingBudget"],i),e}function Ti(o,t,e){const n={},i=s(t,["systemInstruction"]);e!==void 0&&i!=null&&r(e,["systemInstruction"],ee(o,w(o,i)));const l=s(t,["temperature"]);l!=null&&r(n,["temperature"],l);const a=s(t,["topP"]);a!=null&&r(n,["topP"],a);const u=s(t,["topK"]);u!=null&&r(n,["topK"],u);const c=s(t,["candidateCount"]);c!=null&&r(n,["candidateCount"],c);const d=s(t,["maxOutputTokens"]);d!=null&&r(n,["maxOutputTokens"],d);const f=s(t,["stopSequences"]);f!=null&&r(n,["stopSequences"],f);const p=s(t,["responseLogprobs"]);p!=null&&r(n,["responseLogprobs"],p);const m=s(t,["logprobs"]);m!=null&&r(n,["logprobs"],m);const h=s(t,["presencePenalty"]);h!=null&&r(n,["presencePenalty"],h);const g=s(t,["frequencyPenalty"]);g!=null&&r(n,["frequencyPenalty"],g);const C=s(t,["seed"]);C!=null&&r(n,["seed"],C);const T=s(t,["responseMimeType"]);T!=null&&r(n,["responseMimeType"],T);const S=s(t,["responseSchema"]);if(S!=null&&r(n,["responseSchema"],_t(o,S)),s(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(s(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=s(t,["safetySettings"]);if(e!==void 0&&E!=null){let x=E;Array.isArray(x)&&(x=x.map(L=>li(o,L))),r(e,["safetySettings"],x)}const _=s(t,["tools"]);if(e!==void 0&&_!=null){let x=Z(o,_);Array.isArray(x)&&(x=x.map(L=>ci(o,Q(o,L)))),r(e,["tools"],x)}const v=s(t,["toolConfig"]);if(e!==void 0&&v!=null&&r(e,["toolConfig"],pi(o,v)),s(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=s(t,["cachedContent"]);e!==void 0&&A!=null&&r(e,["cachedContent"],N(o,A));const k=s(t,["responseModalities"]);k!=null&&r(n,["responseModalities"],k);const F=s(t,["mediaResolution"]);F!=null&&r(n,["mediaResolution"],F);const G=s(t,["speechConfig"]);if(G!=null&&r(n,["speechConfig"],gi(o,St(o,G))),s(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const q=s(t,["thinkingConfig"]);return q!=null&&r(n,["thinkingConfig"],Ci(o,q)),n}function dt(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["contents"]);if(i!=null){let a=R(o,i);Array.isArray(a)&&(a=a.map(u=>ee(o,u))),r(e,["contents"],a)}const l=s(t,["config"]);return l!=null&&r(e,["generationConfig"],Ti(o,l,e)),e}function yi(o,t,e){const n={},i=s(t,["taskType"]);e!==void 0&&i!=null&&r(e,["requests[]","taskType"],i);const l=s(t,["title"]);e!==void 0&&l!=null&&r(e,["requests[]","title"],l);const a=s(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&r(e,["requests[]","outputDimensionality"],a),s(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(s(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function vi(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["contents"]);i!=null&&r(e,["requests[]","content"],Et(o,i));const l=s(t,["config"]);l!=null&&r(e,["config"],yi(o,l,e));const a=s(t,["model"]);return a!==void 0&&r(e,["requests[]","model"],I(o,a)),e}function Ei(o,t,e){const n={};if(s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=s(t,["numberOfImages"]);e!==void 0&&i!=null&&r(e,["parameters","sampleCount"],i);const l=s(t,["aspectRatio"]);e!==void 0&&l!=null&&r(e,["parameters","aspectRatio"],l);const a=s(t,["guidanceScale"]);if(e!==void 0&&a!=null&&r(e,["parameters","guidanceScale"],a),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=s(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&r(e,["parameters","safetySetting"],u);const c=s(t,["personGeneration"]);e!==void 0&&c!=null&&r(e,["parameters","personGeneration"],c);const d=s(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&r(e,["parameters","includeSafetyAttributes"],d);const f=s(t,["includeRaiReason"]);e!==void 0&&f!=null&&r(e,["parameters","includeRaiReason"],f);const p=s(t,["language"]);e!==void 0&&p!=null&&r(e,["parameters","language"],p);const m=s(t,["outputMimeType"]);e!==void 0&&m!=null&&r(e,["parameters","outputOptions","mimeType"],m);const h=s(t,["outputCompressionQuality"]);if(e!==void 0&&h!=null&&r(e,["parameters","outputOptions","compressionQuality"],h),s(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(s(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function _i(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(t,["config"]);return l!=null&&r(e,["config"],Ei(o,l,e)),e}function Si(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],I(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Ai(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=s(t,["filter"]);e!==void 0&&a!=null&&r(e,["_query","filter"],a);const u=s(t,["queryBase"]);return e!==void 0&&u!=null&&r(e,["_url","models_url"],Mt(o,u)),n}function Ii(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],Ai(o,n,e)),e}function Mi(o,t,e){const n={},i=s(t,["displayName"]);e!==void 0&&i!=null&&r(e,["displayName"],i);const l=s(t,["description"]);return e!==void 0&&l!=null&&r(e,["description"],l),n}function wi(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],I(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],Mi(o,i,e)),e}function xi(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],I(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Pi(o,t){const e={};if(s(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(s(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(s(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Ri(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["contents"]);if(i!=null){let a=R(o,i);Array.isArray(a)&&(a=a.map(u=>ee(o,u))),r(e,["contents"],a)}const l=s(t,["config"]);return l!=null&&r(e,["config"],Pi(o,l)),e}function Ni(o,t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["imageBytes"]);n!=null&&r(e,["bytesBase64Encoded"],D(o,n));const i=s(t,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function Di(o,t,e){const n={},i=s(t,["numberOfVideos"]);if(e!==void 0&&i!=null&&r(e,["parameters","sampleCount"],i),s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=s(t,["durationSeconds"]);if(e!==void 0&&l!=null&&r(e,["parameters","durationSeconds"],l),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=s(t,["aspectRatio"]);if(e!==void 0&&a!=null&&r(e,["parameters","aspectRatio"],a),s(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=s(t,["personGeneration"]);if(e!==void 0&&u!=null&&r(e,["parameters","personGeneration"],u),s(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=s(t,["negativePrompt"]);if(e!==void 0&&c!=null&&r(e,["parameters","negativePrompt"],c),s(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Li(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(t,["image"]);l!=null&&r(e,["instances[0]","image"],Ni(o,l));const a=s(t,["config"]);return a!=null&&r(e,["config"],Di(o,a,e)),e}function Vi(o,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const i=s(t,["thought"]);i!=null&&r(e,["thought"],i);const l=s(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=s(t,["fileData"]);u!=null&&r(e,["fileData"],u);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=s(t,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=s(t,["inlineData"]);f!=null&&r(e,["inlineData"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function U(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Vi(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function Ui(o,t){const e={},n=s(t,["featureSelectionPreference"]);return n!=null&&r(e,["featureSelectionPreference"],n),e}function ki(o,t){const e={},n=s(t,["method"]);n!=null&&r(e,["method"],n);const i=s(t,["category"]);i!=null&&r(e,["category"],i);const l=s(t,["threshold"]);return l!=null&&r(e,["threshold"],l),e}function Fi(){return{}}function Gi(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function qi(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Gi(o,n)),e}function bi(){return{}}function Hi(o,t){const e={},n=s(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function Bi(o,t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],Hi(o,n));const i=s(t,["authType"]);i!=null&&r(e,["authType"],i);const l=s(t,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=s(t,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const u=s(t,["oauthConfig"]);u!=null&&r(e,["oauthConfig"],u);const c=s(t,["oidcConfig"]);return c!=null&&r(e,["oidcConfig"],c),e}function $i(o,t){const e={},n=s(t,["authConfig"]);return n!=null&&r(e,["authConfig"],Bi(o,n)),e}function Pt(o,t){const e={},n=s(t,["retrieval"]);n!=null&&r(e,["retrieval"],n),s(t,["googleSearch"])!=null&&r(e,["googleSearch"],Fi());const l=s(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],qi(o,l)),s(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],bi());const u=s(t,["googleMaps"]);u!=null&&r(e,["googleMaps"],$i(o,u));const c=s(t,["codeExecution"]);c!=null&&r(e,["codeExecution"],c);const d=s(t,["functionDeclarations"]);return d!=null&&r(e,["functionDeclarations"],d),e}function Oi(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function Ji(o,t){const e={},n=s(t,["latitude"]);n!=null&&r(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&r(e,["longitude"],i),e}function Yi(o,t){const e={},n=s(t,["latLng"]);return n!=null&&r(e,["latLng"],Ji(o,n)),e}function Ki(o,t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&r(e,["functionCallingConfig"],Oi(o,n));const i=s(t,["retrievalConfig"]);return i!=null&&r(e,["retrievalConfig"],Yi(o,i)),e}function Wi(o,t){const e={},n=s(t,["voiceName"]);return n!=null&&r(e,["voiceName"],n),e}function zi(o,t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&r(e,["prebuiltVoiceConfig"],Wi(o,n)),e}function Xi(o,t){const e={},n=s(t,["voiceConfig"]);n!=null&&r(e,["voiceConfig"],zi(o,n));const i=s(t,["languageCode"]);return i!=null&&r(e,["languageCode"],i),e}function Qi(o,t){const e={},n=s(t,["includeThoughts"]);n!=null&&r(e,["includeThoughts"],n);const i=s(t,["thinkingBudget"]);return i!=null&&r(e,["thinkingBudget"],i),e}function Zi(o,t,e){const n={},i=s(t,["systemInstruction"]);e!==void 0&&i!=null&&r(e,["systemInstruction"],U(o,w(o,i)));const l=s(t,["temperature"]);l!=null&&r(n,["temperature"],l);const a=s(t,["topP"]);a!=null&&r(n,["topP"],a);const u=s(t,["topK"]);u!=null&&r(n,["topK"],u);const c=s(t,["candidateCount"]);c!=null&&r(n,["candidateCount"],c);const d=s(t,["maxOutputTokens"]);d!=null&&r(n,["maxOutputTokens"],d);const f=s(t,["stopSequences"]);f!=null&&r(n,["stopSequences"],f);const p=s(t,["responseLogprobs"]);p!=null&&r(n,["responseLogprobs"],p);const m=s(t,["logprobs"]);m!=null&&r(n,["logprobs"],m);const h=s(t,["presencePenalty"]);h!=null&&r(n,["presencePenalty"],h);const g=s(t,["frequencyPenalty"]);g!=null&&r(n,["frequencyPenalty"],g);const C=s(t,["seed"]);C!=null&&r(n,["seed"],C);const T=s(t,["responseMimeType"]);T!=null&&r(n,["responseMimeType"],T);const S=s(t,["responseSchema"]);S!=null&&r(n,["responseSchema"],_t(o,S));const E=s(t,["routingConfig"]);E!=null&&r(n,["routingConfig"],E);const _=s(t,["modelSelectionConfig"]);_!=null&&r(n,["modelConfig"],Ui(o,_));const v=s(t,["safetySettings"]);if(e!==void 0&&v!=null){let P=v;Array.isArray(P)&&(P=P.map(te=>ki(o,te))),r(e,["safetySettings"],P)}const A=s(t,["tools"]);if(e!==void 0&&A!=null){let P=Z(o,A);Array.isArray(P)&&(P=P.map(te=>Pt(o,Q(o,te)))),r(e,["tools"],P)}const k=s(t,["toolConfig"]);e!==void 0&&k!=null&&r(e,["toolConfig"],Ki(o,k));const F=s(t,["labels"]);e!==void 0&&F!=null&&r(e,["labels"],F);const G=s(t,["cachedContent"]);e!==void 0&&G!=null&&r(e,["cachedContent"],N(o,G));const q=s(t,["responseModalities"]);q!=null&&r(n,["responseModalities"],q);const x=s(t,["mediaResolution"]);x!=null&&r(n,["mediaResolution"],x);const L=s(t,["speechConfig"]);L!=null&&r(n,["speechConfig"],Xi(o,St(o,L)));const pe=s(t,["audioTimestamp"]);pe!=null&&r(n,["audioTimestamp"],pe);const me=s(t,["thinkingConfig"]);return me!=null&&r(n,["thinkingConfig"],Qi(o,me)),n}function ct(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["contents"]);if(i!=null){let a=R(o,i);Array.isArray(a)&&(a=a.map(u=>U(o,u))),r(e,["contents"],a)}const l=s(t,["config"]);return l!=null&&r(e,["generationConfig"],Zi(o,l,e)),e}function ji(o,t,e){const n={},i=s(t,["taskType"]);e!==void 0&&i!=null&&r(e,["instances[]","task_type"],i);const l=s(t,["title"]);e!==void 0&&l!=null&&r(e,["instances[]","title"],l);const a=s(t,["outputDimensionality"]);e!==void 0&&a!=null&&r(e,["parameters","outputDimensionality"],a);const u=s(t,["mimeType"]);e!==void 0&&u!=null&&r(e,["instances[]","mimeType"],u);const c=s(t,["autoTruncate"]);return e!==void 0&&c!=null&&r(e,["parameters","autoTruncate"],c),n}function es(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["contents"]);i!=null&&r(e,["instances[]","content"],Et(o,i));const l=s(t,["config"]);return l!=null&&r(e,["config"],ji(o,l,e)),e}function ts(o,t,e){const n={},i=s(t,["outputGcsUri"]);e!==void 0&&i!=null&&r(e,["parameters","storageUri"],i);const l=s(t,["negativePrompt"]);e!==void 0&&l!=null&&r(e,["parameters","negativePrompt"],l);const a=s(t,["numberOfImages"]);e!==void 0&&a!=null&&r(e,["parameters","sampleCount"],a);const u=s(t,["aspectRatio"]);e!==void 0&&u!=null&&r(e,["parameters","aspectRatio"],u);const c=s(t,["guidanceScale"]);e!==void 0&&c!=null&&r(e,["parameters","guidanceScale"],c);const d=s(t,["seed"]);e!==void 0&&d!=null&&r(e,["parameters","seed"],d);const f=s(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&r(e,["parameters","safetySetting"],f);const p=s(t,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=s(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&r(e,["parameters","includeSafetyAttributes"],m);const h=s(t,["includeRaiReason"]);e!==void 0&&h!=null&&r(e,["parameters","includeRaiReason"],h);const g=s(t,["language"]);e!==void 0&&g!=null&&r(e,["parameters","language"],g);const C=s(t,["outputMimeType"]);e!==void 0&&C!=null&&r(e,["parameters","outputOptions","mimeType"],C);const T=s(t,["outputCompressionQuality"]);e!==void 0&&T!=null&&r(e,["parameters","outputOptions","compressionQuality"],T);const S=s(t,["addWatermark"]);e!==void 0&&S!=null&&r(e,["parameters","addWatermark"],S);const E=s(t,["enhancePrompt"]);return e!==void 0&&E!=null&&r(e,["parameters","enhancePrompt"],E),n}function ns(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(t,["config"]);return l!=null&&r(e,["config"],ts(o,l,e)),e}function os(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],I(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function is(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=s(t,["filter"]);e!==void 0&&a!=null&&r(e,["_query","filter"],a);const u=s(t,["queryBase"]);return e!==void 0&&u!=null&&r(e,["_url","models_url"],Mt(o,u)),n}function ss(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],is(o,n,e)),e}function rs(o,t,e){const n={},i=s(t,["displayName"]);e!==void 0&&i!=null&&r(e,["displayName"],i);const l=s(t,["description"]);return e!==void 0&&l!=null&&r(e,["description"],l),n}function ls(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],rs(o,i,e)),e}function as(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],I(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function us(o,t,e){const n={},i=s(t,["systemInstruction"]);e!==void 0&&i!=null&&r(e,["systemInstruction"],U(o,w(o,i)));const l=s(t,["tools"]);if(e!==void 0&&l!=null){let u=l;Array.isArray(u)&&(u=u.map(c=>Pt(o,c))),r(e,["tools"],u)}const a=s(t,["generationConfig"]);return e!==void 0&&a!=null&&r(e,["generationConfig"],a),n}function ds(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["contents"]);if(i!=null){let a=R(o,i);Array.isArray(a)&&(a=a.map(u=>U(o,u))),r(e,["contents"],a)}const l=s(t,["config"]);return l!=null&&r(e,["config"],us(o,l,e)),e}function cs(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["contents"]);if(i!=null){let a=R(o,i);Array.isArray(a)&&(a=a.map(u=>U(o,u))),r(e,["contents"],a)}const l=s(t,["config"]);return l!=null&&r(e,["config"],l),e}function fs(o,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["gcsUri"],n);const i=s(t,["imageBytes"]);i!=null&&r(e,["bytesBase64Encoded"],D(o,i));const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function ps(o,t,e){const n={},i=s(t,["numberOfVideos"]);e!==void 0&&i!=null&&r(e,["parameters","sampleCount"],i);const l=s(t,["outputGcsUri"]);e!==void 0&&l!=null&&r(e,["parameters","storageUri"],l);const a=s(t,["fps"]);e!==void 0&&a!=null&&r(e,["parameters","fps"],a);const u=s(t,["durationSeconds"]);e!==void 0&&u!=null&&r(e,["parameters","durationSeconds"],u);const c=s(t,["seed"]);e!==void 0&&c!=null&&r(e,["parameters","seed"],c);const d=s(t,["aspectRatio"]);e!==void 0&&d!=null&&r(e,["parameters","aspectRatio"],d);const f=s(t,["resolution"]);e!==void 0&&f!=null&&r(e,["parameters","resolution"],f);const p=s(t,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=s(t,["pubsubTopic"]);e!==void 0&&m!=null&&r(e,["parameters","pubsubTopic"],m);const h=s(t,["negativePrompt"]);e!==void 0&&h!=null&&r(e,["parameters","negativePrompt"],h);const g=s(t,["enhancePrompt"]);return e!==void 0&&g!=null&&r(e,["parameters","enhancePrompt"],g),n}function ms(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],I(o,n));const i=s(t,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(t,["image"]);l!=null&&r(e,["instances[0]","image"],fs(o,l));const a=s(t,["config"]);return a!=null&&r(e,["config"],ps(o,a,e)),e}function hs(o,t){const e={},n=s(t,["thought"]);n!=null&&r(e,["thought"],n);const i=s(t,["codeExecutionResult"]);i!=null&&r(e,["codeExecutionResult"],i);const l=s(t,["executableCode"]);l!=null&&r(e,["executableCode"],l);const a=s(t,["fileData"]);a!=null&&r(e,["fileData"],a);const u=s(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const c=s(t,["functionResponse"]);c!=null&&r(e,["functionResponse"],c);const d=s(t,["inlineData"]);d!=null&&r(e,["inlineData"],d);const f=s(t,["text"]);return f!=null&&r(e,["text"],f),e}function gs(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>hs(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function Cs(o,t){const e={},n=s(t,["citationSources"]);return n!=null&&r(e,["citations"],n),e}function Ts(o,t){const e={},n=s(t,["content"]);n!=null&&r(e,["content"],gs(o,n));const i=s(t,["citationMetadata"]);i!=null&&r(e,["citationMetadata"],Cs(o,i));const l=s(t,["tokenCount"]);l!=null&&r(e,["tokenCount"],l);const a=s(t,["finishReason"]);a!=null&&r(e,["finishReason"],a);const u=s(t,["avgLogprobs"]);u!=null&&r(e,["avgLogprobs"],u);const c=s(t,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const d=s(t,["index"]);d!=null&&r(e,["index"],d);const f=s(t,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=s(t,["safetyRatings"]);return p!=null&&r(e,["safetyRatings"],p),e}function ft(o,t){const e={},n=s(t,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(c=>Ts(o,c))),r(e,["candidates"],u)}const i=s(t,["modelVersion"]);i!=null&&r(e,["modelVersion"],i);const l=s(t,["promptFeedback"]);l!=null&&r(e,["promptFeedback"],l);const a=s(t,["usageMetadata"]);return a!=null&&r(e,["usageMetadata"],a),e}function ys(o,t){const e={},n=s(t,["values"]);return n!=null&&r(e,["values"],n),e}function vs(){return{}}function Es(o,t){const e={},n=s(t,["embeddings"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>ys(o,a))),r(e,["embeddings"],l)}return s(t,["metadata"])!=null&&r(e,["metadata"],vs()),e}function _s(o,t){const e={},n=s(t,["bytesBase64Encoded"]);n!=null&&r(e,["imageBytes"],D(o,n));const i=s(t,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function Rt(o,t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&r(e,["categories"],n);const i=s(t,["safetyAttributes","scores"]);i!=null&&r(e,["scores"],i);const l=s(t,["contentType"]);return l!=null&&r(e,["contentType"],l),e}function Ss(o,t){const e={},n=s(t,["_self"]);n!=null&&r(e,["image"],_s(o,n));const i=s(t,["raiFilteredReason"]);i!=null&&r(e,["raiFilteredReason"],i);const l=s(t,["_self"]);return l!=null&&r(e,["safetyAttributes"],Rt(o,l)),e}function As(o,t){const e={},n=s(t,["predictions"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Ss(o,a))),r(e,["generatedImages"],l)}const i=s(t,["positivePromptSafetyAttributes"]);return i!=null&&r(e,["positivePromptSafetyAttributes"],Rt(o,i)),e}function Is(o,t){const e={},n=s(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const i=s(t,["createTime"]);i!=null&&r(e,["createTime"],i);const l=s(t,["updateTime"]);return l!=null&&r(e,["updateTime"],l),e}function ue(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["description"]);l!=null&&r(e,["description"],l);const a=s(t,["version"]);a!=null&&r(e,["version"],a);const u=s(t,["_self"]);u!=null&&r(e,["tunedModelInfo"],Is(o,u));const c=s(t,["inputTokenLimit"]);c!=null&&r(e,["inputTokenLimit"],c);const d=s(t,["outputTokenLimit"]);d!=null&&r(e,["outputTokenLimit"],d);const f=s(t,["supportedGenerationMethods"]);return f!=null&&r(e,["supportedActions"],f),e}function Ms(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["_self"]);if(i!=null){let l=wt(o,i);Array.isArray(l)&&(l=l.map(a=>ue(o,a))),r(e,["models"],l)}return e}function ws(){return{}}function xs(o,t){const e={},n=s(t,["totalTokens"]);n!=null&&r(e,["totalTokens"],n);const i=s(t,["cachedContentTokenCount"]);return i!=null&&r(e,["cachedContentTokenCount"],i),e}function Ps(o,t){const e={},n=s(t,["video","uri"]);n!=null&&r(e,["uri"],n);const i=s(t,["video","encodedVideo"]);i!=null&&r(e,["videoBytes"],D(o,i));const l=s(t,["encoding"]);return l!=null&&r(e,["mimeType"],l),e}function Rs(o,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],Ps(o,n)),e}function Ns(o,t){const e={},n=s(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(u=>Rs(o,u))),r(e,["generatedVideos"],a)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function Ds(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(t,["done"]);l!=null&&r(e,["done"],l);const a=s(t,["error"]);a!=null&&r(e,["error"],a);const u=s(t,["response","generateVideoResponse"]);return u!=null&&r(e,["response"],Ns(o,u)),e}function Ls(o,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const i=s(t,["thought"]);i!=null&&r(e,["thought"],i);const l=s(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const u=s(t,["fileData"]);u!=null&&r(e,["fileData"],u);const c=s(t,["functionCall"]);c!=null&&r(e,["functionCall"],c);const d=s(t,["functionResponse"]);d!=null&&r(e,["functionResponse"],d);const f=s(t,["inlineData"]);f!=null&&r(e,["inlineData"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function Vs(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Ls(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function Us(o,t){const e={},n=s(t,["citations"]);return n!=null&&r(e,["citations"],n),e}function ks(o,t){const e={},n=s(t,["content"]);n!=null&&r(e,["content"],Vs(o,n));const i=s(t,["citationMetadata"]);i!=null&&r(e,["citationMetadata"],Us(o,i));const l=s(t,["finishMessage"]);l!=null&&r(e,["finishMessage"],l);const a=s(t,["finishReason"]);a!=null&&r(e,["finishReason"],a);const u=s(t,["avgLogprobs"]);u!=null&&r(e,["avgLogprobs"],u);const c=s(t,["groundingMetadata"]);c!=null&&r(e,["groundingMetadata"],c);const d=s(t,["index"]);d!=null&&r(e,["index"],d);const f=s(t,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=s(t,["safetyRatings"]);return p!=null&&r(e,["safetyRatings"],p),e}function pt(o,t){const e={},n=s(t,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>ks(o,f))),r(e,["candidates"],d)}const i=s(t,["createTime"]);i!=null&&r(e,["createTime"],i);const l=s(t,["responseId"]);l!=null&&r(e,["responseId"],l);const a=s(t,["modelVersion"]);a!=null&&r(e,["modelVersion"],a);const u=s(t,["promptFeedback"]);u!=null&&r(e,["promptFeedback"],u);const c=s(t,["usageMetadata"]);return c!=null&&r(e,["usageMetadata"],c),e}function Fs(o,t){const e={},n=s(t,["truncated"]);n!=null&&r(e,["truncated"],n);const i=s(t,["token_count"]);return i!=null&&r(e,["tokenCount"],i),e}function Gs(o,t){const e={},n=s(t,["values"]);n!=null&&r(e,["values"],n);const i=s(t,["statistics"]);return i!=null&&r(e,["statistics"],Fs(o,i)),e}function qs(o,t){const e={},n=s(t,["billableCharacterCount"]);return n!=null&&r(e,["billableCharacterCount"],n),e}function bs(o,t){const e={},n=s(t,["predictions[]","embeddings"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Gs(o,a))),r(e,["embeddings"],l)}const i=s(t,["metadata"]);return i!=null&&r(e,["metadata"],qs(o,i)),e}function Hs(o,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["gcsUri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&r(e,["imageBytes"],D(o,i));const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Nt(o,t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&r(e,["categories"],n);const i=s(t,["safetyAttributes","scores"]);i!=null&&r(e,["scores"],i);const l=s(t,["contentType"]);return l!=null&&r(e,["contentType"],l),e}function Bs(o,t){const e={},n=s(t,["_self"]);n!=null&&r(e,["image"],Hs(o,n));const i=s(t,["raiFilteredReason"]);i!=null&&r(e,["raiFilteredReason"],i);const l=s(t,["_self"]);l!=null&&r(e,["safetyAttributes"],Nt(o,l));const a=s(t,["prompt"]);return a!=null&&r(e,["enhancedPrompt"],a),e}function $s(o,t){const e={},n=s(t,["predictions"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Bs(o,a))),r(e,["generatedImages"],l)}const i=s(t,["positivePromptSafetyAttributes"]);return i!=null&&r(e,["positivePromptSafetyAttributes"],Nt(o,i)),e}function Os(o,t){const e={},n=s(t,["endpoint"]);n!=null&&r(e,["name"],n);const i=s(t,["deployedModelId"]);return i!=null&&r(e,["deployedModelId"],i),e}function Js(o,t){const e={},n=s(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&r(e,["baseModel"],n);const i=s(t,["createTime"]);i!=null&&r(e,["createTime"],i);const l=s(t,["updateTime"]);return l!=null&&r(e,["updateTime"],l),e}function de(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["description"]);l!=null&&r(e,["description"],l);const a=s(t,["versionId"]);a!=null&&r(e,["version"],a);const u=s(t,["deployedModels"]);if(u!=null){let f=u;Array.isArray(f)&&(f=f.map(p=>Os(o,p))),r(e,["endpoints"],f)}const c=s(t,["labels"]);c!=null&&r(e,["labels"],c);const d=s(t,["_self"]);return d!=null&&r(e,["tunedModelInfo"],Js(o,d)),e}function Ys(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["_self"]);if(i!=null){let l=wt(o,i);Array.isArray(l)&&(l=l.map(a=>de(o,a))),r(e,["models"],l)}return e}function Ks(){return{}}function Ws(o,t){const e={},n=s(t,["totalTokens"]);return n!=null&&r(e,["totalTokens"],n),e}function zs(o,t){const e={},n=s(t,["tokensInfo"]);return n!=null&&r(e,["tokensInfo"],n),e}function Xs(o,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["uri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&r(e,["videoBytes"],D(o,i));const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Qs(o,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],Xs(o,n)),e}function Zs(o,t){const e={},n=s(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(u=>Qs(o,u))),r(e,["generatedVideos"],a)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function js(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(t,["done"]);l!=null&&r(e,["done"],l);const a=s(t,["error"]);a!=null&&r(e,["error"],a);const u=s(t,["response"]);return u!=null&&r(e,["response"],Zs(o,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const er="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function tr(o,t,e){const n=new kn;let i;if(e.data instanceof Blob?i=JSON.parse(await e.data.text()):i=JSON.parse(e.data),o.isVertexAI()){const l=si(o,i);Object.assign(n,l)}else{const l=ii(o,i);Object.assign(n,l)}t(n)}class nr{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n}async connect(t){var e,n,i,l;const a=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let c;const d=rr(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())c=`${a}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{const v=this.apiClient.getApiKey();c=`${a}/ws/google.ai.generativelanguage.${u}.GenerativeService.BidiGenerateContent?key=${v}`}let f=()=>{};const p=new Promise(v=>{f=v}),m=t.callbacks,h=function(){var v;(v=m==null?void 0:m.onopen)===null||v===void 0||v.call(m),f({})},g=this.apiClient,C={onopen:h,onmessage:v=>{tr(g,m.onmessage,v)},onerror:(e=m==null?void 0:m.onerror)!==null&&e!==void 0?e:function(v){},onclose:(n=m==null?void 0:m.onclose)!==null&&n!==void 0?n:function(v){}},T=this.webSocketFactory.create(c,sr(d),C);T.connect(),await p;let S=I(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&S.startsWith("publishers/")){const v=this.apiClient.getProject(),A=this.apiClient.getLocation();S=`projects/${v}/locations/${A}/`+S}let E={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[z.AUDIO]}:t.config.responseModalities=[z.AUDIO]),!((l=t.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const _={model:S,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?E=No(this.apiClient,_):E=Ro(this.apiClient,_),delete E.config,T.send(JSON.stringify(E)),new ir(T,this.apiClient)}}const or={turnComplete:!0};class ir{constructor(t,e){this.conn=t,this.apiClient=e}tLiveClientContent(t,e){if(e.turns!==null&&e.turns!==void 0){let n=[];try{n=R(t,e.turns),t.isVertexAI()?n=n.map(i=>U(t,i)):n=n.map(i=>ee(t,i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof e.turns}'`)}return{clientContent:{turns:n,turnComplete:e.turnComplete}}}return{clientContent:{turnComplete:e.turnComplete}}}tLiveClienttToolResponse(t,e){let n=[];if(e.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(e.functionResponses)?n=e.functionResponses:n=[e.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const l of n){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!t.isVertexAI()&&!("id"in l))throw new Error(er)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},or),t);const e=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(e))}sendRealtimeInput(t){let e={};this.apiClient.isVertexAI()?e={realtimeInput:Fo(this.apiClient,t)}:e={realtimeInput:ko(this.apiClient,t)},this.conn.send(JSON.stringify(e))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const e=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(e))}close(){this.conn.close()}}function sr(o){const t={};return o.forEach((e,n)=>{t[n]=e}),t}function rr(o){const t=new Headers;for(const[e,n]of Object.entries(o))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lr extends b{constructor(t){super(),this.apiClient=t,this.generateContent=async e=>await this.generateContentInternal(e),this.generateContentStream=async e=>await this.generateContentStreamInternal(e),this.generateImages=async e=>await this.generateImagesInternal(e).then(n=>{var i;let l;const a=[];if(n!=null&&n.generatedImages)for(const c of n.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((i=c==null?void 0:c.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?l=c==null?void 0:c.safetyAttributes:a.push(c);let u;return l?u={generatedImages:a,positivePromptSafetyAttributes:l}:u={generatedImages:a},u}),this.list=async e=>{var n;const a={config:Object.assign(Object.assign({},{queryBase:!0}),e==null?void 0:e.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((n=a.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new j(V.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(a),a)}}async generateContentInternal(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ct(this.apiClient,t);return u=y("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=pt(this.apiClient,f),m=new H;return Object.assign(m,p),m})}else{const d=dt(this.apiClient,t);return u=y("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=ft(this.apiClient,f),m=new H;return Object.assign(m,p),m})}}async generateContentStreamInternal(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ct(this.apiClient,t);u=y("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const f=this.apiClient;return a=f.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}),a.then(function(p){return X(this,arguments,function*(){var m,h,g,C;try{for(var T=!0,S=le(p),E;E=yield M(S.next()),m=E.done,!m;T=!0){C=E.value,T=!1;const v=pt(f,yield M(C.json())),A=new H;Object.assign(A,v),yield yield M(A)}}catch(_){h={error:_}}finally{try{!T&&!m&&(g=S.return)&&(yield M(g.call(S)))}finally{if(h)throw h.error}}})})}else{const d=dt(this.apiClient,t);u=y("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const f=this.apiClient;return a=f.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}),a.then(function(p){return X(this,arguments,function*(){var m,h,g,C;try{for(var T=!0,S=le(p),E;E=yield M(S.next()),m=E.done,!m;T=!0){C=E.value,T=!1;const v=ft(f,yield M(C.json())),A=new H;Object.assign(A,v),yield yield M(A)}}catch(_){h={error:_}}finally{try{!T&&!m&&(g=S.return)&&(yield M(g.call(S)))}finally{if(h)throw h.error}}})})}}async embedContent(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=es(this.apiClient,t);return u=y("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=bs(this.apiClient,f),m=new Qe;return Object.assign(m,p),m})}else{const d=vi(this.apiClient,t);return u=y("{model}:batchEmbedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Es(this.apiClient,f),m=new Qe;return Object.assign(m,p),m})}}async generateImagesInternal(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ns(this.apiClient,t);return u=y("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=$s(this.apiClient,f),m=new Ze;return Object.assign(m,p),m})}else{const d=_i(this.apiClient,t);return u=y("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=As(this.apiClient,f),m=new Ze;return Object.assign(m,p),m})}}async get(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=os(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>de(this.apiClient,f))}else{const d=Si(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>ue(this.apiClient,f))}}async listInternal(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ss(this.apiClient,t);return u=y("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Ys(this.apiClient,f),m=new je;return Object.assign(m,p),m})}else{const d=Ii(this.apiClient,t);return u=y("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Ms(this.apiClient,f),m=new je;return Object.assign(m,p),m})}}async update(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ls(this.apiClient,t);return u=y("{model}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>de(this.apiClient,f))}else{const d=wi(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>ue(this.apiClient,f))}}async delete(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=as(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(()=>{const f=Ks(),p=new et;return Object.assign(p,f),p})}else{const d=xi(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(()=>{const f=ws(),p=new et;return Object.assign(p,f),p})}}async countTokens(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ds(this.apiClient,t);return u=y("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Ws(this.apiClient,f),m=new tt;return Object.assign(m,p),m})}else{const d=Ri(this.apiClient,t);return u=y("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=xs(this.apiClient,f),m=new tt;return Object.assign(m,p),m})}}async computeTokens(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=cs(this.apiClient,t);return l=y("{model}:computeTokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>{const d=zs(this.apiClient,c),f=new Dn;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ms(this.apiClient,t);return u=y("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>js(this.apiClient,f))}else{const d=Li(this.apiClient,t);return u=y("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Ds(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ar(o,t){const e={},n=s(t,["operationName"]);n!=null&&r(e,["_url","operationName"],n);const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function ur(o,t){const e={},n=s(t,["operationName"]);n!=null&&r(e,["_url","operationName"],n);const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function dr(o,t){const e={},n=s(t,["operationName"]);n!=null&&r(e,["operationName"],n);const i=s(t,["resourceName"]);i!=null&&r(e,["_url","resourceName"],i);const l=s(t,["config"]);return l!=null&&r(e,["config"],l),e}function cr(o,t){const e={},n=s(t,["video","uri"]);n!=null&&r(e,["uri"],n);const i=s(t,["video","encodedVideo"]);i!=null&&r(e,["videoBytes"],D(o,i));const l=s(t,["encoding"]);return l!=null&&r(e,["mimeType"],l),e}function fr(o,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],cr(o,n)),e}function pr(o,t){const e={},n=s(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(u=>fr(o,u))),r(e,["generatedVideos"],a)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function mr(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(t,["done"]);l!=null&&r(e,["done"],l);const a=s(t,["error"]);a!=null&&r(e,["error"],a);const u=s(t,["response","generateVideoResponse"]);return u!=null&&r(e,["response"],pr(o,u)),e}function hr(o,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["uri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&r(e,["videoBytes"],D(o,i));const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function gr(o,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],hr(o,n)),e}function Cr(o,t){const e={},n=s(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(u=>gr(o,u))),r(e,["generatedVideos"],a)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function mt(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(t,["done"]);l!=null&&r(e,["done"],l);const a=s(t,["error"]);a!=null&&r(e,["error"],a);const u=s(t,["response"]);return u!=null&&r(e,["response"],Cr(o,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Tr extends b{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const e=t.operation,n=t.config;if(e.name===void 0||e.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=e.name.split("/operations/")[0];let l;return n&&"httpOptions"in n&&(l=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:e.name,resourceName:i,config:{httpOptions:l}})}else return this.getVideosOperationInternal({operationName:e.name,config:n})}async getVideosOperationInternal(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ur(this.apiClient,t);return u=y("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>mt(this.apiClient,f))}else{const d=ar(this.apiClient,t);return u=y("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>mr(this.apiClient,f))}}async fetchPredictVideosOperationInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=dr(this.apiClient,t);return l=y("{resourceName}:fetchPredictOperation",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>mt(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yr="Content-Type",vr="X-Server-Timeout",Er="User-Agent",_r="x-goog-api-client",Sr="0.13.0",Ar=`google-genai-sdk/${Sr}`,Ir="v1beta1",Mr="v1beta",ht=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Dt extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ClientError"}}class ce extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ServerError"}}class wr{constructor(t){var e,n;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(e=this.clientOptions.apiVersion)!==null&&e!==void 0?e:Ir,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Mr,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),e=new URL(t);return e.protocol=e.protocol=="http:"?"ws":"wss",e.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,e,n){const i=[this.getRequestUrlInternal(e)];return n&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,e,n);if(t.queryParams)for(const[a,u]of Object.entries(t.queryParams))i.searchParams.append(a,String(u));let l={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=t.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,e,t.abortSignal),this.unaryApiCall(i,l,t.httpMethod)}patchHttpOptions(t,e){const n=JSON.parse(JSON.stringify(t));for(const[i,l]of Object.entries(e))typeof l=="object"?n[i]=Object.assign(Object.assign({},n[i]),l):l!==void 0&&(n[i]=l);return n}async requestStream(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,e,n);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let l={};return l.body=t.body,l=await this.includeExtraHttpOptionsToRequestInit(l,e,t.abortSignal),this.streamApiCall(i,l,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,e,n){if(e&&e.timeout||n){const i=new AbortController,l=i.signal;e.timeout&&(e==null?void 0:e.timeout)>0&&setTimeout(()=>i.abort(),e.timeout),n&&n.addEventListener("abort",()=>{i.abort()}),t.signal=l}return t.headers=await this.getHeadersInternal(e),t}async unaryApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async i=>(await gt(i),new re(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async i=>(await gt(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var e;return X(this,arguments,function*(){const i=(e=t==null?void 0:t.body)===null||e===void 0?void 0:e.getReader(),l=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let a="";for(;;){const{done:u,value:c}=yield M(i.read());if(u){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=l.decode(c);try{const p=JSON.parse(d);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),h=m.status,g=m.code,C=`got status: ${h}. ${JSON.stringify(p)}`;if(g>=400&&g<500)throw new Dt(C);if(g>=500&&g<600)throw new ce(C)}}catch(p){const m=p;if(m.name==="ClientError"||m.name==="ServerError")throw p}a+=d;let f=a.match(ht);for(;f;){const p=f[1];try{const m=new Response(p,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield M(new re(m)),a=a.slice(f[0].length),f=a.match(ht)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{i.releaseLock()}})}async apiCall(t,e){return fetch(t,e).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},e=Ar+" "+this.clientOptions.userAgentExtra;return t[Er]=e,t[_r]=e,t[yr]="application/json",t}async getHeadersInternal(t){const e=new Headers;if(t&&t.headers){for(const[n,i]of Object.entries(t.headers))e.append(n,i);t.timeout&&t.timeout>0&&e.append(vr,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(e),e}async uploadFile(t,e){var n;const i={};e!=null&&(i.mimeType=e.mimeType,i.name=e.name,i.displayName=e.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const l=this.clientOptions.uploader,a=await l.stat(t);i.sizeBytes=String(a.size);const u=(n=e==null?void 0:e.mimeType)!==null&&n!==void 0?n:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const c=await this.fetchUploadUrl(i,e);return l.upload(t,c,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,e){var n;let i={};e!=null&&e.httpOptions?i=e.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const l={file:t},a=await this.request({path:y("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:i});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(n=a==null?void 0:a.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function gt(o){var t;if(o===void 0)throw new ce("response is undefined");if(!o.ok){const e=o.status,n=o.statusText;let i;!((t=o.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?i=await o.json():i={error:{message:await o.text(),code:o.status,status:o.statusText}};const l=`got status: ${e} ${n}. ${JSON.stringify(i)}`;throw e>=400&&e<500?new Dt(l):e>=500&&e<600?new ce(l):new Error(l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xr(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],n);const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Pr(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=s(t,["filter"]);return e!==void 0&&a!=null&&r(e,["_query","filter"],a),n}function Rr(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],Pr(o,n,e)),e}function Nr(o,t){const e={},n=s(t,["textInput"]);n!=null&&r(e,["textInput"],n);const i=s(t,["output"]);return i!=null&&r(e,["output"],i),e}function Dr(o,t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>Nr(o,l))),r(e,["examples","examples"],i)}return e}function Lr(o,t,e){const n={};if(s(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=s(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&r(e,["displayName"],i),s(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=s(t,["epochCount"]);e!==void 0&&l!=null&&r(e,["tuningTask","hyperparameters","epochCount"],l);const a=s(t,["learningRateMultiplier"]);if(a!=null&&r(n,["tuningTask","hyperparameters","learningRateMultiplier"],a),s(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=s(t,["batchSize"]);e!==void 0&&u!=null&&r(e,["tuningTask","hyperparameters","batchSize"],u);const c=s(t,["learningRate"]);return e!==void 0&&c!=null&&r(e,["tuningTask","hyperparameters","learningRate"],c),n}function Vr(o,t){const e={},n=s(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const i=s(t,["trainingDataset"]);i!=null&&r(e,["tuningTask","trainingData"],Dr(o,i));const l=s(t,["config"]);return l!=null&&r(e,["config"],Lr(o,l,e)),e}function Ur(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],n);const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function kr(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=s(t,["filter"]);return e!==void 0&&a!=null&&r(e,["_query","filter"],a),n}function Fr(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],kr(o,n,e)),e}function Gr(o,t,e){const n={},i=s(t,["gcsUri"]);if(e!==void 0&&i!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],i),s(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function qr(o,t){const e={},n=s(t,["gcsUri"]);return n!=null&&r(e,["validationDatasetUri"],n),e}function br(o,t,e){const n={},i=s(t,["validationDataset"]);e!==void 0&&i!=null&&r(e,["supervisedTuningSpec"],qr(o,i));const l=s(t,["tunedModelDisplayName"]);e!==void 0&&l!=null&&r(e,["tunedModelDisplayName"],l);const a=s(t,["description"]);e!==void 0&&a!=null&&r(e,["description"],a);const u=s(t,["epochCount"]);e!==void 0&&u!=null&&r(e,["supervisedTuningSpec","hyperParameters","epochCount"],u);const c=s(t,["learningRateMultiplier"]);e!==void 0&&c!=null&&r(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=s(t,["adapterSize"]);if(e!==void 0&&d!=null&&r(e,["supervisedTuningSpec","hyperParameters","adapterSize"],d),s(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(s(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function Hr(o,t){const e={},n=s(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const i=s(t,["trainingDataset"]);i!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],Gr(o,i,e));const l=s(t,["config"]);return l!=null&&r(e,["config"],br(o,l,e)),e}function Br(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["model"],n);const i=s(t,["name"]);return i!=null&&r(e,["endpoint"],i),e}function Lt(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["state"]);i!=null&&r(e,["state"],At(o,i));const l=s(t,["createTime"]);l!=null&&r(e,["createTime"],l);const a=s(t,["tuningTask","startTime"]);a!=null&&r(e,["startTime"],a);const u=s(t,["tuningTask","completeTime"]);u!=null&&r(e,["endTime"],u);const c=s(t,["updateTime"]);c!=null&&r(e,["updateTime"],c);const d=s(t,["description"]);d!=null&&r(e,["description"],d);const f=s(t,["baseModel"]);f!=null&&r(e,["baseModel"],f);const p=s(t,["_self"]);p!=null&&r(e,["tunedModel"],Br(o,p));const m=s(t,["distillationSpec"]);m!=null&&r(e,["distillationSpec"],m);const h=s(t,["experiment"]);h!=null&&r(e,["experiment"],h);const g=s(t,["labels"]);g!=null&&r(e,["labels"],g);const C=s(t,["pipelineJob"]);C!=null&&r(e,["pipelineJob"],C);const T=s(t,["tunedModelDisplayName"]);return T!=null&&r(e,["tunedModelDisplayName"],T),e}function $r(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["tunedModels"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(a=>Lt(o,a))),r(e,["tuningJobs"],l)}return e}function Or(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(t,["done"]);l!=null&&r(e,["done"],l);const a=s(t,["error"]);return a!=null&&r(e,["error"],a),e}function Jr(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["model"],n);const i=s(t,["endpoint"]);return i!=null&&r(e,["endpoint"],i),e}function fe(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["state"]);i!=null&&r(e,["state"],At(o,i));const l=s(t,["createTime"]);l!=null&&r(e,["createTime"],l);const a=s(t,["startTime"]);a!=null&&r(e,["startTime"],a);const u=s(t,["endTime"]);u!=null&&r(e,["endTime"],u);const c=s(t,["updateTime"]);c!=null&&r(e,["updateTime"],c);const d=s(t,["error"]);d!=null&&r(e,["error"],d);const f=s(t,["description"]);f!=null&&r(e,["description"],f);const p=s(t,["baseModel"]);p!=null&&r(e,["baseModel"],p);const m=s(t,["tunedModel"]);m!=null&&r(e,["tunedModel"],Jr(o,m));const h=s(t,["supervisedTuningSpec"]);h!=null&&r(e,["supervisedTuningSpec"],h);const g=s(t,["tuningDataStats"]);g!=null&&r(e,["tuningDataStats"],g);const C=s(t,["encryptionSpec"]);C!=null&&r(e,["encryptionSpec"],C);const T=s(t,["partnerModelTuningSpec"]);T!=null&&r(e,["partnerModelTuningSpec"],T);const S=s(t,["distillationSpec"]);S!=null&&r(e,["distillationSpec"],S);const E=s(t,["experiment"]);E!=null&&r(e,["experiment"],E);const _=s(t,["labels"]);_!=null&&r(e,["labels"],_);const v=s(t,["pipelineJob"]);v!=null&&r(e,["pipelineJob"],v);const A=s(t,["tunedModelDisplayName"]);return A!=null&&r(e,["tunedModelDisplayName"],A),e}function Yr(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["tuningJobs"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(a=>fe(o,a))),r(e,["tuningJobs"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kr extends b{constructor(t){super(),this.apiClient=t,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new j(V.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{const n=await this.tuneMldevInternal(e);let i="";return n.metadata!==void 0&&n.metadata.tunedModel!==void 0?i=n.metadata.tunedModel:n.name!==void 0&&n.name.includes("/operations/")&&(i=n.name.split("/operations/")[0]),{name:i,state:se.JOB_STATE_QUEUED}}}}async getInternal(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ur(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>fe(this.apiClient,f))}else{const d=xr(this.apiClient,t);return u=y("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Lt(this.apiClient,f))}}async listInternal(t){var e,n,i,l;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Fr(this.apiClient,t);return u=y("tuningJobs",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Yr(this.apiClient,f),m=new nt;return Object.assign(m,p),m})}else{const d=Rr(this.apiClient,t);return u=y("tunedModels",d._url),c=d._query,delete d.config,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=$r(this.apiClient,f),m=new nt;return Object.assign(m,p),m})}}async tuneInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=Hr(this.apiClient,t);return l=y("tuningJobs",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>fe(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Vr(this.apiClient,t);return l=y("tunedModels",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(c=>c.json()),i.then(c=>Or(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wr{async download(t,e){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const zr=1024*1024*8,Xr=3,Qr=1e3,Zr=2,ne="x-goog-upload-status";async function jr(o,t,e){var n,i,l;let a=0,u=0,c=new re(new Response),d="upload";for(a=o.size;u<a;){const p=Math.min(zr,a-u),m=o.slice(u,u+p);u+p>=a&&(d+=", finalize");let h=0,g=Qr;for(;h<Xr&&(c=await e.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((n=c==null?void 0:c.headers)===null||n===void 0)&&n[ne]));)h++,await tl(g),g=g*Zr;if(u+=p,((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[ne])!=="active")break;if(a<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(c==null?void 0:c.json());if(((l=c==null?void 0:c.headers)===null||l===void 0?void 0:l[ne])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function el(o){return{size:o.size,type:o.type}}function tl(o){return new Promise(t=>setTimeout(t,o))}class nl{async upload(t,e,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await jr(t,e,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await el(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ol{create(t,e,n){return new il(t,e,n)}}class il{constructor(t,e,n){this.url=t,this.headers=e,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ct="x-goog-api-key";class sl{constructor(t){this.apiKey=t}async addAuthHeaders(t){t.get(Ct)===null&&t.append(Ct,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rl="gl-node/";class ll{constructor(t){var e;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(e=t.vertexai)!==null&&e!==void 0?e:!1,this.apiKey=t.apiKey;const n=Ft(t,void 0,void 0);n&&(t.httpOptions?t.httpOptions.baseUrl=n:t.httpOptions={baseUrl:n}),this.apiVersion=t.apiVersion;const i=new sl(this.apiKey);this.apiClient=new wr({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:rl+"web",uploader:new nl,downloader:new Wr}),this.models=new lr(this.apiClient),this.live=new nr(this.apiClient,i,new ol),this.chats=new Hn(this.models,this.apiClient),this.caches=new Fn(this.apiClient),this.files=new eo(this.apiClient),this.operations=new Tr(this.apiClient),this.tunings=new Kr(this.apiClient)}}window.GLOBAL_CHAT_MODULE=null;window.GLOBAL_CHAT_MACHINE_INDEX=null;window.GLOBAL_CHAT_PROBLEM=null;window.GLOBAL_OPERARIO=void 0;const J=["RECTA 1 AGUJA","RECTA 2 AGUJAS","OVERLOCK","COVERSTITCH","PRESILLADORA","ZZ","OJAL","BOTON","SCHIPS","ISEW","FLAT SEAMER","SUPREME"],oe=[{name:"TENSIÓN",key:"tension",times:[2,2,3,3,2,3,3,3,3,3,5,2]},{name:"TIPO Y POSICIÓN DE AGUJAS",key:"agujas",times:[1,1,2,2,1,1,1,1,2,2,2,1]},{name:"ENHEBRADO HILO",key:"enhebrado",times:[1,.5,2,2,1,1,1,1,2,2,4,4]},{name:"PRESIÓN PRENSATELAS",key:"prensatelas",times:[.5,1,.5,.5,null,.5,null,null,.5,.5,1,null]},{name:"PPP",key:"ppp",times:[1,1,1,1,null,1,null,null,1,1,null,null]}];class al{constructor(){this.state={ai:null,modelName:"gemini-2.5-pro-exp-03-25",userProblem:"",userModule:"",selectedMachineIndex:null,nextResponseHandler:null,currentStep:null,totalEstimatedIATime:0,actualStepTimes:{}},this.elements={chatMessages:null,messageInput:null,form:null},this.activeIntervals=[],this.handleSubmit=this.handleSubmit.bind(this),this.cleanup=this.cleanup.bind(this)}initializeElements(){this.elements={chatMessages:document.getElementById("chat-messages"),messageInput:document.getElementById("message"),form:document.getElementById("chat-form")}}init(){try{if(this.initializeElements(),!this.elements.form)throw new Error("Chat form not found");const t=this.elements.form.getAttribute("data-gemini-key");if(!t)throw new Error("Gemini API key not found");this.state.ai=new ll({apiKey:t}),this.setupEventListeners(),this.startConversation(this.elements.chatMessages)}catch(t){console.error("Initialization error:",t),this.showError("Error al inicializar el chat")}}showError(t){Swal.fire({icon:"error",title:"Error",text:t,customClass:{container:"z-50"}})}async startConversation(t){const e=this.getTimeBasedGreeting();await this.appendChatMessage(`${e}`,t),await this.appendActionMessage(t)}async appendActionMessage(t){await this.showTypingIndicator(t);const e=document.createElement("div");e.className="text-left mb-4 flex items-start gap-2";const n=document.createElement("div");n.className="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600 flex-shrink-0",n.innerHTML=`
            <img class="w-10 h-10 p-1 rounded-full ring-2 ring-gray-300 dark:ring-gray-500"
                 src="/images/Avatar.webp"
                 alt="AI Avatar">
        `;const i=document.createElement("span");i.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%] flex flex-col sm:flex-row w-full gap-2",i.innerHTML=`
            <strong>¿Qué es lo que deseas hacer?</strong><br>
            <div class="flex flex-col sm:flex-row w-full gap-2 mt-3">
                <button id="btn-crear-ticket" class="w-full sm:w-auto bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition-colors">Crear ticket</button>
                <button id="btn-seguimiento-ticket" class="w-full sm:w-auto bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded transition-colors">Dar seguimiento a un ticket</button>
            </div>
        `,e.appendChild(n),e.appendChild(i),t.appendChild(e),t.scrollTop=t.scrollHeight,setTimeout(()=>{document.getElementById("btn-crear-ticket").onclick=async()=>{t.innerHTML="";const l=this.getTimeBasedGreeting();await this.appendChatMessage(`${l}`,t),await this.askModule(t)},document.getElementById("btn-seguimiento-ticket").onclick=async()=>{t.innerHTML="",await this.askModuloSeguimiento(t)}},100)}async askModuloSeguimiento(t){const e=document.createElement("div");e.className="text-left mb-4";const n=document.createElement("span");n.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]",n.innerHTML='¿A qué módulo quieres dar seguimiento 🧐? <br><select id="modulo-seguimiento" style="width:100%"></select>',e.appendChild(n),t.appendChild(e),t.scrollTop=t.scrollHeight,setTimeout(()=>{window.$&&$("#modulo-seguimiento").length&&($("#modulo-seguimiento").select2({placeholder:"Selecciona un módulo",ajax:{url:"/obtener-modulos",type:"GET",dataType:"json",delay:250,data:function(i){return{search:i.term||""}},processResults:function(i,l){let a=$.map(i,function(u){return{id:u.Modulo,text:u.Modulo}});if(l.term&&l.term.length>0){const u=l.term.toLowerCase();a=a.filter(c=>c.text.toLowerCase().includes(u))}return{results:a}}},minimumResultsForSearch:0}),$("#modulo-seguimiento").on("select2:select",i=>{const l=i.params.data.text;Swal.fire({title:"Espera",text:"Estamos procesando tu petición",allowOutsideClick:!1,didOpen:()=>{Swal.showLoading()}}),setTimeout(()=>{window.location.href=`http://128.150.102.40:8020/FollowOT?modulo=${encodeURIComponent(l)}`},1200)}))},100)}setupEventListeners(){this.elements.form.addEventListener("submit",this.handleSubmit),new MutationObserver(()=>{this.elements.chatMessages.scrollTop=this.elements.chatMessages.scrollHeight}).observe(this.elements.chatMessages,{childList:!0,subtree:!0})}isGreeting(t){const e=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return GREETINGS.some(n=>e.includes(n))}getTimeBasedGreeting(){const t=new Date().getHours();return t>=5&&t<12?"Hola, buenos días ☀ !":t>=12&&t<19?"Hola, buenas tardes 🌤 !":"Hola, buenas noches 🌕!"}async showTypingIndicator(t){const e=document.createElement("div");e.className="text-left mb-4 flex items-start gap-2";const n=document.createElement("div");n.className="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600 flex-shrink-0",n.innerHTML=`
            <img class="w-10 h-10 p-1 rounded-full ring-2 ring-gray-300 dark:ring-gray-500"
                 src="/images/Avatar.webp"
                 alt="AI Avatar">
        `;const i=document.createElement("span");i.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%] animate-pulse",i.textContent="Escribiendo...",e.appendChild(n),e.appendChild(i),t.appendChild(e),t.scrollTop=t.scrollHeight,await new Promise(l=>setTimeout(l,1500)),e.remove()}async appendChatMessage(t,e){await this.showTypingIndicator(e);const n=document.createElement("div");n.className="text-left mb-4 flex items-start gap-2";const i=document.createElement("div");i.className="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600 flex-shrink-0",i.innerHTML=`
            <img class="w-10 h-10 p-1 rounded-full ring-2 ring-gray-300 dark:ring-gray-500"
                 src="/images/Avatar.webp"
                 alt="AI Avatar">
        `;const l=document.createElement("span");l.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]",l.innerHTML=t,n.appendChild(i),n.appendChild(l),e.appendChild(n),e.scrollTop=e.scrollHeight}async handleSubmit(t){t.preventDefault(),t.stopPropagation();try{const e=this.elements.messageInput.value.trim();if(!e)return;if(this.elements.chatMessages.innerHTML+=`
                <div class="text-right mb-4">
                    <span class="bg-blue-500 text-white p-3 rounded-lg inline-block max-w-[70%]">
                    ${this.escapeHtml(e)}
                    </span>
                </div>`,this.elements.messageInput.value="",this.state.nextResponseHandler){const n=this.state.nextResponseHandler;this.state.nextResponseHandler=null,await n(e)}}catch(e){this.showError("Error al procesar el mensaje"),console.error(e)}}askModule(t){const e=document.createElement("div");e.className="text-left mb-4";const n=document.createElement("span");n.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]",n.innerHTML=`Por favor selecciona el modulo que se atendera:<br>
            <select id="modul" style="width:100%"></select>
            <div id="operario-select-container" class="mt-4"></div>`,e.appendChild(n),t.appendChild(e),t.scrollTop=t.scrollHeight,setTimeout(()=>{window.$&&$("#modul").length&&($("#modul").select2({placeholder:"Selecciona un módulo",ajax:{url:"/obtener-modulos",type:"GET",dataType:"json",delay:250,data:function(i){return{search:i.term||""}},processResults:function(i,l){let a=$.map(i,function(u){return{id:u.Modulo,text:u.Modulo}});if(l.term&&l.term.length>0){const u=l.term.toLowerCase();a=a.filter(c=>c.text.toLowerCase().includes(u))}return{results:a}}},minimumResultsForSearch:0}),$("#modul").on("select2:open",function(){$(".select2-search__field").focus()}),$("#modul").on("select2:select",i=>{const l=i.params.data.text||"";if(this.state.userModule&&this.state.userModule!==l){this.state.userModule=l,window.GLOBAL_CHAT_MODULE=l,this.showOperarioSelect(l);return}this.state.userModule=l,window.GLOBAL_CHAT_MODULE=l,window.iaChatStep=3,this.showOperarioSelect(l)}))},100),window.iaChatStep=99}showOperarioSelect(t){const e=document.getElementById("operario-select-container");e&&(e.innerHTML=`<label class="block mb-2">Selecciona el operario:</label>
            <select id="operario-select" style="width:100%"></select>`,setTimeout(()=>{window.$&&$("#operario-select").length&&($("#operario-select").select2({placeholder:"Selecciona un operario",ajax:{url:"/obtener-operarios",type:"GET",dataType:"json",delay:250,data:function(n){return{modulo:t,search:n.term||""}},processResults:function(n,i){let l=$.map(n,function(a){return{id:a.NumOperario,text:`${a.Nombre} - ${a.NumOperario}`}});if(i.term&&i.term.length>0){const a=i.term.toLowerCase();l=l.filter(u=>u.text.toLowerCase().includes(a))}return{results:l}}},minimumResultsForSearch:0}),$("#operario-select").on("select2:open",function(){$(".select2-search__field").focus()}),$("#operario-select").on("select2:select",n=>{const i=n.params.data.id,l=n.params.data.text;this.state.selectedOperario={id:i,text:l};const a=l.split(" - ");window.GLOBAL_OPERARIO={nombre:a[0]||"",numero:a[1]||""},this.showMachineSelect()}))},100))}showMachineSelect(){const t=this.elements.chatMessages,e=document.createElement("div");e.className="text-left mb-4";const n=document.createElement("span");n.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]";let i=`<label class="block mb-2">Por favor selecciona el tipo de máquina:</label>
        <select id="machine-select" class="w-full p-2 border rounded dark:bg-gray-700 dark:text-white">
            <option value="">Selecciona una máquina</option>`;J.forEach((l,a)=>{i+=`<option value="${a}">${l}</option>`}),i+='</select><div id="machine-steps" class="mt-4"></div>',n.innerHTML=i,e.appendChild(n),t.appendChild(e),t.scrollTop=t.scrollHeight,this.setupMachineSelectListener()}setupMachineSelectListener(){const t=document.getElementById("machine-select");t&&t.addEventListener("change",e=>{const n=parseInt(e.target.value);if(!isNaN(n)){if(typeof this.state.selectedMachineIndex=="number"&&this.state.selectedMachineIndex!==null&&this.state.selectedMachineIndex!==n){this.state.selectedMachineIndex=n,window.GLOBAL_CHAT_MACHINE_INDEX=n;return}this.state.selectedMachineIndex=n,window.GLOBAL_CHAT_MACHINE_INDEX=n,this.askUserProblem(n)}})}async askUserProblem(t){const e=this.elements.chatMessages;await this.appendChatMessage("Por favor, describe el problema que estás teniendo con la máquina:",e),this.elements.messageInput.disabled=!1,this.elements.messageInput.focus(),this.state.selectedMachineIndex=t,window.GLOBAL_CHAT_MACHINE_INDEX=t,this.state.nextResponseHandler=async n=>{this.state.userProblem=n||"",window.GLOBAL_CHAT_PROBLEM=this.state.userProblem,await this.showSummary(e),setTimeout(()=>{this.showSteps(this.state.selectedMachineIndex)},1e3)}}showSummary(t){const e=document.createElement("div");e.className="text-left mb-4";const n=document.createElement("span");n.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]";let i="",l="";if(this.state.selectedOperario&&this.state.selectedOperario.text){const a=this.state.selectedOperario.text.split(" - ");i=a[0]||"",l=a[1]||""}return n.innerHTML=`<strong>Resumen de la solicitud:</strong><br>
            <b>Módulo:</b> ${this.escapeHtml(this.state.userModule)}<br>
            <b>Operario:</b> ${this.escapeHtml(l)}<br>
            <b>Nombre:</b> ${this.escapeHtml(i)}<br>
            <b>Máquina:</b> ${this.escapeHtml(J[this.state.selectedMachineIndex])}<br>
            <b>Problema/Descripción:</b> ${this.escapeHtml(this.state.userProblem)}`,e.appendChild(n),t.appendChild(e),t.scrollTop=t.scrollHeight,new Promise(a=>setTimeout(a,1e3))}async showSteps(t){const e=this.elements.chatMessages;this.cleanup(),this.elements.messageInput.disabled=!0,await this.appendChatMessage("Por favor sigue estos pasos:",e),this.state.totalEstimatedIATime=0,oe.forEach(i=>{const l=i.times[t];l!==null&&(this.state.totalEstimatedIATime+=l)}),console.log(`Tiempo total estimado de pasos de IA para máquina ${J[t]}: ${this.state.totalEstimatedIATime} minutos`),setTimeout(()=>{let i=0;const l=()=>{if(i>=oe.length){this.elements.messageInput.disabled=!1,this.showFinalQuestion();return}const a=oe[i],u=a.times[t];if(u===null){i++,l();return}this.showStep(a,u,i,()=>{i++,l()})};l()},500)}async showStep(t,e,n,i){const l=this.elements.chatMessages,a=document.createElement("div");a.className="text-left mb-4";const u=document.createElement("span");u.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%] flex flex-col";let c=e>=1?`${Math.round(e)} min`:`${Math.round(e*60)} seg`,d=Math.round(e*60),f=d;u.innerHTML=`
            <strong>Paso ${n+1}:</strong> ${t.name}
            <span class="ml-2 text-xs text-gray-500">
                (<span class="timer">${this.formatTime(f)}</span> restante | <span class="timer-num">${c}</span>)
            </span>
            <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-2 next-step-btn">
                Siguiente paso
            </button>`,a.appendChild(u),l.appendChild(a),this.elements.messageInput.disabled=!0;let p=!1;const m=u.querySelector(".next-step-btn");(!this.state.actualStepTimes||typeof this.state.actualStepTimes!="object")&&(this.state.actualStepTimes={});const h=()=>{if(p)return;p=!0,clearInterval(this.state.currentStep.interval),m.disabled=!0;const g=d-f;this.state.actualStepTimes||(this.state.actualStepTimes={}),this.state.actualStepTimes[t.key]=g,console.log(`Paso "${t.name}" completado. Tiempo real: ${g} segundos.`),this.state.currentStep=null,i()};this.state.currentStep={interval:setInterval(()=>{f--,u.querySelector(".timer").textContent=this.formatTime(f),f<=0&&h()},1e3),element:u},m.addEventListener("click",h)}clearCurrentStep(){this.state.currentStep&&(clearInterval(this.state.currentStep.interval),this.state.currentStep.element.querySelector(".next-step-btn").disabled=!0,this.state.currentStep=null)}showFinalQuestion(){const t=this.elements.chatMessages,e=document.createElement("div");e.className="text-left mb-4";const n=document.createElement("span");n.className="bg-gray-200 dark:bg-gray-700 dark:text-white p-3 rounded-lg inline-block max-w-[70%]";let i=60,l=document.createElement("div");l.className="text-center text-xs font-bold text-red-600 mt-2",l.innerHTML='Tiempo para responder: <span id="final-question-timer">01:00</span>';function a(){const u=Math.floor(i/60),c=i%60;l.querySelector("#final-question-timer").textContent=`${u.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`}n.innerHTML=`
            <p>¿Pudiste resolver el problema, con los pasos de ayuda?</p>
            <div class="flex flex flex-col sm:flex-row w-full gap-4 mt-3">
                <button class=" w-full sm:w-auto bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded" onclick="window.chatManager.handleResponse(true)">
                    SI
                </button>
                <button class=" w-full sm:w-auto bg-orange-400 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded" onclick="window.chatManager.handleResponse(false)">
                    NO
                </button>
                <button class=" w-full sm:w-auto bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded" onclick="window.chatManager.handleResponse('CANCELADO')">
                    Cancelar ticket
                </button>
            </div>
        `,n.appendChild(l),e.appendChild(n),t.appendChild(e),t.scrollTop=t.scrollHeight,a(),this.finalQuestionTimerInterval=setInterval(()=>{i--,a(),i<=0&&(clearInterval(this.finalQuestionTimerInterval),this.state.actualStepTimes||(this.state.actualStepTimes={}),this.state.actualStepTimes.final_wait=60,this.handleResponse("CANCELADO",!0))},1e3),this.finalQuestionTimerActive=!0}async handleResponse(t,e=!1){this.finalQuestionTimerActive&&this.finalQuestionTimerInterval&&(clearInterval(this.finalQuestionTimerInterval),this.finalQuestionTimerActive=!1);const n=this.elements.chatMessages;try{const i=this.state.userModule||window.GLOBAL_CHAT_MODULE,l=this.state.userProblem||window.GLOBAL_CHAT_PROBLEM,a=typeof this.state.selectedMachineIndex=="number"&&!isNaN(this.state.selectedMachineIndex)?this.state.selectedMachineIndex:window.GLOBAL_CHAT_MACHINE_INDEX;if(console.log("Valores antes de enviar:",{modulo:i,problema:l,selectedMachineIndex:a}),!i||!l||a===null||typeof a>"u"){Swal.fire({icon:"error",title:"Error",text:"Por favor, selecciona el módulo, la máquina y describe el problema antes de continuar."});return}let u=0;for(const _ in this.state.actualStepTimes)this.state.actualStepTimes.hasOwnProperty(_)&&(u+=this.state.actualStepTimes[_]);const c=this.state.totalEstimatedIATime,d=Math.floor(u/60),f=u%60,p=`${d}:${f.toString().padStart(2,"0")}`;let m;t===!0?m="AUTONOMO":t===!1?m="SIN_ASIGNAR":t==="CANCELADO"&&(m="CANCELADO");let h="",g="";if(this.state.selectedOperario&&this.state.selectedOperario.text){const _=this.state.selectedOperario.text.split(" - ");h=_[0]||"",g=_[1]||""}(!h||!g)&&window.GLOBAL_OPERARIO&&(h=window.GLOBAL_OPERARIO.nombre||"",g=window.GLOBAL_OPERARIO.numero||"");const C={modulo:i,problema:l,descripcion:l,status:m,maquina:J[a],tiempo_estimado_ia:c,tiempo_real_ia:p,Operario:g,NombreOperario:h};console.log("Enviando datos al backend:",C);let T=document.createElement("div");T.id="modal-chat-loading-spinner",T.className="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",T.innerHTML=`
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg flex flex-col items-center px-8 py-6">
                    <svg aria-hidden="true" class="w-12 h-12 mb-3 text-gray-200 animate-spin fill-blue-600" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>
                      <path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"/>
                    </svg>
                    <span class="text-lg font-semibold text-gray-700 dark:text-gray-100">Cargando...</span>
                </div>
            `,document.body.appendChild(T);const S=await fetch("/ticketsOT",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify(C)});T&&T.parentNode&&T.parentNode.removeChild(T);const E=await S.json();if(E.success){let _="success",v="",A="";m==="AUTONOMO"?(_="success",v="Excelente trabajo",A="Gracias por haberlo resuelto de forma autónoma."):m==="SIN_ASIGNAR"?(_="success",v="Ticket registrado",A=`La Orden de Trabajo fue creada exitosamente con el folio: ${E.folio}`):m==="CANCELADO"&&(_="warning",v="El ticket fue cancelado",A=e?"Por inactividad se ha cancelado tu ticket":""),await Swal.fire({icon:_,title:v,text:A,confirmButtonText:"OK"}),m==="AUTONOMO"?await this.appendChatMessage("Me alegra 😃 que se haya podido solucionar el problema.<br>Recuerda que estoy para ayudarte 🤖",n):m==="SIN_ASIGNAR"?(await this.appendChatMessage(`<strong>Folio generado:</strong> ${E.folio}`,n),await this.appendChatMessage("Se ha generado tu ticket, en breve te atenderá el mecánico.",n)):m==="CANCELADO"&&await this.appendChatMessage(e?"Por inactividad se ha cancelado tu ticket.<br>Que lastima que hayas cancelado 😥 , recuerda que estoy para ayudarte":"Que lastima que hayas cancelado 😥 , recuerda que estoy para ayudarte",n),setTimeout(()=>this.showFinalResetQuestion(n),1e3)}else throw new Error(E.message||"Error al procesar la solicitud")}catch(i){const l=document.getElementById("modal-chat-loading-spinner");l&&l.parentNode&&l.parentNode.removeChild(l),console.error("Error en handleResponse:",i),Swal.fire({icon:"error",title:"Error",text:"Hubo un error al procesar la solicitud"})}}async showFinalResetQuestion(t){await this.showTypingIndicator(t);const e=document.createElement("div");e.className="text-left mb-4 flex items-start gap-3",e.innerHTML=`
            <div class="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600 flex-shrink-0">
                <img class="w-10 h-10 p-1 rounded-full ring-2 ring-gray-300 dark:ring-gray-500"
                     src="/images/Avatar.webp"
                     alt="AI Avatar">
            </div>
            <div>
                <div class="bg-gray-100 dark:bg-gray-700 dark:text-white p-3 rounded-lg mb-2">
                    <strong>¿Qué es lo que deseas hacer ahora?</strong>
                    <div class="flex flex-col sm:flex-row w-full gap-2 mt-3">
                        <button id="btn-crear-ticket-final" class="w-full sm:w-auto bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition-colors">Crear ticket</button>
                        <button id="btn-seguimiento-ticket-final" class="w-full sm:w-auto bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded transition-colors">Dar seguimiento a un ticket</button>
                    </div>
                </div>
            </div>
        `,t.appendChild(e),t.scrollTop=t.scrollHeight,e.querySelector("#btn-crear-ticket-final").onclick=async()=>{t.innerHTML="",this.selectedModulo=null,this.selectedOperario=null,this.selectedProblema=null,this.selectedMaquina=null,this.selectedClase=null,this.selectedNumeroMaquina=null,this.selectedCausa=null,this.selectedAccion=null,this.selectedComentarios=null,this.ticketFolio=null,await this.startConversation(t)},e.querySelector("#btn-seguimiento-ticket-final").onclick=async()=>{await this.askModuloForSeguimiento(t)}}async askModuloForSeguimiento(t){await this.showTypingIndicator(t);const e=document.createElement("div");e.className="text-left mb-4 flex items-start gap-3",e.innerHTML=`
            <div class="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600 flex-shrink-0">
                <img class="w-10 h-10 p-1 rounded-full ring-2 ring-gray-300 dark:ring-gray-500"
                     src="/images/Avatar.webp"
                     alt="AI Avatar">
            </div>
            <div>
                <div class="bg-gray-100 dark:bg-gray-700 dark:text-white p-3 rounded-lg mb-2">
                    <strong>¿A qué módulo quieres dar seguimiento 🧐?</strong>
                    <br>
                    <select id="modulo-seguimiento" class="mt-2 w-full rounded border-gray-300 dark:bg-gray-700 dark:text-white"></select>
                </div>
            </div>
        `,t.appendChild(e),t.scrollTop=t.scrollHeight;const n=e.querySelector("#modulo-seguimiento");try{(await axios.get("/obtener-modulos")).data.forEach(l=>{let a=l.Modulo||l.moduleid||l.MODULEID||l.value||l,u=l.Modulo||l.moduleid||l.MODULEID||l.value||l;if(a&&u){let c=document.createElement("option");c.value=a,c.textContent=u,n.appendChild(c)}})}catch{let l=document.createElement("option");l.value="",l.textContent="Error al cargar módulos",n.appendChild(l)}n.onchange=()=>{n.value&&(Swal.fire({title:"Espera",text:"Estamos procesando tu petición...",allowOutsideClick:!1,didOpen:()=>{Swal.showLoading()}}),window.location.href=`http://128.150.102.40:8020/FollowOT?modulo=${encodeURIComponent(n.value)}`)}}handleResetResponse(t){const e=this.elements.chatMessages;e.innerHTML="",this.resetChat(),this.startConversation(e)}resetChat(){this.state.userProblem="",this.state.userModule="",this.state.selectedOperario={},this.state.selectedMachineIndex=null,this.state.nextResponseHandler=null,this.state.totalEstimatedIATime=0,this.state.actualStepTimes={},window.iaChatStep=0,window.GLOBAL_OPERARIO=void 0}escapeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}formatTime(t){const e=Math.floor(t/60),n=t%60;return`${e}:${n.toString().padStart(2,"0")}`}cleanup(){try{this.activeIntervals.forEach(t=>clearInterval(t)),this.activeIntervals=[],Object.keys(this.state).forEach(t=>{typeof this.state[t]!="function"&&(this.state[t]=null)})}catch(t){console.error("Cleanup error:",t)}}}document.addEventListener("DOMContentLoaded",()=>{try{window.chatManager=new al,window.chatManager.init()}catch(o){console.error("Fatal initialization error:",o)}});
